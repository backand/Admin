$.expr[":"].containsExact=function(d,b,c,a){return(d.textContent||d.innerText||$(d).text()||"")==c[3]};function GoBack(){window.history.back()}String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};if(!String.prototype.startsWith){String.prototype.startsWith=function(a){return !this.indexOf(a)}}function getBrowser(){var a="";jQuery.each(jQuery.browser,function(b,c){a=a+b+" "+c+" "});return a}function getUserRole(){return $("span#user-role").attr("val")}function isUserAdmin(){var a=getUserRole();return a=="Developer"||a=="Admin"}function isIE(){return $.browser.msie}function queryString(a){return queryString2(window.location.href,a)}function queryString2(b,d){var f=[],e;var a=b.slice(b.indexOf("?")+1).split("&");for(var c=0;c<a.length;c++){e=a[c].split("=");f.push(e[0]);f[e[0]]=e[1]}return f[d]}var createPrefix="create_";var editPrefix="edit_";var filterPrefix="filter_";var inlineAddingPrefix="inlineAdding_";var inlineEditingPrefix="inlineEditing_";var currentViewName="";var TOKEN="&&%&";var Durados;if(!Durados){Durados={DuringdLoadIframe:false}}if(!Durados.View){Durados.View=function(E,ac,aa,O,Y,q,T,W,a,f,v,w,x,ad,X,m,h,an,P,N,am,Q,ao,V,ae,S,t,p,F,G,k,C,ap,J,af,R,u,e,B,ak,Z,M,o,ag,ab,c,s,d,ai,r,ah,U,j,A,g,L,al,y,D,b,l,z,H,K,aj,I){this.guid=E;this.ViewName=ac;this.gCreateUrl=aa;this.gEditUrl=O;this.gEditSelectionUrl=Y;this.gDuplicateUrl=q;this.gGetJsonViewUrl=T;this.gGetRichUrl=W;this.gEditRichUrl=a;this.gGetSelectListUrl=f;this.gGetJsonViewInlineAddingUrl=v;this.gGetJsonViewInlineEditingUrl=w;this.gInlineAddingDialogUrl=x;this.gInlineEditingDialogUrl=ad;this.gInlineDuplicateDialogUrl=X;this.gInlineSearchDialogUrl=m;this.gDeleteUrl=h;this.gDeleteSelectionUrl=an;this.gFilterUrl=P;this.gSetLanguageUrl=N;this.gIndexUrl=am;this.gExportToCsvUrl=Q;this.gPrintUrl=ao;this.gAutoCompleteUrl=V;this.gViewDisplayName=ae;this.gViewName=S;this.allFilterValuesUrl=b;this.jsonViewForCreate=t;this.gUploadUrl=p;this.jsonViewForEdit=F;this.jsonFilter=G;this.Controller=k;this.TabCache=C;this.RefreshOnClose=ap;this.gRefreshUrl=J;this.mainPage=af;this.MultiSelect=R=="True";this.Popup=u=="True";this.Mobile=e=="True";this.AllowEdit=B=="True";this.AddItemUrl=ak;this.EditItemUrl=Z;this.DuplicateItemUrl=M;this.InsertItemUrl=o;this.DuplicationMethod=ag;this.DuplicateMessage=ab;this.PageSize=c;this.DisplayType=s;this.PromoteButton=d;this.addTitle=ai;this.dupTitle=r;this.ShowUpDown=ah=="True";this.EditOnlyUrl=U;this.RowColorColumnName=j;this.HasOpenRules=A=="True";this.MaxSubGridHeight=g;this.AllowCreate=L=="True";this.WorkFlowStepsFieldName=al;this.showDisabledSteps=y=="True";this.ReloadPage=D;this.DataDisplayType=l;this.GridDisplayType=z;this.InsideTextSearch=H=="True";this.Role=K;this.OpenDialogMax=aj;this.SqlProduct=I;this.validations=[];this.tab=null;this.disabledRows=[];this.sortDashboard=[]}}Durados.View.prototype.constructor=Durados.View;Durados.View.prototype.guid=function(){return this.guid};Durados.View.prototype.ViewName=function(){return this.ViewName};Durados.View.prototype.gCreateUrl=function(){return this.gCreateUrl};Durados.View.prototype.gEditUrl=function(){return this.gEditUrl};Durados.View.prototype.gEditSelectionUrl=function(){return this.gEditSelectionUrl};Durados.View.prototype.gDuplicateUrl=function(){return this.gDuplicateUrl};Durados.View.prototype.gGetJsonViewUrl=function(){return this.gGetJsonViewUrl};Durados.View.prototype.gGetRichUrl=function(){return this.gGetRichUrl};Durados.View.prototype.gEditRichUrl=function(){return this.gEditRichUrl};Durados.View.prototype.gGetSelectListUrl=function(){return this.gGetSelectListUrl};Durados.View.prototype.gGetJsonViewInlineAddingUrl=function(){return this.gGetJsonViewInlineAddingUrl};Durados.View.prototype.gGetJsonViewInlineEditingUrl=function(){return this.gGetJsonViewInlineEditingUrl};Durados.View.prototype.gInlineAddingDialogUrl=function(){return this.gInlineAddingDialogUrl};Durados.View.prototype.gInlineEditingDialogUrl=function(){return this.gInlineEditingDialogUrl};Durados.View.prototype.gInlineDuplicateDialogUrl=function(){return this.gInlineDuplicateDialogUrl};Durados.View.prototype.gInlineSearchDialogUrl=function(){return this.gInlineSearchDialogUrl};Durados.View.prototype.gDeleteUrl=function(){return this.gDeleteUrl};Durados.View.prototype.gDeleteSelectionUrl=function(){return this.gDeleteSelectionUrl};Durados.View.prototype.gFilterUrl=function(){return this.gFilterUrl};Durados.View.prototype.gSetLanguageUrl=function(){return this.gSetLanguageUrl};Durados.View.prototype.gIndexUrl=function(){return this.gIndexUrl};Durados.View.prototype.gExportToCsvUrl=function(){return this.gExportToCsvUrl};Durados.View.prototype.gPrintUrl=function(){return this.gPrintUrl};Durados.View.prototype.gAutoCompleteUrl=function(){return this.gAutoCompleteUrl};Durados.View.prototype.gViewDisplayName=function(){return this.gViewDisplayName};Durados.View.prototype.gViewName=function(){return this.gViewName};Durados.View.prototype.jsonViewForCreate=function(){return this.jsonViewForCreate};Durados.View.prototype.gUploadUrl=function(){return this.gUploadUrl};Durados.View.prototype.GetJsonViewForEdit=function(){return this.jsonViewForEdit};Durados.View.prototype.GetJsonFilter=function(){return this.jsonFilter};Durados.View.prototype.Controller=function(){return this.Controller};Durados.View.prototype.TabCache=function(){return this.TabCache};Durados.View.prototype.RefreshOnClose=function(){return this.RefreshOnClose};Durados.View.prototype.gRefreshUrl=function(){return this.gRefreshUrl};Durados.View.prototype.mainPage=function(){return this.mainPage};Durados.View.prototype.MultiSelect=function(){return this.MultiSelect};Durados.View.prototype.Popup=function(){return this.Popup};Durados.View.prototype.Mobile=function(){return this.Mobile};Durados.View.prototype.AddItemUrl=function(){return this.AddItemUrl};Durados.View.prototype.EditItemUrl=function(){return this.EditItemUrl};Durados.View.prototype.DuplicateItemUrl=function(){return this.DuplicateItemUrl};Durados.View.prototype.InsertItemUrl=function(){return this.InsertItemUrl};Durados.View.prototype.DuplicationMethod=function(){return this.DuplicationMethod};Durados.View.prototype.DuplicateMessage=function(){return this.DuplicateMessage};Durados.View.prototype.PageSize=function(){return this.PageSize};Durados.View.prototype.DisplayType=function(){return this.DisplayType};Durados.View.prototype.addTitle=function(){return this.addTitle};Durados.View.prototype.PromoteButton=function(){return this.PromoteButton};Durados.View.prototype.dupTitle=function(){return this.dupTitle};Durados.View.prototype.ShowUpDown=function(){return this.ShowUpDown};Durados.View.prototype.EditOnlyUrl=function(){return this.EditOnlyUrl};Durados.View.prototype.RowColorColumnName=function(){return this.RowColorColumnName};Durados.View.prototype.HasOpenRules=function(){return this.HasOpenRules};Durados.View.prototype.MaxSubGridHeight=function(){return this.MaxSubGridHeight};Durados.View.prototype.AllowCreate=function(){return this.AllowCreate};Durados.View.prototype.WorkFlowStepsFieldName=function(){return this.WorkFlowStepsFieldName};Durados.View.prototype.showDisabledSteps=function(){return this.showDisabledSteps};Durados.View.prototype.Role=function(){return this.Role};Durados.View.prototype.ReloadPage=function(){return this.ReloadPage};Durados.View.prototype.HasWorkFlowSteps=function(){return this.WorkFlowStepsFieldName!=""};Durados.View.prototype.validations=function(){return this.validations};Durados.View.prototype.getTab=function(){return this.tab};Durados.View.prototype.setTab=function(a){return this.tab=a};Durados.View.prototype.setTab=function(a){return this.tab=a};Durados.View.prototype.updateCounter=function(){if(this.tab!=null){var b=this.tab.find('span[hasCounter="hasCounter"]');if(b.length==1){var a=$("#"+this.guid+"ajaxDiv").find("table.gridview");var c=a.attr("rowCount");b.text(c)}}};var views=[];var jsonViewsForInlineDialog={};function UploadFile(g,d,c,f){if(!f){f=$("#"+c+d+ReplaceNonAlphaNumeric(g)).attr("viewName")}if($("#"+c+d+"upload_"+ReplaceNonAlphaNumeric(g)).length==0){return}var a=$("#"+c+d+"upload_span_"+ReplaceNonAlphaNumeric(g)).text();var b="";if(c==null||c=="null"||views[c]==null){if(f=="durados_App"){b="/MultiTenancy/Upload/"}else{b="/Admin/Upload/"}}else{b=views[c].gUploadUrl}var e=new Ajax_upload(c+d+"upload_"+g,{action:b,data:{viewName:f,fieldName:g},onSubmit:function(h,j){showProgress();$("#"+c+d+"upload_span_"+ReplaceNonAlphaNumeric(g)).text("Uploading "+h)},onComplete:function(m,k){hideProgress();if(k.indexOf("Upload failed: ")>-1){$("#"+c+d+"upload_span_"+ReplaceNonAlphaNumeric(g)).text(a);modalErrorMsg(k)}else{var l=decodeURIComponent(k);var h=decodeURIComponent(l).split("|");if(decodeURIComponent(k).indexOf("__filename__")>-1&&h[0].split("//")[1]){showUpload(g,d,h[2],"/"+h[0].split("//")[1]+"?"+h[1],c);if(richUploadDiv){richUploadDiv.find("#"+c+d+g).val(h[2])}}else{showUpload(g,d,h[1],h[0],c);if(richUploadDiv){var j=$("#"+c+d+g).attr("fullUrl")=="yes";if(j){richUploadDiv.find("#"+c+d+g).val(h[0])}else{richUploadDiv.find("#"+c+d+g).val(h[1])}}}}}});return e}function showUpload(c,e,d,a,f){if(d==null){d=""}var g=$("#"+f+e+c).attr("fullUrl")=="yes";c=ReplaceNonAlphaNumeric(c);$("#"+f+e+"upload_span_"+c).text($("#"+f+e+"upload_span_"+c).parent().children("input").attr("upload"));$("#"+f+e+c).val(d);$("#"+f+e+c).attr("d_file",d);if(a&&a.indexOf("__filename__")>-1){if(d){a=a.replace("__filename__",encodeURI(d));$("#"+f+e+"upload_img_"+c).attr("src",a);$("#"+f+e+"upload_img_"+c).css("visibility","visible")}else{$("#"+f+e+"upload_img_"+c).attr("src","");$("#"+f+e+"upload_img_"+c).css("visibility","hidden")}}else{if(a&&a.indexOf(".")>-1){a=a.replace("\\","/");a=a.replace("\\","/");$("#"+f+e+"upload_img_"+c).attr("src",a);$("#"+f+e+"upload_img_"+c).css("visibility","visible")}else{$("#"+f+e+"upload_img_"+c).css("visibility","hidden")}}if(g&&d!=""){$("#"+f+e+c).val(a);$("#"+f+e+c).attr("d_file",a)}var h=$("#"+f+e+"DownloadIcon_"+c);if(h.length>0){if(!d){h.hide()}else{h.show();var b=h.attr("d_href");h.attr("href",b.replace("__filename__",encodeURI(d)))}}var j=$("#"+f+e+"DeleteIcon_"+c);if(j.length>0){if(!d){j.hide()}else{j.css("visibility","visible");j.show()}}}function resetUpload(){var a=$("div.uploadDiv");a.find("span").text("Upload");a.find("img").attr("src","").css("visibility","hidden");a.find("input").val("")}function isUploadDialog(b){var a=$("#"+b.replace("_create_","_inlineEditing__"));if(a.length==0){return false}return a.parent().parent().hasClass("ui-dialog-content")}function performOk(b){var a=$("#"+b.replace("_create_","_inlineEditing__"));if(a.length==0){return}a.parent().parent().parent().find('button:contains("'+translator.ok+'")').click()}function DeleteFile(c,e,b,a,d){Durados.Dialogs.Confirm(translator.DeleteFileTitle,translator.DeleteFileMessage,function(){DeleteFile2(c,e,b,a,d);if(isUploadDialog(e)){performOk(e)}},null)}function DeleteFile2(d,f,c,b,e){c=ReplaceNonAlphaNumeric(c);var a=$("#"+f).val();if(a==null||a==""){a=$("#"+f.replace("_create_","_inlineEditing__")).val()}d=d+a;$.ajax({url:d,contentType:"application/json; charset=utf-8",async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(g){if(g=="Success"){$("#"+f).val("");$("#"+b+e+"DownloadIcon_"+c).hide();$("#"+b+e+"DeleteIcon_"+c).hide();$("#"+b+e+"upload_"+c).find("img:first").css("visibility","hidden");$("#"+f.replace("_create_","_inlineEditing__")).val("");$("#"+b+"inlineEditing__DownloadIcon_"+c).hide();$("#"+b+"inlineEditing__DeleteIcon_"+c).hide();$("#"+b+"inlineEditing__upload_"+c).find("img:first").css("visibility","hidden")}else{ajaxNotSuccessMsg(g)}}})}function GetJsonViewForInlineAdding(e,b,d){var c=null;var a="";if(!b||b=="null"){if(d==null){d="/Home/GetJsonView/"}a=d}else{a=views[b].gGetJsonViewInlineAddingUrl}$.ajax({url:a+e,contentType:"application/json; charset=utf-8",data:{viewName:e,dataAction:"Create",guid:b},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(f){if(f==null||f==""){ajaxNotSuccessMsg("")}else{c=Sys.Serialization.JavaScriptSerializer.deserialize(f)}}});return c}function GetJsonViewForInlineEditing(e,b,c){var d=null;var a=b?views[b].gGetJsonViewInlineEditingUrl+e:"/Home/GetJsonView/"+e;$.ajax({url:a,contentType:"application/json; charset=utf-8",data:{viewName:e,dataAction:"Edit",pk:c,guid:b},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(f){if(f==null||f==""){ajaxNotSuccessMsg("")}else{d=Sys.Serialization.JavaScriptSerializer.deserialize(f)}}});return d}function GetJsonViewForEdit(a){return views[a].GetJsonViewForEdit()}function GetJsonFilter(a){return views[a].GetJsonFilter()}function FillJson(r,f,l,k,b,d,q){for(var j=0,h=r.Fields.length;j<h;++j){var m=r.Fields[j].Value;var p=ReplaceNonAlphaNumeric(m.Name);var a;if(k==null){a=$("#"+l+f+p);if(q){a=$("#"+l+f+p+q)}}else{a=k.find("#"+l+f+p);if(q){a=$("#"+l+f+p+q)}}if(a.length==1){if(b){if(a.attr("ignore")=="no"){m.Refresh=true}else{m.Refresh=false;m.Value="";continue}}if(a.attr("disSource")){m.Value=m.Default;continue}if(a[0].nodeName=="SPAN"){m.Value=a.attr("data-val")}else{if(a[0].type=="checkbox"){m.Value=Durados.CheckBox.IsChecked(a)}else{if($(a[0]).attr("d_type")=="Url"){m.Value=$(a[0]).attr("value")}else{if($(a[0]).attr("radioButtons")=="radioButtons"){m.Value=$("[name="+f+m.Name+"]:checked").val()}else{if($(a[0]).attr("radioButtons")=="radioButtons"){m.Value=$("[name="+f+m.Name+"]:checked").val()}else{if($(a[0]).attr("color")=="1"){var g=a.siblings("input[type=checkbox]");var c=Durados.CheckBox.IsChecked(g);var o=c?a.spectrum("get").toRgbString():"";m.Value=o}else{if(m.Type=="Autocomplete"&&a.attr("valueId")!=undefined){m.Value=GetAutoCompleteValueId(a)}else{if(m.Type=="TextArea"&&a[0].nodeName=="DIV"){m.Value=a.val()}else{var e=a.val();if(d&&a.hasClass("advancedFilter")){Durados.dropdowndiv.handleFilterValue(a);e=a.attr("d_val")}if($.isArray(e)){m.Value=e.toString()}else{m.Value=e}}}}}}}}}if(d){if(a.is("select")){m.Format=getCheckListDisplayValues(a)}else{if(a[0].nodeName=="SPAN"){m.Format=a.text()}else{m.Format=m.Value}}}else{m.Format=""}}}return r}function getFriendlyFilter(h){var b="";var k=views[h].GetJsonFilter();var f=$("#"+h+"ajaxDiv div.fixedViewPort").first();var g=f.parents("div.ui-dialog:first");for(var c=0,e=k.Fields.length;c<e;++c){var j=k.Fields[c].Value;var a;if(!g.length){a=$("#"+h+"filter_"+j.Name)}else{a=g.find("#"+h+"filter_"+j.Name)}if(a.length==1){if(a.is("select")){val=getCheckListDisplayValues(a)}else{val=a.val()}if(val){if(b){b+=" | "}b+=j.Name+"="+val}}}return b}function FillJsonForSearch(e,f,c,d){for(var b=0,a=e.Fields.length;b<a;++b){var g=e.Fields[b].Value,h;if(g.Searchable){h=getFilterValueForSearch($("#"+c+f+ReplaceNonAlphaNumeric(g.Name)));if(!h){g.Value=d}}}return e}function getFilterValueForSearch(a){if(a.length&&(a[0].type=="text"||a[0].nodeName=="SELECT")){return a.val()}}function getCheckListValues(a){var b="";a.find(":checked").each(function(){b=b+$(this).val()+","});if(b!=""){b=b.slice(0,-1)}return b}function getCheckListDisplayValues(a){var b="";a.find("option:selected").each(function(){if(b!=""){b+=","}b=b+$(this).text()});return b}function ClearJson(d,f){for(var c=0,a=d.Fields.length;c<a;++c){var b=d.Fields[c].Key;if(f=="durados_v_ChangeHistory"&&(b=="PK"||b=="ViewName")){continue}var e=d.Fields[c].Value;if(e.Permanent==false){e.Value=""}}return d}Durados.round=function(b,c){var a=Math.pow(10,c);return Math.round(b*a)/a};function handleEnterFilter(c,g,b,f){if(LoadingApplicationData){return}var a;if(g&&g.which){a=g.which}else{if(window.event){g=window.event;a=g.keyCode}}if(a==13){if(!(g.srcElement.className.indexOf("search_text")!==-1)){Durados.dropdowndiv.hide();FilterForm.Apply(false,b,f)}else{var d=$(g.srcElement).siblings().filter(":first");FilterForm.ApplySearch(true,b,d,"Search on text...")}}else{if(a==27){Durados.dropdowndiv.hide()}}}var Autocomplete;if(!Autocomplete){Autocomplete={}}Autocomplete.Init=function(a){$("input.Autocomplete").each(function(){Autocomplete.InitElement($(this),a)})};Autocomplete.InitElement=function(b,a){var c=b.autocomplete(views[a].gAutoCompleteUrl+b.attr("viewName")+"?field="+b.attr("name"),{dataType:"json",parse:AutoCompleteParse,mustMatch:false,max:20,formatItem:function(d){return d.Name},formatResult:function(f,d,e){ajaxNotSuccessMsg(f);return f},width:0,highlight:false,multiple:false,multipleSeparator:";"}).result(AutoCompleteResult);b.bind("keypress",AutoCompleteSearch)};function getDialogWidth(b,a){return b*a*2}function getDialogHeight(c,b,a){(b/c+1)*a+120}var Rectangle;if(!Rectangle){Rectangle={}}Rectangle.New=function(e,d,b,a){var c=new Object();c.top=e;c.left=d;c.width=b;c.height=a;return c};Rectangle.Save=function(b,a){if(b!=null){var c=Sys.Serialization.JavaScriptSerializer.serialize(b);$.cookie(a,c,{expires:1000})}};Rectangle.Load=function(a){var c=$.cookie(a);if(c!=null){var b=Sys.Serialization.JavaScriptSerializer.deserialize(c);return b}else{return null}};$(document).ready(function(){InitTopMenu();$.ajaxSetup({error:function(a,b){ajaxErrorsHandler(a,null,b)}});if($.browser.mozilla){$(".imgLoadSelector").each(function(){var a=$(this).attr("src");if(a){Durados.Image.SetSize(this)}})}});function InitTopMenu(){if($("#smoothmenu").length==0){return}ddsmoothmenu.init({mainmenuid:"smoothmenu",orientation:"h",classname:"ddsmoothmenu",contentsource:"markup",classdownarrow:"downarrowclass",classrightarrow:"rightarrowclass",shadow:true})}function InitCommandMenu(a){}function SaveDialogOnResize(a,b){SaveDialogSizeAndPosition(a,b)}function SaveDialogOnDrag(a,b){SaveDialogSizeAndPosition(a,b)}function SaveDialogSizeAndPosition(a,h){try{var e=$(a.target).parent();if(dialogExt.getState(e)=="max"){return}}catch(d){return}try{var g=e.position().top;var c=e.position().left;var b=e.width();var j=e.height();var f=Rectangle.New(g,c,b,j);Rectangle.Save(f,currentViewName)}catch(d){return}}function SaveFloatDialogOnResize(b,c){var a=$(b.target).parent();SaveFloatDialogSizeAndPosition(a)}function SaveFloatDialogOnDrag(a,b){SaveFloatDialogSizeAndPosition(a,b)}function SaveFloatDialogSizeAndPosition(e){try{var g=e.find("div[ajaxdiv]").first().attr("guid");if(g){var c=views[g].DataDisplayType;if(c=="Preview"){return}Durados.GridHandler.adjustDataTableHeight(g)}}catch(f){}try{var j=e.position().top;var b=e.position().left;var a=e.width();var k=e.height();var h=Rectangle.New(j,b,a,k);Rectangle.Save(h,currentViewName)}catch(d){return}}function getErrorsList(a){var d="<p>Please correct the validation warnings:</p><ul>";try{a.find(".textfieldRequiredMsg, .selectRequiredMsg, .textareaRequiredMsg").each(function(){if($(this).css("display")!="none"){d+="<li>"+$(this).attr("d_label")+" is required.</li>"}});a.find(".textfieldInvalidFormatMsg, .textfieldMinValueMsg, .textfieldMaxValueMsg, .textfieldMinCharsMsg, .textfieldMaxCharsMsg").each(function(){if($(this).css("display")!="none"){d+="<li>"+$(this).attr("d_label")+" is invalid.</li>"}})}catch(b){}d+="</ul>";var c={dialog:a,message:d,cancel:false};$(Durados.View).trigger("getErrorsList",c);if(c.cancel){d=c.message}return d}function refreshView(d,a,e){if(LoadingApplicationData){return}saveElementScrollsPosition(d);showProgress();if(!e){e={}}var c=views[d].gIndexUrl;if(a){c+="?"+a+"&guid="+d}else{c+="?guid="+d}var b=Multi.GetSelection(d);$.post(c,e,function(g){hideProgress();var f=g.indexOf("$$error$$",0);if(f<0||f>1000){FilterForm.HandleSuccess(g,false,d,b);resetElementScrollsPosition(d);if(b!=null){Multi.SelectByPKs(d,b)}}else{ajaxNotSuccessMsg(g)}})}function shortcutKey(b,d,a,c){b.keydown(function(e){if(e.keyCode==a&&(!c||(c&&e.ctrlKey))){e.preventDefault();d()}})}function isAdmin(a){return views[a].Controller=="Admin"}var AddDialog;if(!AddDialog){AddDialog={}}AddDialog.GetButtons=function(d,g,b,a,e,c){if(a==null){a=true}var f={};var j={pk:d,guid:g,hide:false};if(!b){f[translator.saveAndClose]=function(){AddDialog.Add(false,g,true,a,e,c,d,false)}}f[translator.save]=function(){AddDialog.Add(false,g,false,a,e,c,d,false)};$(AddDialog).trigger("newButton",j);if(!j.hide){f[translator.New]=function(){AddDialog.Reset(g,false)}}if(views[g].WorkFlowStepsFieldName!=""){var h={pk:d,guid:g,hide:false};$(AddDialog).trigger("promoteButton",h);if(!h.hide){f[translator.saveAnd+views[g].PromoteButton]=function(){AddDialog.Add(false,g,true,a,e,c,d,true)}}}if(isAdmin(g)&&!d_autoCommit){f[translator.saveAndCommit]=function(){AddDialog.Add(false,g,true,a,e,c,d,false);var k=rootPath+"Admin/RefreshConfig/";refreshConfig(k,g)}}if(!b){f[translator.close]=function(){AddDialog.Close(g)}}return f};AddDialog.HandleDockField=function(a){var b=FilterForm.JsonFilter;if(b==null){b=GetJsonFilter(a)}AddDialog.SetDefaultsFromFilter(b,createPrefix,a);AddDialog.SetDefaults(views[a].jsonViewForCreate,createPrefix,a);$("#"+a+"DataRowCreate").find('[name="DisplayName"]').val("NewField$$");$("#"+a+"DataRowCreate").attr("firstTime","yes");AddDialog.Add(false,a,true)};AddDialog.Open=function(w,l,b,h,y,a){if(isDockFields(l)){var g=views[l]==null?false:views[l].Role=="View Owner";if(IsFieldsSettings()&&g){AddDialog.HandleDockField(l);return}else{parent.parent.AddColumn(function(e){AddDialog.Refresh(l,null,e);parent.parent.Refresh(parent.parent.getMainPageGuid())});return}}try{showProgress()}catch(d){}var u=$("#"+l+"DataRowCreate");var r=w!=null;var z;try{if(r){z=views[l].dupTitle==null||views[l].dupTitle==""||views[l].dupTitle==translator.addRowTo||views[l].dupTitle.length==3?translator.addRowTo+" "+views[l].gViewDisplayName:views[l].dupTitle}else{z=views[l].addTitle==null||views[l].addTitle==""||views[l].addTitle==translator.addRowTo||views[l].addTitle.length==3?translator.addRowTo+" "+views[l].gViewDisplayName:views[l].addTitle}}catch(d){}u.dialog("option","title",z);var t=AddDialog.GetButtons(w,l,b,h,y,a);u.dialog("option","buttons",t);var j=83;shortcutKey(u,t[translator.save],j,true);var v=69;shortcutKey(u,t[translator.saveAndClose],v,true);var k=78;shortcutKey(u,t[translator.New],k,true);AddDialog.Reset(l,r);var p=isMaximizeDialog(l);var c=p==true?"max":$.cookie("state_"+views[l].gViewName);if(itemCreateDialog==null||itemCreateDialog.attr("id")!=u.attr("id")){currentViewName=views[l].gViewName;if(c!="max"){var f=Rectangle.Load(currentViewName);if(f!=null){u.dialog("option","position",[f.left,f.top])}}else{dialogExt.max(u,null,l)}}if(c!="max"){u.dialog("option","height","auto")}else{dialogExt.max(u,null,l)}u.dialog({show:{effect:"fold",duration:500},hide:{effect:"fold",duration:500}});u.dialog("open");AddDialog.CreateWysiwyg(l);Durados.Tabs.select($("#"+l+"CreateTabs"),0);var x=FilterForm.JsonFilter;if(x==null){x=GetJsonFilter(l)}if(w==null){Durados.Dependencies.cleanUp();for(var q=0;q<views[l].jsonViewForCreate.Fields.length;q++){if(views[l].jsonViewForCreate.Fields[q].Value.DependencyData){Durados.Dependencies.createHandlers($("#"+l+createPrefix+ReplaceNonAlphaNumeric(views[l].jsonViewForCreate.Fields[q].Key)),l,views[l].jsonViewForCreate.Fields,views[l].jsonViewForCreate.ViewName,createPrefix)}}}else{var o=EditDialog.GetJsonViewValue(w,l,"Create");EditDialog.Load(w,createPrefix,l,o,"DataRowEdit")}subgridsHashes[l]=new Array();$(Durados.View).trigger("addBeforeDerivation",{pk:w,guid:l,dialog:u,viewName:views[l].ViewName});initDerivationOnShow(views[l].jsonViewForCreate.Derivation,u,createPrefix,l,views[l].jsonViewForCreate.ViewName);u.attr("firstTime","yes");initDropdownChecklistsCreate(l);u.attr("changed","no");Durados.Dialogs.BindToChangeEvent("input",u);Durados.Dialogs.BindToChangeEvent("select",u);Durados.Dialogs.BindToChangeEvent("textarea",u);if(views[l].jsonViewForCreate.ViewName=="Field"){var m=u.find('[name="DataType"]');u.find("[name=RelatedViewName]").parents("tr:first").parents("tr:first").hide();if(m.length==1){m.change(function(){setDataType(u,m)})}}$(Durados.View).trigger("add",{pk:w,guid:l,dialog:u,viewName:views[l].jsonViewForCreate.ViewName,prefix:createPrefix});setFocusInDialog(u);try{hideProgress()}catch(d){}};function initDerivation(g,d,e,c,f){if(g==null){return}var a=d.find("[disabled]");g.DisabledFields[e]=a;var b=$("#"+c+e+ReplaceNonAlphaNumeric(g.DerivationField));b.change(function(){showProgress();setTimeout(function(){var k;if(b.attr("type")=="checkbox"){k=Durados.CheckBox.IsChecked(b)}else{k=b.val()}var h={derivationField:b,value:k,guid:c,viewName:f,prefix:e,cancel:false};var j=$(Durados.View).trigger("derivationFieldChanged",h);if(!h.cancel){initDerivation2(g,k,c,e,d,f)}hideProgress()},1)})}function enableField(d,a,c,e){d.removeAttr("disabled");var g=$("#the"+a+c+e+"_"+d.attr("name"));g.find("img").show();var b=getHideInDerivation(d);if(b){showInDerivation(d)}$(Durados.View).trigger("fieldEnabledInDerivation",{field:d,guid:a,prefix:c,viewName:e,type:"field"})}function enableChildren(a,d,e,f){var c=a.attr("newUrl");if(a.attr("childrenDisabled")=="childrenDisabled"){c=c+"&disabled=False";var b=parseInt(a.attr("index"));a.parents("div:first").tabs("url",b,c);a.find("a").attr("nocache","nocache");a.removeAttr("childrenDisabled")}else{a.find("a").removeAttr("nocache")}$(Durados.View).trigger("fieldEnabledInDerivation",{field:a,guid:d,prefix:e,viewName:f,type:"tabgrid"})}function disableField(d,a,c,e){d.attr("disabled","disabled");var g=$("#the"+a+c+e+"_"+d.attr("name"));g.find("img:not(.jquery-safari-checkbox img, .plan)").hide();var b=getHideInDerivation(d);if(b){hideInDerivation(d)}$(Durados.View).trigger("fieldDisabledInDerivation",{field:d,guid:a,prefix:c,viewName:e,type:"field"})}function disableChildren(a,d,e,f){var c=a.attr("newUrl");if(a.attr("childrenDisabled")=="childrenDisabled"){a.find("a").attr("nocache","nocache")}else{c=c+"&disabled=True";var b=parseInt(a.attr("index"));a.parents("div:first").tabs("url",b,c);a.find("a").attr("nocache","nocache");a.attr("childrenDisabled","childrenDisabled")}$(Durados.View).trigger("fieldDisabledInDerivation",{field:a,guid:d,prefix:e,viewName:f,type:"tabgrid"})}function getSubGridHash(a){var b=a.find("span.inlineAddingImg");var c=new Array();b.each(function(){c[$(this).attr("id")]={toDisable:false,disabled:false}});return c}var subgridsHashes=new Array();function initDerivation2(d,l,m,o,r,k){r.find("[disabled]").each(function(){enableField($(this),m,o,k)});var e=null;if(subgridsHashes[m][r]==null){subgridsHashes[m][r]=getSubGridHash(r)}else{var b=r.find("span.inlineAddingImg");var a=subgridsHashes[m][r];b.each(function(){a[$(this).attr("id")].toDisable=false})}e=subgridsHashes[m][r];r.find("li[childrenFieldName]").each(function(){enableChildren($(this),m,o,k)});r.find(".dropdownchecklist").each(function(){initDropdownchecklist($(this),m)});d.DisabledFields[o].each(function(){disableField($(this),m,o,k)});InitRequiredFieds(d,m,o,k);for(var q=0,t=d.Deriveds.length;q<t;++q){var w=d.Deriveds[q];var u=w.Value;if(u==l){for(var p=0,s=w.Fields.length;p<s;++p){var x=w.Fields[p].Key;var h=$("#"+m+o+ReplaceNonAlphaNumeric(x));if(h.length>0){if(h.hasClass("inlineAddingImg")){e[h.attr("id")].toDisable=true}else{disableField(h,m,o,k);if(h.attr("class")=="dropdownchecklist"){initDropdownchecklist(h,m)}try{var f=views[m].validations[o+","+k+","+x];if(f!=null){f.isRequired=false;f.Required=false;f.reset()}}catch(c){}}}else{var g=r.find("li[childrenFieldName='"+x+"']");if(g.length==1){disableChildren(g,m,o,k)}}}var b=r.find("span.inlineAddingImg");b.each(function(){var y=$(this);showInDerivation(y);var v=y.attr("id");if(e[v].disabled==false&&e[v].toDisable==true){var j=getHideInDerivation(y);if(!j){expand(y,true,null,true,m);e[v].disabled=true;$(Durados.View).trigger("fieldDisabledInDerivation",{field:y,guid:m,prefix:o,viewName:k,type:"subgrid"})}else{hideInDerivation(y)}}else{if(e[v].disabled==true&&e[v].toDisable==false){showInDerivation(y);expand(y,true,null,false,m);e[v].disabled=false;$(Durados.View).trigger("fieldEnabledInDerivation",{field:y,guid:m,prefix:o,viewName:k,type:"subgrid"})}}});return}}}function getHideInDerivation(a){return a.parents('td:first[hideInDerivation="hideInDerivation"]').length>0}function derivationVisibility(e,c){var a=c?"hidden":"visible";var g=e.parents('td:first[hideInDerivation="hideInDerivation"]');g.css("visibility",a);c?g.hide():g.show();var f=g.prev();if(f.attr("hideInDerivation")=="hideInDerivation"){f.css("visibility",a);c?f.hide():f.show()}var d=g.closest("tr");for(var b=d.children("td").length-1;b>=0;b--){if($(d.children("td")[b]).css("visibility")=="visible"){break}}(b==-1)?d.hide():d.show()}function hideInDerivation(a){derivationVisibility(a,true)}function showInDerivation(a){derivationVisibility(a,false)}function InitRequiredFieds(c,l,h,m){for(var g=0,e=c.Deriveds.length;g<e;++g){var a=c.Deriveds[g];for(var f=0,d=a.Fields.length;f<d;++f){var k=a.Fields[f].Value;if(k){var b=a.Fields[f].Key;var o=views[l].validations[h+","+m+","+b];if(o!=null){o.isRequired=true;o.Required=true}}}}}function initDerivationOnShow(h,d,f,c,g){if(h==null){return}var a=h.DisabledFields[f];var b=$("#"+c+f+ReplaceNonAlphaNumeric(h.DerivationField));var e;if(b.attr("type")=="checkbox"){e=Durados.CheckBox.IsChecked(b)}else{e=b.val()}initDerivation2(h,e,c,f,d,g)}AddDialog.onafterSetDefaultsFromFilter=function(){};AddDialog.SetDefaultsFromFilter=function(k,c,f){if(k!=null){for(var d=0,e=k.Fields.length;d<e;++d){var g=k.Fields[d].Value;var j=ReplaceNonAlphaNumeric(g.Name);var a=$("#"+f+c+j);if(a.length>0&&g.Value!=null&&g.Value!=""||$(a[0]).attr("upload")=="upload"){if($(a[0]).attr("upload")=="upload"){UploadFile(j,c,f);showUpload(j,c,g.Value,$("#"+f+c+"upload_img_"+j).attr("UploadPath")+g.Value,f)}else{if($(a[0]).attr("radioButtons")=="radioButtons"){Durados.CheckBox.SetChecked($("[name="+f+c+j+"][value="+g.Value+"]"),"checked")}else{if(a[0]!=undefined&&a[0].type=="textarea"){a.text(g.Value)}else{if(a[0]!=undefined&&a[0].type=="checkbox"){Durados.CheckBox.SetChecked(a,g.Value)}else{if(g.Type=="Autocomplete"){a.attr("valueId",g.Value);a.val(g.Default)}else{if(a[0].tagName=="SELECT"){if(a.find('option[value="'+g.Value+'"]').length==0){var b=$("#"+f+filterPrefix+j);var h="";if(b.length>0){h=b.find('option[value="'+g.Value+'"]').text()}else{h=g.Default}if(h&&g.Value){a.append($("<option value='"+g.Value+"'>"+h+"</option>"))}}}if(g.Value.indexOf(TOKEN)==-1){a.val(g.Value)}Dependency.Init(a,c,f)}}}}}}}$(AddDialog).trigger("onafterSetDefaultsFromFilter",{guid:f,json:k})}};AddDialog.Reset=function(a,e){var b=$("#"+a+"DataRowCreate");var f=b.attr("changed")=="yes";if(f){if(!confirm("Discard changes?")){return}else{}}else{}b.parent().find(".ui-dialog-buttonpane button").each(function(){if($(this).text()==translator.saveAndClose||$(this).text()==translator.save){$(this).removeAttr("disabled");$(this).removeClass("ui-state-disabled")}});var d=$("#"+a+"Create"+ReplaceNonAlphaNumeric(views[a].jsonViewForCreate.ViewName)+"DataRowForm");if(d.length){d[0].reset()}b.find("select").each(function(){if(this.multiple){var g=$(this).find("option");g.each(function(){$(this).removeAttr("selected")});$(this).dropdownchecklist("refresh")}});AddDialog.ResetDependencies(d,createPrefix,a);b.attr("firstTime","yes");resetUpload();AddDialog.DisableTab("CreateTabs",a);AddDialog.SetDisDup(views[a].jsonViewForCreate,createPrefix,a,e);var c=FilterForm.JsonFilter;if(c==null){c=GetJsonFilter(a)}AddDialog.SetDefaultsFromFilter(c,createPrefix,a);AddDialog.SetDefaults(views[a].jsonViewForCreate,createPrefix,a);b.find(".childrenViewer").each(function(){$(this).html("")});clearWysiwyg(b)};function clearWysiwyg(a){try{a.find('textarea[rich = "true"]').each(function(){$(this).parent().find("iframe").contents().find("body").text("")});if(!isIE()){a.find('textarea[rich = "true"]').each(function(){$(this).text("")})}}catch(b){}}AddDialog.ResetDependencies=function(b,c,a){b.find("select[insideDependency='insideDependency']").each(function(){var e=$(this).attr("name");var g=$(this).attr("dependentFieldNames");var f=$(this).attr("dependentFieldViewName");var d=g.split(";");$(d).each(function(){var k=this;try{var h=$("#"+a+c+ReplaceNonAlphaNumeric(k))}catch(j){alert("Could not find the dependent field "+k+" of the field "+e,a);return}if(h.length!=1){alert("Could not find the dependent field "+k+" of the field "+e,a);return}Dependency.ClearAll(h,a)})})};AddDialog.SetDefaults=function(k,d,g){if(k!=null){for(var e=0,f=k.Fields.length;e<f;++e){var h=k.Fields[e].Value;var j=ReplaceNonAlphaNumeric(h.Name);var a=$("#"+g+d+j);if((h.Default!=null&&h.Default!="")||$(a[0]).attr("upload")=="upload"||a.attr("hasInsideDefault")=="hasInsideDefault"){if($(a[0]).attr("upload")=="upload"){UploadFile(h.Name,d,g);showUpload(h.Name,d,h.Default,$("#"+g+d+"upload_img_"+j).attr("UploadPath")+h.Default,g)}else{if($(a[0]).attr("radioButtons")=="radioButtons"){Durados.CheckBox.SetChecked($("[name="+g+d+h.Name+"][value="+h.Value+"]"),"checked")}else{if(a[0].type=="textarea"){a.text(h.Default);$("#"+g+d+j+' [rich="true"]').htmlarea()}else{if(a[0].type=="checkbox"){if(h.Default!="No"){Durados.CheckBox.SetChecked(a,h.Default)}}else{if(h.Type=="Autocomplete"){a.attr("valueId",h.Default);a.val(h.Value)}else{if(a.attr("hasInsideDefault")=="hasInsideDefault"){var b=getInsideDeafult(a,g,d);if(b!=null&&b!=""){a.val(b);if(a.attr("insideDependency")=="insideDependency"){var c=a.attr("dependentFieldViewName");var l=a.attr("dependentFieldNames").split(";");Dependency.LoadInside(c,l,d,a[0],g)}}else{LoadSelect(views[g].ViewName,a.attr("name"),a,g)}}else{a.val(h.Default)}}}}}}}}}};LoadSelect=function(f,g,a,c){var e={viewName2:f,fieldName:g};var b=views[c].gGetSelectListUrl;b=b.replace("GetSelectList","GetSelectList2");var d=a.length>0&&a[0].multiple;$.ajax({url:b,contentType:"application/json; charset=utf-8",data:e,async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(h){var j=a.val();Dependency.LoadSelectList(a,h.Options);if(!d||a.attr("hasInsideTrigger")!="hasInsideTrigger"){a.val(j)}$(Dependency).trigger("onafterLoadSelectList",{select:a,guid:c})}})};getInsideDeafult=function(a,j,e){var h=a.attr("triggerName");if(h==""||h==null){return null}var c=$("#"+j+e+ReplaceNonAlphaNumeric(h));if(c.length==0){modalErrorMsg("The trigger field "+h+" does not exists in the dialog please confirm that it is not hidden in create.");return null}var d=c.val();var f=a.attr("dependencyViewName");var g=a.attr("dependencyFieldName");if(g==null||g==""||f==null||f==""){modalErrorMsg("The trigger field "+h+" does not contain the dependency information. Please make sure it is a drop down element.");return null}var b=Data.GetScalar(f,d,g,j);return b};AddDialog.SetDisDup=function(p,f,k,d){if(p!=null){for(var g=0,h=p.Fields.length;g<h;++g){var m=p.Fields[g].Value;var c=$("#"+k+f+ReplaceNonAlphaNumeric(m.Name));var l=m.DisDup;var e=m.Disabled;var b=c.attr("name");var o=views[k].ViewName;var a=c.parents("#the"+k+f+o+"_"+b);if(a.length>0){a=c.parents("#the"+k+f+o+"_"+ReplaceNonAlphaNumeric(b))}var j=null;if(a.length>0){j=a.find("img")}if(d){if(l&&!e){c.attr("disabled","disabled");if(j!=null){j.hide()}}}else{if(l&&!e){c.removeAttr("disabled");if(j!=null){j.show()}}}}}};AddDialog.CreateWysiwyg=function(a){$("#"+a+'DataRowCreate textarea[rich="true"]').each(function(){$(this).htmlarea("dispose")});$("#"+a+'DataRowCreate textarea[rich="true"]').htmlarea()};AddDialog.Close=function(a){if(views[a].ReloadPage=="Add"||views[a].ReloadPage=="Always"){reloadPage()}var b=$("#"+a+"DataRowCreate");var c=b.attr("changed")=="yes";if(c){if(confirm("Exit without save?")){b.attr("changed","no");if(views[a].RefreshOnClose=="True"){AddDialog.Refresh(a,null)}b.dialog("close")}else{}}else{b.attr("changed","no");if(views[a].RefreshOnClose=="True"){AddDialog.Refresh(a,null)}b.dialog("close")}};AddDialog.Refresh=function(b,c,a){saveElementScrollsPosition(b);$.post(views[b].gRefreshUrl,{guid:b},function(f){hideProgress();var g=f.indexOf("$$error$$",0);var h=f.indexOf("$$message$$",0);var d=g>0&&g<1000;var e=h>0&&h<1000;if(d){ajaxNotSuccessMsg(f,b)}else{$("#"+b+"ajaxDiv").html(f);success(b);resetElementScrollsPosition(b);if(c!=null){Multi.SelectByPK(b,c)}else{if(a!=null){EditDialog.selectRow(c,b,a)}}}})};var blockOperation=false;AddDialog.Add=function(r,l,q,b,h,d,f,c){if(blockOperation){return}var k=$("#"+l+"DataRowCreate");var j={guid:l,dialog:k,pk:f,close:q,cancel:false};$(AddDialog).trigger("onbeforeAdd",j);if(j.cancel){return}if(AddDialog.isValid(l,views[l].gViewName)==false){modalSuccessMsg(getErrorsList(k));blockOperation=false;return}showProgress();blockOperation=true;if(k.attr("firstTime")=="no"){var f=k.attr("pk");blockOperation=false;AddDialog.Update(f,l,r,q,c);return}var a=views[l].gCreateUrl;if(c){a=rootPath+views[l].Controller+"/CreateStep/"+views[l].gViewName}if(views[l].gViewName=="Field"){var p=GetJsonFilter(l);var e="";for(var g=0;g<p.Fields.length;g++){var o=p.Fields[g];if(o.Key=="Fields_Parent"){e=o.Value.Default;break}}a=a+"?mainViewName="+e}if(views[l].gViewName=="Field"){var m=k.find('[name="DataType"]');if(m.length==1){if(!isValidDataType(k,m)){blockOperation=false;hideProgress();return}if(isCreatingNewTableInYourDb(k)&&!confirm("The following change is going to create new table, continue?")){blockOperation=false;hideProgress();return}}}var p=FillJson(views[l].jsonViewForCreate,createPrefix,l,k);if(views[l].gViewName=="Field"&&k.find(".InSystemDatabase").prop("checked")){var o=jQuery.extend(true,{},p.Fields[0]);o.Key="sysdb";o.Value.Value=true;o.Value.Name="sysdb";p.Fields.push(o)}$.post(a,{jsonView:Sys.Serialization.JavaScriptSerializer.serialize(p),guid:l,insertAbovePK:h,duplicateRecursive:d,duplicatePK:f},function(u){if(!b){k.parent().find(".ui-dialog-buttonpane button").each(function(){if($(this).text()==translator.saveAndClose||$(this).text()==translator.save){$(this).attr("disabled","disabled");$(this).addClass("ui-state-disabled")}})}if(c&&u.IsResult){AddDialog.SaveWithoutClose(k,u.PK,l);k.attr("firstTime","no");WorkFlow.CompleteStep(u.PK,l,views[l].WorkFlowStepsFieldName,u,k)}else{hideProgress();var y=u.indexOf("$$error$$",0);var A=u.indexOf("$$message$$",0);var w=y>0&&y<1000;var v=A>0&&A<1000;if(w){ajaxNotSuccessMsg(u,l)}else{if(v){ajaxNotSuccessMsg(u,l);showProgress();refreshView(l);if(!r){AddDialog.Close(l)}}else{AddDialog.HandleSuccess(u,r,l);if(views[l].updateParent){updateParent(l)}else{if(views[l].updateParentGrid){updateParentGrid(l)}}var t=$("#"+l+"ajaxDiv").find('input[name="pk"]').val();PreviewDisplay.selectedPk=t;AddDialog.SaveWithoutClose(k,t,l);if(q){AddDialog.Close(l)}if(isDockFields(l)){handleToolbar(l);$("#d_row_"+l+t).click();setTimeout(function(){EditDialog.Open2(t,l,false)},1);try{showProgress();var x=$("#"+l+"ajaxDiv .boardtitle[d_pk="+t+"]").text().trim();x=ReplaceNonAlphaNumeric(x);try{window.parent.parent.Durados.GridHandler.setNewColumnWidth(window.parent.parent.getMainPageGuid(),x)}catch(s){}setTimeout(function(){window.parent.parent.Refresh(window.parent.parent.getMainPageGuid(),true)},50)}catch(s){hideProgress()}}else{if(views[l].ViewName=="Field"&&views[l].DataDisplayType=="Preview"){$("#d_row_"+l+t).click();setTimeout(function(){EditDialog.Open2(t,l,false)},1)}}plugInRefresh()}}blockOperation=false}if(!w){var z=$("#"+l+"ajaxDiv").find('input[name="pk"]').val();$(AddDialog).trigger("onafterAdd",{guid:l,dialog:k,pk:z,close:q})}})};AddDialog.SaveWithoutClose=function(b,c,a){AddDialog.HandleTab(c,"CreateTabs",a);b.attr("pk",c);b.attr("changed","no");b.find("img.expand").each(function(){$(this).removeAttr("disabled");$(this).attr("title","Expand");var d=$(this).attr("src");$(this).attr("src",d.replace("Disabled",""))});b.find("span.inlineAddingImg").each(function(){$(this).parent("div").siblings("div").attr("pk",c);expand(this,true,null,false,a)})};AddDialog.Update=function(f,d,b,g,a){var e=$("#"+d+"DataRowCreate");if(blockOperation){return}if(AddDialog.isValid(d,views[d].gViewName)==false){modalSuccessMsg(getErrorsList(e));return}begin();blockOperation=true;var c=views[d].gEditUrl;if(a){c=rootPath+views[d].Controller+"/EditStep/"+views[d].gViewName}$.post(c,{pk:f,jsonView:Sys.Serialization.JavaScriptSerializer.serialize(FillJson(GetJsonViewForEdit(d),createPrefix,d,e)),guid:d},function(k){if(a&&k.IsResult){WorkFlow.CompleteStep(f,d,views[d].WorkFlowStepsFieldName,k,e)}else{var l=k.indexOf("$$error$$",0);var m=k.indexOf("$$message$$",0);var h=l>0&&l<1000;var j=m>0&&m<1000;if(h){ajaxNotSuccessMsg(k,d)}else{if(j){ajaxNotSuccessMsg(k,d);showProgress();refreshView(d);AddDialog.Close(d)}else{AddDialog.HandleSuccess(k,b,d);e.attr("changed","no");if(g){AddDialog.Close(d)}}}blockOperation=false;hideProgress()}})};AddDialog.DisableTab=function(c,b){var a=$("#"+b+c);Durados.Tabs.select(a,0);var d=new Array();a.find("li[index][haschildren]").each(function(){var e=parseInt($(this).attr("index"));d.push(e)});a.tabs("option","disabled",d)};AddDialog.HandleTab=function(e,d,c){var b=$("#"+c+d);b.tabs("option","disabled",false);if(e[e.length-1]=="#"){e=e.slice(0,-1)}var a=e.split(",");b.find('li[haschildren="haschildren"]').each(function(){var h=parseInt($(this).attr("index"));var g=unescape($(this).attr("url"));var k=g.split("$$");var l="";for(var j=0,f=a.length;j<f;++j){l=l+k[j]+a[j]}l=l+k[k.length-1]+"&children=true";b.tabs("url",h,l);$(this).attr("newUrl",l)})};AddDialog.HandleSuccess=function(d,a,b){var c=$("#"+b+"DataRowCreate");if(a){AddDialog.Reset(b,false);c.attr("firstTime","yes")}else{c.attr("firstTime","no")}$("#"+b+"ajaxDiv").html(d);success(b);views[b].updateCounter()};AddDialog.isValid=function(c,e){var d=$("#"+c+"Create"+ReplaceNonAlphaNumeric(e)+"DataRowForm");var b=GetIncompleteDependencies(d);if(!isIE()){d.find("iframe").each(function(){if($(this).parent().parent().attr("class")=="jHtmlArea"){var h=$(this).contents().find("body").html();if(h!=""){var g=$(this).parent().parent().find("textarea");if(g.text()==""){g.text(h)}}}})}var f=Spry.Widget.Form.validate(d[0]);var a=IsValidUpload(d[0]);if(f==false||a==false){SetBackIncompleteDependencies(d,b);return false}return true};function GetIncompleteDependencies(c){var a=new Array();var b=c.find("td");b.each(function(e,g){var f=$(g).find("select");if(f.length>1){var d=$(f[0]);var h=$(f[f.length-1]);if(d.val()!=""&&h.val()==""){a.push({select:d,val:d.val()});d.val("")}}});return a}function SetBackIncompleteDependencies(b,a){$.each(a,function(c,d){d.select.val(d.val)})}var RichDialog;if(!RichDialog){RichDialog={}}var richUploader=null;var richUploadDiv=null;RichDialog.OpenUploadDialog=function(k,m,h,o,c,a){if(richUploadDiv){richUploadDiv.remove()}var f=$("<div>"+RichDialog.GetUploadElement(k,m,h)+"</div>");richUploadDiv=f;var j="Upload Image";FloatingDialog.Open(f,j,true,h);f.dialog("option","height","auto");f.dialog("option","width","auto");f.dialog("option","resizable",false);try{if(richUploader){richUploader.destroy()}}catch(d){}if(richUploader){richUploader=null}var p=ReplaceNonAlphaNumeric(m);var b="#"+h+createPrefix+"upload_"+p;var l=h+inlineEditingPrefix+"_upload_"+p;f.find(b).attr("id",l);b="#"+h+createPrefix+"upload_span_"+p;l=h+inlineEditingPrefix+"_upload_span_"+p;f.find(b).attr("id",l);b="#"+h+createPrefix+p;l=h+inlineEditingPrefix+"_"+p;f.find(b).attr("id",l);b="#"+h+createPrefix+"upload_img_"+p;l=h+inlineEditingPrefix+"_upload_img_"+p;f.find(b).attr("id",l);richUploader=UploadFile(m,inlineEditingPrefix+"_",h);showUpload(m,inlineEditingPrefix+"_",c,a,h);hideProgress();var g={};g.OK=function(){blockOperation=false;var e=f.find("img[UploadPath]").attr("UploadPath");var q=f.find('input[type="text"]').val();if(e&&e.indexOf("__filename__")>-1){if(q){e=e.replace("__filename__",encodeURI(q))}}else{if(e){if(q){e+=q}}else{e=q}}f.dialog("close");o(e,q)};g.Cancel=function(){f.dialog("close")};f.dialog("option","buttons",g);f.bind("dialogclose",function(e,q){f.dialog("destroy")});return f};RichDialog.GetButtons=function(c,g,d,a,b,f){var e={};if(!d){e[translator.saveAndClose]=function(){RichDialog.Update(c,g,a,b,f);$(this).dialog("close")};e[translator.close]=function(){$(this).dialog("close")}}else{e[translator.close]=function(){$(this).dialog("close")}}return e};RichDialog.Open=function(p,f,b,k,m,q){begin();var j;if(b){if(!f){j=$("#rich")}else{j=$("#richDisabled")}}else{j=$("#notRich");if(!f){j.find("textarea").removeAttr("disabled")}else{j.find("textarea").attr("disabled","disabled")}}j.dialog("option","title",translator.editHtmlOn+views[k].gViewDisplayName);j.dialog("option","buttons",RichDialog.GetButtons(j,p,f,b,k,q));j.dialog("option","height","auto");j.dialog("option","width","auto");j.dialog("open");RichDialog.Load(j,p,f,b,k,m);var o=j.find("textarea");var e=j.find("iframe");var d=j.width();var l=j.height();var a=o.width();var r=o.height();var h=e.width();var g=e.height();j.on("dialogresizestop",function(u,v){var s=j.width()-d;var t=j.height()-l;o.width(a+s);o.height(r+t);e.width(h+s);e.height(g+t)});complete(k);if(!f){try{e.contents().find("body").focus()}catch(c){}}};RichDialog.spryValidation=null;RichDialog.Load=function(g,o,c,b,j,m){var d=m;if(!c){var a=GetJsonViewForEdit(j);var k;try{k=getFieldJson(o,a).Fields[0].Value}catch(f){}var h={};var e;if(b){e="richSpan"}else{e="notRichSpan"}if(RichDialog.spryValidation){RichDialog.spryValidation.reset()}var l=$("#"+e).find("textarea");if(b){l.htmlarea("dispose")}l.attr("name",o);l.attr("viewName",views[j].gViewName);if(k){h.isRequired=k.Required;if(k.Max&&k.Max>0){h.maxChars=k.Max;h.useCharacterMasking=true}}if(!b){RichDialog.spryValidation=new Spry.Widget.ValidationTextarea(e,h)}l.val(d);if(b){l.htmlarea()}}else{if(b){$("#richDiv").html(d)}else{$("#notRichTextArea").val(d)}}};RichDialog.GetUploadElement=function(e,f,c){var d=null;var a=views[c].Controller;var b=rootPath+a+"/GetUploadForRich/"+e;$.ajax({url:b,contentType:"application/json; charset=utf-8",data:{viewName:e,fieldName:f,guid:c},async:false,cache:false,error:ajaxErrorsHandler,success:function(g){d=g}});return d};RichDialog.GetValue=function(b,d,a){var c=null;$.ajax({url:views[a].gGetRichUrl,contentType:"application/json; charset=utf-8",data:{viewName:views[a].gViewName,pk:b,fieldName:d},async:false,cache:false,error:ajaxErrorsHandler,success:function(e){c=e}});return c};RichDialog.Update=function(e,j,b,f,k){var h;if(b){h=$("#richTextArea")}else{h=e.find("textarea")}var c=h.val();if(b){var a=GetJsonViewForEdit(f);var g;try{g=getFieldJson(j,a).Fields[0].Value;if(g&&g.Max&&c.length>g.Max){ajaxNotSuccessMsg("Html limited to "+g.Max+" characters!");return}}catch(d){}}if(k){k(c)}};RichDialog.HandleSuccess=function(c,a,b,d){RichDialog.Close(a);$(d).parent("div").html(c);hideProgress()};RichDialog.Close=function(a){if(a){$("#rich").dialog("close")}else{$("#notRich").dialog("close")}};var Dependency;if(!Dependency){Dependency={}}Dependency.Init=function(b,e,a){if(b.attr("insideDependency")=="insideDependency"){var c=b.attr("dependentFieldViewName");var d=b.attr("dependentFieldNames").split(";");Dependency.LoadInside(c,d,e,b[0],a);insideDependencyChange(b,a)}};Dependency.LoadInside=function(g,f,d,b,a){var e=$(b).val();var c=$(b).attr("dpk");$(f).each(function(){var h=$("#"+a+d+ReplaceNonAlphaNumeric(this));if(!e&&!($(b).attr("name")==f[0])){Dependency.Clear(h)}else{Dependency.Load(g,this+"",e,h,a,c)}if(h.attr("role")=="childrenCheckList"){initDropdownchecklist(h)}})};$(Dependency).bind("onbeforeLoadSelectList",function(b,a){if(a.data.viewName2=="View"&&a.data.fieldName=="DisplayColumn"){a.data.viewName2="Field";a.data.fk=a.pk}});Dependency.Load=function(h,l,k,g,e,b,a){var c={viewName2:h,fieldName:l,fk:k};if(!a){a=views[e].gGetSelectListUrl}if(h=="View"&&l=="DisplayColumn"){a="/Admin/GetSelectList"}var f=g.attr("filter")=="filter";var d=g.length>0&&g[0].multiple;if(!f&&d&&g.attr("hasInsideTrigger")=="hasInsideTrigger"){c.pk=b||"";a=a.replace("GetSelectList","GetDependencyCheckList")}var j={select:g,guid:e,url:a,data:c,pk:b};$(Dependency).trigger("onbeforeLoadSelectList",j);if(!c.viewName2||!c.fieldName){return}$.ajax({url:j.url,contentType:"application/json; charset=utf-8",data:c,async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(m){var o=g.val();Dependency.LoadSelectList(g,m.Options);if(!d||g.attr("hasInsideTrigger")!="hasInsideTrigger"){g.val(o)}$(Dependency).trigger("onafterLoadSelectList",{select:g,guid:e})}})};Dependency.onafterLoadSelectList=function(){};Dependency.LoadSelectList=function(b,d){Dependency.Clear(b);var e;for(var c=0,a=d.length;c<a;++c){if(d[c].Selected){e=' selected="selected"'}else{e=""}b.append('<option value="'+d[c].Value+'"'+e+">"+d[c].Text+"</option>")}};Dependency.Clear=function(a){var b=a.children(":first").text();a.empty();a.append('<option value="">'+b+"</option>")};Dependency.ClearAll=function(a,b){var d=GetPrefix(a,b);while(a!=null){Dependency.Clear(a);if(a.attr("outsideDependency")=="outsideDependency"){var e=a.attr("dependentFieldName");var c=a.attr("dependentFieldViewName");a=$("#"+b+d+ReplaceNonAlphaNumeric(e))}else{a=null}}};function GetPrefix(b,a){var c=null;if(b.parents().index($("#"+a+"DataRowCreate"))>=0){c=createPrefix}else{if(b.parents().index($("#"+a+"DataRowEdit"))>=0){c=editPrefix}else{if(b.parents("form:first").attr("d_prefix")=="InlineAdding"){c=inlineAddingPrefix}else{if(b.parents("form:first").attr("d_prefix")=="InlineEditing"){c=inlineEditingPrefix}else{c=createPrefix}}}}return c}var WorkFlow;if(!WorkFlow){WorkFlow={}}WorkFlow.CompleteStep=function(h,e,g,a,d){var f=EditDialog.AllowEdit(e,h);if(f.disabled){ajaxNotSuccessMsg(f.message,e);return}if(d!=null){d.attr("changed","no")}if(typeof(a)=="string"){var c=a.indexOf("$$error$$",0);var b=!(c<0||c>1000);if(b){blockOperation=false;ajaxNotSuccessMsg(a,e);return}}if(a.IsResult){if(a.MessageOnly){modalSuccessMsg(a.WorkflowCompletedMessage);blockOperation=false;if(d!=null){d.dialog("close")}AddDialog.Refresh(e,h)}else{WorkFlow.OpenStepDialog(h,e,g,a,d);hideProgress()}}else{EditDialog.HandleSuccess(a,e)}blockOperation=false};WorkFlow.OpenStepDialog=function(g,c,e,a,b){var d=WorkFlow.CreateStepDialog(g,c,e,a,b);var h=views[c].gViewDisplayName+" "+translator.WorflowSteps;FloatingDialog.Open(d,h,true,c);$("#stepsTabs").tabs({select:function(k,l){if(l.index==1){var m=$("#stepsGraphTab iframe");if(m.attr("src")=="about:blank"){var j=FloatingDialog.TheDialog.attr("guid");m.attr("src",rootPath+views[j].Controller+"/WorkFlowGraph/"+views[j].gViewName+"?viewName="+views[j].gViewName)}}return true}});$("#stepsTabs").tabs("select","#stepsVisualTab");d.bind("dialogresize",function(j){setDialogIframeSize("stepsGraphTabIframe")});d.bind("dialogclose",function(j){$("#stepsGraphTabIframe").attr("src","about:blank")});var f={};f[translator.close]=function(){if(b!=null){b.attr("changed","no");b.dialog("close")}blockOperation=false;d.dialog("close");AddDialog.Refresh(c,g)};f[translator.cancel]=function(){d.dialog("close")};d.dialog("option","buttons",f)};WorkFlow.CompleteStepUpdate=function(h,e,g,a,d,f,c){var b=rootPath+views[e].Controller+"/CompleteStep/"+views[e].gViewName;$.post(b,{viewName:views[e].gViewName,pk:h,guid:e,stepId:d.Id,prevStepId:a.CurrentStepId},function(k){var j=k.indexOf("$$error$$",0);if(j<0||j>1000){EditDialog.HandleSuccess(k,e);if(c!=null){c.dialog("close")}f.dialog("close")}else{ajaxNotSuccessMsg(k,e)}hideProgress()})};WorkFlow.CreateStepDialog=function(u,m,c,f,o){var r=$("<div />");var l=views[m].showDisabledSteps;$("#stepsTabs").remove();var s=$('<div id="stepsTabs"></div>');var j=$('<div id="stepsVisualTab" class="WfStep"></div>');var v=$("<center></center>");j.append(v);if(f.Message!=null&&f.Message!=""){var k=$("<p></p>");var g=$("<span></span>");var d=$('<span class="moreInfo"></span>');g.text(f.Message);k.append(g);if(f.Description!=null&&f.Description!=""){d.text(" "+translator.MoreInfo);d.attr("title",f.Description);k.append(d);initTooltip(d)}v.append(k)}if(f.EnabledSteps!=null){var t=$("<table></table>");v.append(t);var b=translator.ShowAllSteps==null?"Show All Steps:":translator.ShowAllSteps;var h=$('<input type="checkbox" />');Durados.CheckBox.SetChecked(h,l);var q=$("<tr></tr>");t.append(q);q.attr("enabled",true);var e=$('<td colspan="2" align="right">'+b+"</td>");q.append(e);var a=$("<td></td>");q.append(a);a.append(h);$(f.EnabledSteps).each(function(){var w=this;var B=$("<tr></tr>");var E=$('<td class="urHere" valign="middle" align="right"></td>');if(f.CurrentStepId==w.Id){var D=$('<span style="vertical-align:middle"></span>');D.text(translator.UrHere);var x=$('<img  height="20px"  width="20px" ALIGN="middle"/>');x.attr("src","/Content/Images/forward.png");E.append(D);E.append(x)}var z=$('<td class="wfStepName" align="left"></td>');var y=$("<span></span>");y.text(w.Name);z.append(y);var p=w.Enable?"/Content/Images/GreenCheck.png":"/Content/Images/RedCross.png";var A=$("<img />");A.attr("src",p);A.attr("alt",w.Name);A.attr("title",w.Description);y.attr("title",w.Description);var C=$('<td align="center"></td>');C.append(A);if(w.Enable){B.attr("class","enabledStep");B.click(function(){showProgress();setTimeout(function(){WorkFlow.CompleteStepUpdate(u,m,c,f,w,r,o)},1)})}else{B.attr("class","disabledStep")}B.append(E);B.append(z);B.append(C);B.attr("enabled",w.Enable);t.append(B);if(w.Description!=null&&w.Description!=""){initTooltip(y);initTooltip(A)}});t.find("tr").each(function(){if($(this).attr("enabled")=="false"){if(!l){$(this).hide()}}});h.click(function(){if(!h.is(":checked")){t.find("tr").each(function(){if($(this).attr("enabled")=="false"){$(this).hide()}})}else{t.find("tr").each(function(){$(this).show()})}})}s.prepend('<div id="stepsGraphTab"><iframe id="stepsGraphTabIframe" class="dialogIframe" src="about:blank" frameborder="0" onload="setDialogIframeSize(this.id)" scrolling="auto" height="100%" width="100%"></iframe></div>');s.prepend(j);s.prepend('<ul><li><a href="#stepsVisualTab">Steps</a></li><li><a href="#stepsGraphTab">Workflow</a></li></ul>');return r.append(s)};function setDialogIframeSize(b){var a=$("#"+b).closest("div.ui-dialog-content").height()-60;$("#"+b).height(a)}var EditDialog;if(!EditDialog){EditDialog={}}EditDialog.GetButtons=function(f,c,a,d){var e={};if(!a){if(d){e[translator.saveAndClose]=function(){EditDialog.Update(f,c,true,false,false)}}}else{if(isDock(c)){var h=translator.cancel;if(isDockFields(c)&&window.parent.parent.queryString("settings")!="fields"){h=translator.Settings}e[h]=function(){if(isDockFields(c)){if(window.parent.parent.queryString("settings")=="fields"){var k=null;var j=views[c]==null?false:views[c].Role=="View Owner";if(j){k=window.parent.parent.reloadPage}else{k=function(){window.parent.parent.location=window.parent.parent.location.href.replace("settings=fields","")}}Durados.Dialogs.Confirm(translator.CancelChangesTitle,translator.CancelChangesMessage,k,null)}else{CancelPreview(views[c].ViewName);window.parent.parent.Refresh(window.parent.parent.getMainPageGuid());window.parent.parent.viewProperties(window.parent.parent.getMainPageGuid(),false,window.parent.parent.dock.width,window.parent.parent.dock.url,window.parent.parent.dock.viewDisplayName)}}else{EditDialog.Close(c,f,false,true)}}}else{if(views[c].ViewName=="Field"){if(window.parent){var b=decodeURIComponent(queryString2(window.parent.location.href,"backUrl"));e[translator.cancel]=function(){window.parent.location=b}}}}}if(d){e[translator.save]=function(){EditDialog.Update(f,c,false,false,false)}}if(d&&views[c].WorkFlowStepsFieldName!=""){var g={pk:f,guid:c,hide:false};$(EditDialog).trigger("promoteButton",g);if(!g.hide){e[translator.saveAnd+views[c].PromoteButton]=function(){EditDialog.Update(f,c,false,false,true)}}}if(d&&isAdmin(c)&&!d_autoCommit){e[translator.saveAndCommit]=function(){EditDialog.Update(f,c,false,true,false)}}if(!a){e[translator.close]=function(){EditDialog.Close(c,f,false,true)}}return e};EditDialog.GetButtonsForSelection=function(a,b){var c={};c[translator.saveAndClose]=function(){EditDialog.UpdateSelection(a,true,b)};c[translator.save]=function(){EditDialog.UpdateSelection(a,false,b)};c[translator.cancel]=function(){b.dialog("close")};return c};EditDialog.Open=function(d,c,a,e){var b=views[c].DataDisplayType;if(b=="Preview"&&$("#"+c+"DataRowEdit").attr("pk")==d){return}begin();setTimeout(function(){EditDialog.Open2(d,c,a,e)},1)};EditDialog.AllowEdit=function(a,b){if(views[a].disabledRows[b]==null||views[a].WorkFlowStepsFieldName!=""){views[a].disabledRows[b]=EditDialog.IsDisabled(a,b)}return views[a].disabledRows[b]};EditDialog.IsDisabled=function(b,c){var a={disabled:true,message:""};if(views[b].HasOpenRules){$.ajax({url:rootPath+views[b].Controller+"/IsDisabled/"+views[b].gViewName,contentType:"application/json; charset=utf-8",data:{viewName:views[b].gViewName,pk:c,guid:b},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(d){a=d}});return a}else{return{disabled:!views[b].AllowEdit,message:""}}};function addMessage(a,b){var c=a.find("div.dialogTitle");if(c.length==1){c.html(b);c.show()}}function removeMessage(a){var b=a.find("div.dialogTitle");if(b.length==1){b.html("");b.hide()}}EditDialog.Open2=function(v,l,b,f){if(views[l]==null){return}var h=views[l].DataDisplayType;var t=$("#"+l+"DataRowEdit");var j=EditDialog.AllowEdit(l,v);if(h=="Preview"){PreviewDisplay.trySaveChanges(l);PreviewDisplay.saveElementState(l)}t.dialog("option","dialogClass","");EditDialog.Reset(l,views[l].gViewName);if(h=="Preview"){PreviewDisplay.initDialogSettings(l,v)}else{if(!j.disabled){t.dialog("option","title",translator.editRowOn+views[l].gViewDisplayName);removeMessage(t)}else{t.dialog("option","title",translator.viewRowOn+views[l].gViewDisplayName);addMessage(t,j.message)}if(!t.prop("item")){t.siblings(".ui-dialog-titlebar").show();Durados.Dialogs.zIndex(t,100001)}var r=EditDialog.GetButtons(v,l,b,!j.disabled);t.dialog("option","buttons",r);var k=83;shortcutKey(t,r[translator.save],k,true);var u=69;shortcutKey(t,r[translator.saveAndClose],u,true);var o=isMaximizeDialog(l);var c=o==true?"max":$.cookie("state_"+views[l].gViewName);if(itemEditDialog==null||itemEditDialog.attr("id")!=t.attr("id")){currentViewName=views[l].gViewName;if(c!="max"){var g=Rectangle.Load(currentViewName);if(g!=null){t.dialog("option","position",[g.left,g.top])}}else{dialogExt.max(t,null,l)}}}t.dialog("option","stack",false);var q=EditDialog.GetJsonViewValue(v,l,"Edit");if(q==null){ajaxNotSuccessMsg("The record that you request to edit has been deleted.",l);return}if(isViewItem(l)){t.dialog("option","title",EditDialog.getViewDisplayName(q,l,editPrefix))}if((IsItem()&&(views[l].ViewName=="View"||views[l].ViewName=="Field"))){t.dialog({hide:{effect:"fold",duration:500}})}else{t.dialog({show:{effect:"fold",duration:500},hide:{effect:"fold",duration:500}})}t.dialog("open");if(views[l].ViewName=="Field"){var a=t.find("select[name='DisplayFormat']");if(displayFormatOriginalOptions==null){displayFormatOriginalOptions=a.html()}else{a.html(displayFormatOriginalOptions)}}EditDialog.Load(v,editPrefix,l,q,"DataRowEdit",j.disabled);AddDialog.HandleTab(v,"EditTabs",l);var m=$("#"+l+"EditTabs").tabs("option","disabled");if(m.length>0&&m[0]!=0){Durados.Tabs.select($("#"+l+"EditTabs"),0)}if(h=="Preview"){Durados.Tabs.select($("#"+l+"EditTabs"),0)}EditDialog.HandleCounter(q,"EditTabs",l);hideProgress();initDropdownChecklistsEdit(l);if(h!="Preview"){setFocusInDialog(t)}t.attr("changed","no");Durados.Dialogs.BindToChangeEvent("input",t);Durados.Dialogs.BindToChangeEvent("select",t);Durados.Dialogs.BindToChangeEvent("textarea",t);if(h=="Preview"){t.find("input").keydown(function(){t.attr("changed","yes")})}subgridsHashes[l]=new Array();$(Durados.View).trigger("editBeforeDerivation",{pk:v,guid:l,dialog:t,viewName:views[l].ViewName});initDerivationOnShow(views[l].jsonViewForEdit.Derivation,t,editPrefix,l,views[l].jsonViewForEdit.ViewName);EditDialog.DisableCloneView(editPrefix,l,q);PreviewDisplayModeViewJson=q;if(window.location.href.indexOf("Admin/Item/View?")>-1||window.location.href.indexOf("Admin/IndexPage/Field?")>-1){InlineEditingDialog.SetAdminPreviewEvents(t,views[l].ViewName,l)}if(views[l].ViewName=="Field"){var p=t.find('[name="DataType"]');t.find("[name=RelatedViewName]").parents("tr:first").parents("tr:first").hide();if(p.length==1){p.change(function(){setDataType(t,p)});if(p.val()=="SingleSelect"){setDataType(t,p)}}}$(Durados.View).trigger("edit",{pk:v,guid:l,dialog:t,viewName:views[l].ViewName,prefix:editPrefix});try{if(views[l].ViewName=="Field"&&plugIn()){t.parent().find("button.ui-button").each(function(){if($(this).text()==translator.save){$(this).css("display","none")}if($(this).text()==translator.cancel){$(this).find("span").text("Back")}})}}catch(d){}Multi.SelectByPK(l,v);if(f){f()}};function plugIn(){try{return((parent&&parent.refreshWidget2)||(parent&&parent.parent&&parent.parent.refreshWidget2))}catch(a){return false}}function plugInRefresh(){try{if(parent&&parent.refreshWidget2){parent.refreshWidget2()}else{if(parent&&parent.parent&&parent.parent.refreshWidget2){parent.parent.refreshWidget2()}}}catch(a){}}function isViewItem(a){return window.parent&&window.location.href.indexOf("Admin/Item/View?")>-1&&views[a]&&views[a].ViewName=="View"}function resizeWindow(){clearTimeout(toResize);clearTimeout(dialogResize);if(adjustDataTableHeightDisabled){return}toResize=setTimeout(function(){adjustDataTableHeight();$(".fixedViewPort table.gridview").each(function(){var a=$(this).closest(".ajaxDiv").attr("guid");Durados.GridHandler.setColumnsWidth(a)})},600);if(!resizing){dialogResize=setTimeout(dialogExt.resizeCurrent,600)}}function isDock(a){try{if(window.parent&&window.parent.Refresh&&window.location.href.indexOf("Admin/Item/View?")>-1){return true}else{if(window.parent&&window.parent.parent&&window.parent.parent.Refresh&&window.location.href.indexOf("Admin/IndexPage/Field?")>-1){return true}}}catch(b){}return false}function isDockFields(a){try{if((window.parent&&window.parent.parent&&window.parent.parent.Refresh&&window.location.href.indexOf("Admin/IndexPage/Field?")>-1)||(a&&views[a].ViewName=="Field"&&views[a].DataDisplayType=="Preview")){return true}}catch(b){}return false}function setFocusInDialog(c){try{c.find("iframe").contents().find("body").focus()}catch(d){}var b=c.find("input:visible:enabled:first");var a=c.find("select:visible:enabled:first");if(a.length>0&&b.length>0){if(a.offset().top-1<b.offset().top){setTimeout(function(){a.focus()},1)}else{if(a.offset().top-1==b.offset().top){if(a.offset().left<b.offset().left){setTimeout(function(){a.focus()},1)}else{setTimeout(function(){b.focus()},1)}}else{setTimeout(function(){b.focus()},1)}}}else{if(b.length>0){setTimeout(function(){b.focus()},10)}else{if(a.length>0){setTimeout(function(){a.focus()},1)}else{$("input:visible:enabled:first").focus()}}}}EditDialog.HandleCounter=function(a,e,h){var d=$("#"+h+e);for(var f=0,g=a.Fields.length;f<g;++f){var j=a.Fields[f].Value;var b="FkCounter_";if(j.Name.startsWith(b)){var l=j.Name.split(b)[1];var c=j.Value;if(c==null||c==""){c=0}var k=d.find('li[childrenFieldName="'+l+'"]').find('span[hasCounter="hasCounter"]');k.text(c)}}};function toggleDeleteValues(b,e){var d=$(b).parents("td.rowViewCell").first().find("input,select,textarea").first();if(e&&d.attr("hasinsidetrigger")=="hasInsideTrigger"){var c=d.attr("triggername");EditDialog.multiDialog.find('select[name="'+c+'"]').parents("td.rowViewCell").first().find("img.inlineDelImg").first().click();return}if(b.src.indexOf("plus.gif")>0){b.src="/Content/Images/minus.gif";b.alt="Exclude";b.title="Exclude field from multi edit";d.attr("ignore","no").removeAttr("disabled").filter("select.dropdownchecklist").dropdownchecklist("enable")}else{b.src="/Content/Images/plus.gif";b.alt="Include";b.title="Include field for multi edit";d.attr("ignore","").attr("disabled","disabled").filter("select.dropdownchecklist").dropdownchecklist("disable");var a=editPrefix+","+views[EditDialog.guid].gViewName+","+d.attr("name");if(a in views[EditDialog.guid].validations&&views[EditDialog.guid].validations[a]){views[EditDialog.guid].validations[a].reset()}}if(e){EditDialog.toggleDependencies(d)}}EditDialog.toggleDependencies=function(b){if(b.attr("insidedependency")=="insideDependency"){var c=b.attr("dependentFieldNames").split(";");b.attr("dpk","");for(var a=0;a<c.length;a++){EditDialog.multiDialog.find('select[name="'+c[a]+'"]').each(function(){var d=$(this).parents("td.rowViewCell").first().find("img.inlineDelImg").first();if(d.length>0){toggleDeleteValues(d[0],false)}})}}};EditDialog.OpenSelectionInitDone=false;EditDialog.OpenSelectionInit=function(c,b){EditDialog.multiDialog=c;EditDialog.guid=b;var a=GetJsonViewForEdit(b);$('<img class="inlineDelImg" title="Include field for multi edit" alt="Include" src="/Content/Images/plus.gif" onclick="toggleDeleteValues(this, true)" />').appendTo(c.find("input,select,textarea").filter(function(){if($(this).attr("type")=="hidden"||$(this).attr("filter")=="filter"){return false}var e=$(this).attr("name");for(var f=0,d=a.Fields.length;f<d;++f){if(a.Fields[f].Key==e){if(a.Fields[f].Value.Disabled){return false}else{$(this).attr("disabled","disabled");if($(this).attr("hasInsideTrigger")=="hasInsideTrigger"){var g=$(this).attr("triggerName");for(var h=0;h<d;++h){if(g==a.Fields[h].Key){if(a.Fields[h].Value.Disabled){return false}else{break}}}}return true}}}return false}).parents("td.rowViewCell"))};EditDialog.OpenSelectionReset=function(b,a){b.find("img.inlineDelImg").each(function(){this.src="/Content/Images/plus.gif";this.alt="Include";this.title="Include field for multi edit";$(this).parents("td.rowViewCell").first().find("input,select,textarea").first().attr("ignore","").attr("disabled","disabled").filter("select.dropdownchecklist").dropdownchecklist("disable")})};EditDialog.OpenSelectionClose=function(b,a){b.find("img.inlineDelImg").each(function(){if(this.src.indexOf("plus.gif")>0){$(this).parents("td.rowViewCell").first().find("input,select,textarea").first().removeAttr("disabled").filter("select.dropdownchecklist").dropdownchecklist("enable")}})};EditDialog.getDialog=function(a){if(views[a].DataDisplayType=="Preview"){return $("#"+a+"DataRowEdit_clone")}else{return $("#"+a+"DataRowEdit")}};EditDialog.OpenSelection=function(b,a){begin();var c=EditDialog.getDialog(b);c.dialog("option","title",translator.editRowsOn+views[b].gViewDisplayName);var f=EditDialog.GetButtonsForSelection(b,c);c.dialog("option","buttons",f);var d=83;shortcutKey(c,f[translator.save],d,true);var g=69;shortcutKey(c,f[translator.saveAndClose],g,true);EditDialog.Reset(b,views[b].gViewName);if(!EditDialog.OpenSelectionInitDone){EditDialog.OpenSelectionInit(c,b)}else{EditDialog.OpenSelectionReset(c,b)}EditDialog.OpenSelectionInitDone=true;currentViewName=views[b].gViewName;var h=Rectangle.Load(currentViewName);if(h!=null){c.dialog("option","position",[h.left,h.top])}c.dialog("option","dialogClass","multiupdates");c.bind("dialogclose",EditDialog.OpenSelectionClosed);c.dialog("open");complete(b);initDropdownChecklistsEdit(b,c);$(Durados.View).trigger("multiEdit",{pks:Multi.GetSelection(b),guid:b,dialog:c,viewName:views[b].ViewName,prefix:editPrefix})};EditDialog.OpenSelectionClosed=function(c,d){var b=$(this);var a=b.find("div[ajaxdiv]").first().attr("guid");EditDialog.OpenSelectionClose(b,a);b.unbind("dialogclose",EditDialog.OpenSelectionClosed)};function ReplaceNonAlphaNumeric(a){return a.replace(/ /g,"_").replace(/-/g,"_").replace(/\+/g,"_").replace(/\//g,"_").replace(/\*/g,"_").replace(/\./g,"_").replace(/\=/g,"_").replace(/\!/g,"_").replace(/\@/g,"_").replace(/\#/g,"_").replace(/\$/g,"_").replace(/\%/g,"_").replace(/\^/g,"_").replace(/\&/g,"_")}EditDialog.UpdateSelection=function(b,h,c){var d=jQuery.extend(true,{},GetJsonViewForEdit(b));var e=c.find("form[d_prefix]");var g=true;$(d.Fields).each(function(){var o=this.Value;var p=ReplaceNonAlphaNumeric(o.Name);var l=$("#"+b+editPrefix+p);if(views[b].DataDisplayType=="Preview"){l=$("#"+b+editPrefix+p+"_clone")}var j=editPrefix+","+d.ViewName+","+p;if(l.attr("ignore")=="no"){var m="the"+b+editPrefix+d.ViewName+"_"+o.Name;if(views[b].DataDisplayType=="Preview"){m="the"+b+editPrefix+d.ViewName+"_"+o.Name+"_clone"}if(views[b].validations&&j in views[b].validations&&views[b].validations[j]){}else{views[b].validations[j]=getFieldValidation(o,m,l)}if(views[b].validations[j]){if(!views[b].validations[j].validate()){g=false}}}});if(!g){modalSuccessMsg(getErrorsList(c));return}begin();var a=Multi.GetSelection(b);var f=null;if(views[b].DataDisplayType=="Preview"){f="_clone"}$.post(views[b].gEditSelectionUrl,{pks:Sys.Serialization.JavaScriptSerializer.serialize(a),jsonView:Sys.Serialization.JavaScriptSerializer.serialize(FillJson(d,editPrefix,b,c,true,null,f)),guid:b},function(k){var j=k.indexOf("$$error$$",0);if(j<0||j>1000){EditDialog.HandleSuccess(k,b);c.attr("changed","no");Multi.SelectByPKs(b,a);if(h){EditDialog.Close(b,null,true,true)}}else{ajaxNotSuccessMsg(k,b)}})};EditDialog.Reset=function(a,c){if(views[a].DataDisplayType=="Preview"){var b=EditDialog.getDialog(a);b.find("form")[0].reset();resetUpload();clearWysiwyg(b)}else{$("#"+a+"Edit"+ReplaceNonAlphaNumeric(c)+"DataRowForm")[0].reset();resetUpload();var b=$("#"+a+"DataRowEdit");clearWysiwyg(b)}};EditDialog.GetFields=function(h,d,e){var b=[];var g=[];for(var c=0,a=h.Fields.length;c<a;++c){var f=h.Fields[c].Value;g[f.Name]={field:f,loaded:false}}for(var c=0,a=h.Fields.length;c<a;++c){var f=h.Fields[c].Value;EditDialog.PushField(b,g,f,d,e)}if(b.length!=h.Fields.length){alert("Error in loading dependency. Please contact the administrator.")}return b};EditDialog.PushField=function(a,g,f,d,e){if(!g[f.Name].loaded){var h=d+e+ReplaceNonAlphaNumeric(f.Name);var c=$("#"+h);if(c.attr("hasInsideTrigger")=="hasInsideTrigger"){var b=c.attr("triggerName");if(g[b]==null){ajaxNotSuccessMsg("Please verify that the Trigger Field '"+b+"' is not Hidden and exists. This trigger belong to '"+f.Name,d);return}if(g[b].loaded){EditDialog.PushField2(a,g,f)}else{EditDialog.PushField(a,g,g[b].field,d,e);EditDialog.PushField2(a,g,f)}}else{EditDialog.PushField2(a,g,f)}}};EditDialog.PushField2=function(a,c,b){a.push(b);c[b.Name].loaded=true};EditDialog.getViewDisplayName=function(f,c,d){for(var b=0,a=f.Fields.length;b<a;++b){var e=f.Fields[b].Value;if(e.Name=="DisplayName"){return e.Value+" "+translator.Settings}}return translator.Settings};EditDialog.Load=function(b,e,k,a,d,c){if(c==null){c=true}$("#"+k+e.slice(0,-1).capitalize()+ReplaceNonAlphaNumeric(a.ViewName)+'DataRowForm textarea[rich="true"]').each(function(){$(this).htmlarea("dispose")});var f=EditDialog.GetFields(a,k,e);for(var h=0,g=f.length;h<g;++h){var m=f[h];EditDialog.LoadField(b,e,k,m)}if(d==null){d="DataRowEdit"}var j=$("#"+k+d);Durados.Dependencies.cleanUp();for(var h=0,g=f.length;h<g;++h){var m=f[h];if(m.DependencyData){Durados.Dependencies.Apply(m.Name,m.Value,k,j,a.Fields);Durados.Dependencies.createHandlers($("#"+k+e+ReplaceNonAlphaNumeric(m.Name)),k,a.Fields,a.ViewName,e)}}j.find(".childrenViewer").attr("pk",b);j.attr("pk",b);j.find("div.childrenViewer").each(function(){$(this).html("")});j.find("span.inlineAddingImg").each(function(){expand(this,true,null,c,k)});if(a.ViewName=="Field"){var l=j.find('[name="DataType"]');var o=l.parents("table:first").parents("table:first");o.find("tr.data-type-settings-row").remove()}$(EditDialog).trigger("onafterEditLoad",{guid:k,dialog:j,json:a,pk:b,viewName:a.ViewName})};EditDialog.DisableCloneView=function(d,g,a,j){if(j||views[g].ViewName=="View"||views[g].ViewName=="Field"){for(var e=0,f=a.Fields.length;e<f;++e){var h=a.Fields[e].Value;var k=ReplaceNonAlphaNumeric(h.Name);var c=g+d+k;var b=$("#"+c);b.attr("disabled",h.Disabled)}}};EditDialog.DisableDialog=function(d,c,h){for(var b=0,a=h.Fields.length;b<a;++b){var e=h.Fields[b].Value;var g=ReplaceNonAlphaNumeric(e.Name);var f=$("#"+c+d+g);disableField(f,c,d,views[c].ViewName)}};EditDialog.LoadField=function(x,t,r,a){var c=ReplaceNonAlphaNumeric(a.Name);var o=r+t+c;var j=$("#"+o);if(j.length==1){if(j.attr("htmlType")=="htmlType"){j.val(a.Value);var m=j=$("#"+o+"htmlType");m.html(a.Value)}else{if($(j[0]).attr("upload")=="upload"&&!j.is("textarea")){if(a.Disabled==true){j.val(a.Value)}else{UploadFile(a.Name,t,r);var g=$("#"+r+t+"upload_img_"+ReplaceNonAlphaNumeric(a.Name)).attr("UploadPath");if(!g){g=""}showUpload(a.Name,t,a.Value,g+a.Value,r)}}else{if(a.Type=="CheckList"){loadChecklist(j,a.Value)}else{if($(j[0]).attr("radioButtons")=="radioButtons"){Durados.CheckBox.SetChecked($("[name="+r+t+a.Name+"][value="+a.Value+"]"),"checked")}else{if(j.attr("outsideDependency")=="outsideDependency"){j.val(a.Value);var h=j.attr("dependentFieldName");var e=j.attr("dependentFieldViewName");var p=$("#"+r+t+ReplaceNonAlphaNumeric(h));Dependency.Load(e,h,a.Value,p,r)}else{if(j.attr("insideDependency")=="insideDependency"){if(j.find('option[value="'+a.Value+'"]').length==0){j.append('<option value="'+a.Value+'">'+a.Default+"</option>")}j.val(a.Value);j.attr("dpk",x);var e=j.attr("dependentFieldViewName");var s=j.attr("dependentFieldNames").split(";");Dependency.LoadInside(e,s,t,j[0],r)}else{if(j.attr("color")=="1"){var q=a.Value;var d=q!=null&&q!="";var k=d?"":"disabled";var l=j.siblings("input[type=checkbox]");var y=d?"enable":"disable";Durados.CheckBox.SetChecked(l,d);if(!d){q="#ffffff"}var f=$('<input type="text">');initColorPicker(f);f.spectrum("set",q);if(f.spectrum("get").alpha==1){q=f.spectrum("get").toHexString()}j.spectrum("set",q);j.spectrum(y)}else{if(j[0].type=="textarea"){j.val(a.Value);if(j.attr("rich")=="true"){$("#"+r+t+c).htmlarea()}}else{if(j[0].nodeName=="DIV"){j.html(a.Value)}else{if(j[0].type=="checkbox"){Durados.CheckBox.SetChecked(j,a.Value)}else{if(j.attr("d_type")=="Url"){j.attr("value",a.Value);var b=a.Value.split("|");var w="";var u="";var z="_blank";if(b.length==3){w=b[0];u=b[2];z=b[1]}else{if(b.length==1){u=b[0]}}if(w==""&&u!="#"){w=u}var v=j.attr("format");if(v=="ButtonLink"){j.find("button span").text(w)}else{j.find("span").text(w)}j.attr("href",u);j.attr("target",z)}else{if(a.Type=="Autocomplete"){j.attr("valueId",a.Value);if(a.Default!=null){j.val(a.Default)}}else{if(t==createPrefix&&j.attr("disabled")&&j.val()!=""){}else{if(j[0].nodeName=="SELECT"){if(j.find('option[value="'+a.Value+'"]').length==0&&a.Default!=null){j.append('<option value="'+a.Value+'">'+a.Default+"</option>")}}j.val(a.Value);if(j.prev().find("UL").length==1){slider.SetLoadSelectedImage(j)}}}}}}}}}}}}}}if(j.hasClass("date")){triggerDateChanged(j)}}};function clearAndLoadChecklist(a,b){a.find("option:selected").removeAttr("selected");loadChecklist(a,b)}function loadChecklist(b,d){var a=b.find("option");a.each(function(){$(this).removeAttr("selected")});if(d==null||d==""){return}var c=d.split(",");$(c).each(function(){var e=this+"";a.each(function(){if($(this).attr("value")==e){$(this).attr("selected","selected")}})})}EditDialog.GetJsonViewValue=function(b,a,d){var c=null;$.ajax({url:views[a].gGetJsonViewUrl,contentType:"application/json; charset=utf-8",data:{viewName:views[a].gViewName,dataAction:d,pk:b,guid:a},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(e){if(e==null||e==""){ajaxNotSuccessMsg("")}else{c=Sys.Serialization.JavaScriptSerializer.deserialize(e)}}});return c};EditDialog.Close=function(b,e,d,g){var a=true;var c=EditDialog.getDialog(b);var f=c.attr("changed")=="yes";if(f){if(confirm("Exit without save?")){c.attr("changed","no");if((views[b].ViewName=="View"||views[b].ViewName=="Field")&&isAdmin(b)){CancelPreview(views[b].ViewName);if(window.parent&&window.parent.reloadPage&&window.location.href.indexOf("Admin/Item/View?")>-1){window.parent.reloadPage("&settings=false")}}if(views[b].RefreshOnClose=="True"&&!d){AddDialog.Refresh(b,e)}else{Multi.SelectByPK(b,e)}}else{a=false}}else{c.attr("changed","no");if(views[b].RefreshOnClose=="True"&&!d){AddDialog.Refresh(b,e)}else{Multi.SelectByPK(b,e)}}if(a){if(views[b].ReloadPage=="Edit"||views[b].ReloadPage=="Always"){reloadPage()}if(g){c.dialog("close")}}return a};EditDialog.Update=function(f,h,l,o,c,e){var g=$("#"+h+"DataRowEdit");var m=GetJsonViewForEdit(h);if(EditDialog.isValid(h,m.ViewName)==false){modalSuccessMsg(getErrorsList(g));return}saveElementScrollsPosition(h);begin();var b=views[h].gEditUrl;if(c){b=rootPath+views[h].Controller+"/EditStep/"+views[h].gViewName}if(views[h].ViewName=="Field"){var k=g.find('[name="DataType"]');if(k.length==1){if(!isValidDataType(g,k)){blockOperation=false;hideProgress();return}if(isCreatingNewTableInYourDb(g)&&!confirm("The following change is going to create new table, continue?")){blockOperation=false;hideProgress();return}}}if(views[h].ViewName=="durados_Link"){if(!Bookmarks.validateGrobootViews(f,g)){return}}var m=FillJson(m,editPrefix,h,g);if(views[h].ViewName=="Field"&&g.find(".InSystemDatabase").prop("checked")){var j=jQuery.extend(true,{},m.Fields[0]);j.Key="sysdb";j.Value.Value=true;j.Value.Name="sysdb";m.Fields.push(j)}var a=Sys.Serialization.JavaScriptSerializer.serialize(m);$.post(b,{pk:f,jsonView:a,guid:h},function(s){if(views[h].ViewName=="View"||views[h].ViewName=="Field"){adminPreviewChanged=false}if(window.parent&&window.parent.reloadPage&&window.location.href.indexOf("Admin/Item/View?")>-1){var q=views[h]==null?false:views[h].Role=="View Owner";if(q){window.parent.reloadPage("&settings=true")}}else{if(window.parent&&window.parent.parent&&window.location.href.indexOf("Admin/IndexPage/Field?")>-1){g.attr("changed","no");var w=s.indexOf("$$error$$",0);var x=s.indexOf("$$message$$",0);var v=w>0&&w<1000;var t=x>0&&x<1000;var u=g.find('[name="DisplayName"]').val();if(v){ajaxNotSuccessMsg(s,h);EditDialog.selectRow(f,h,u);return}if(!plugIn()){try{if(window.parent.parent.Refresh){window.parent.parent.Refresh(window.parent.parent.getMainPageGuid(),true)}}catch(r){}}EditDialog.HandleSuccess(s,h);if(!e){EditDialog.selectRow(f,h,u)}hideProgress();return}}if(views[h].ViewName=="View"&&parent&&parent.refreshWidget2){hideProgress()}if(o){var p=rootPath+"Admin/RefreshConfig/";refreshConfig(p,h)}if(c&&s.IsResult){WorkFlow.CompleteStep(f,h,views[h].WorkFlowStepsFieldName,s,g)}else{var w=s.indexOf("$$error$$",0);var x=s.indexOf("$$message$$",0);var v=w>0&&w<1000;var t=x>0&&x<1000;if(v){ajaxNotSuccessMsg(s,h)}else{if(t){ajaxNotSuccessMsg(s,h);showProgress();refreshView(h);g.attr("changed","no");EditDialog.Close(h,f,true,true)}else{EditDialog.HandleSuccess(s,h);if(views[h].updateParent){updateParent(h)}if(views[h].updateParentGrid){updateParentGrid(h)}g.attr("changed","no");if(l){EditDialog.Close(h,f,true,true)}}}}$(EditDialog).trigger("onafterEditUpdate",{guid:h,dialog:g,json:m,pk:f,viewName:m.ViewName})});try{if(views[h].ViewName=="Field"&&plugIn()){showProgress();setTimeout(function(){plugInRefresh()},200)}}catch(d){}try{if(views[h].ViewName=="View"&&parent&&parent.refreshWidget2){showProgress();setTimeout(function(){parent.refreshWidget2()},1)}}catch(d){}};EditDialog.selectRow=function(c,b,a){var d=$("#d_row_"+b+c);if(d.length!=1){$("#"+b+"ajaxDiv").find("div.boardrow2").each(function(){var e=$(this);if(e.text().trim()==a){c=e.attr("pk");d=e}})}if(d.length==1){d.click();setTimeout(function(){EditDialog.Open2(c,b,false)},1)}};$(EditDialog).bind("onafterEditUpdate",function(a,b){Multi.SelectByPK(b.guid,b.pk);if(b.viewName=="durados_Link"){Bookmarks.validateAndSaveMessages(a,b)}if(b.viewName=="View"){if(customThemeChanged){$.ajax({url:gVD+"Admin/GetThemPath/",contentType:"application/json; charset=utf-8",async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(d){var c=window.parent.parent.getPreviewButton();$(c[0]).attr("href",$(c[0]).attr("href")+d);$(c[1]).attr("href",$(c[1]).attr("href")+d);previewButton.addClass("preview-notice")}})}}});function getPreviewButton(){return $("#mymenu").find('a[target="angularbknd"]')}EditDialog.HandleSuccess=function(c,b){var a=Multi.GetSelection(b);saveElementScrollsPosition(b);$("#"+b+"ajaxDiv").html(c);success(b);resetElementScrollsPosition(b);if(a!=null){Multi.SelectByPKs(b,a)}views[b].updateCounter()};EditDialog.isValid=function(b,d){var c=$("#"+b+"Edit"+d+"DataRowForm")[0];var e=Spry.Widget.Form.validate(c);var a=IsValidUpload(c);if(e==false||a==false){return false}return true};function IsValidUpload(b){var a=true;$(b).find("div.uploadDiv").each(function(){var f=$(this);var c=f.parents("td:first").parents("td:first");var e=c.find("span.textfieldRequiredMsg");if(e.length>0){var d=f.find("input");if(d.val()==""){a=false;c.addClass("textfieldRequiredState")}else{c.removeClass("textfieldRequiredState")}}});return a}EditDialog.Prev=function(c,a){var b=Multi.GetPrevPK(c,a);if(b!=""){EditDialog.Open(b,a,false)}};EditDialog.Next=function(c,b){var a=Multi.GetNextPK(c,b);if(a!=""){EditDialog.Open(a,b,false)}};EditDialog.GetRefreshFields=function(c,b){var a=[];$(c.Fields).each(function(){var d=this.Value;if(d.Refresh&&b.find("[name="+d.Name+"]").length==1){a.push(d)}});return a};EditDialog.RefreshFields=function(g,f){var b=Multi.GetSelection(f);var c;if(b&&b.length==1){c=b[0]}else{return}var j=EditDialog.GetRefreshFields(views[f].jsonViewForCreate,$(g.panel));if(j.length>0){var a=EditDialog.GetJsonViewValue(c,f,"Edit");for(var d=0,e=a.Fields.length;d<e;++d){var h=a.Fields[d].Value;if(h.Refresh){EditDialog.LoadField(c,editPrefix,f,h)}}}};var DeleteDialog;if(!DeleteDialog){DeleteDialog={}}DeleteDialog.GetButtons=function(c,a){var b={};b[translator.Delete]=function(){DeleteDialog.Delete(c,a)};b[translator.cancel]=function(){$(this).dialog("close")};return b};DeleteDialog.GetButtonsForSelection=function(a){var b={};b[translator.Delete]=function(){DeleteDialog.DeleteSelection(a)};b[translator.cancel]=function(){$(this).dialog("close")};return b};DeleteDialog.Open=function(e,a){$("#DeleteMessage").dialog("option","title",translator.DeleteRowFrom+views[a].gViewDisplayName);$("#DeleteMessage").dialog("option","buttons",DeleteDialog.GetButtons(e,a));var b=null;var d=$("#"+a+"ajaxDiv").find("tr.selected:first");if(d.length==1){b="'"+d.attr("d_displayvalue")+"'"}else{d=$("#"+a+"ajaxDiv").find(".boardselected");b="'"+d.clone().children().remove().end().text().trim()+"'"}if(!b){b=$("#DeleteMessage input.x2").val()}var c=$("#DeleteMessage input.x1").val();if(c){c=c.replace("{0}",b);$("#DeleteMessage").text(c)}else{$("#DeleteMessage").text("Are you sure that you want to delete the selected row?")}$("#DeleteMessage").dialog("option","position","center");$("#DeleteMessage").dialog("open")};DeleteDialog.OpenSelection=function(a){$("#DeleteSelectionMessage").dialog("option","title",translator.DeleteSelectedRows);$("#DeleteSelectionMessage").dialog("option","buttons",DeleteDialog.GetButtonsForSelection(a));$("#DeleteSelectionMessage").dialog("option","position","center");$("#DeleteSelectionMessage").dialog("open")};DeleteDialog.Close=function(a){if(views[a].ReloadPage=="Delete"||views[a].ReloadPage=="Always"){reloadPage()}$("#DeleteMessage").dialog("close")};DeleteDialog.Delete=function(b,a){begin();$.post(views[a].gDeleteUrl,{pk:b,guid:a},function(d){var c=d.indexOf("$$error$$",0);if(c<0){DeleteDialog.HandleSuccess(d,a)}else{ajaxNotSuccessMsg(d,a)}})};DeleteDialog.DeleteSelection=function(a){saveElementScrollsPosition(a);begin();$.post(views[a].gDeleteSelectionUrl,{pks:Sys.Serialization.JavaScriptSerializer.serialize(Multi.GetSelection(a)),guid:a},function(c){var b=c.indexOf("$$error$$",0);if(b<0){DeleteDialog.HandleSelectionSuccess(c,a)}else{ajaxNotSuccessMsg(c,a)}})};DeleteDialog.HandleSuccess=function(b,a){DeleteDialog.Close(a);$("#"+a+"ajaxDiv").html(b);success(a);resetElementScrollsPosition(a);views[a].updateCounter()};DeleteDialog.HandleSelectionSuccess=function(b,a){$("#DeleteSelectionMessage").dialog("close");$("#"+a+"ajaxDiv").html(b);success(a);resetElementScrollsPosition(a)};function AutoCompleteParse(c){var b=new Array();for(var a=0;a<c.length;a++){b[a]={data:c[a].Tag,value:c[a].Tag.PK,result:c[a].Tag.Name}}return b}function GetAutoCompleteValueId(a){if(a.val()==""){return""}else{return a.attr("valueId")}}function SetAutoCompleteValueId(a,c,b){a.val(c);a.attr("valueId",b)}function AutoCompleteResult(b,a){$(b.currentTarget).attr("valueId",a.PK);$(Autocomplete).trigger("result",{event:b,element:{Name:a.Name,PK:a.PK,Element:$(b.currentTarget)}})}function AutoCompleteSearch(b,a){$(b.currentTarget).attr("valueId","")}var GroupFilter;if(!GroupFilter){GroupFilter=function(){}}GroupFilter.resize=function(b){var c=b.width();var d=GroupFilter.resizeToTable(b,10,c);if(d&&d.find("tr").length>1){d.attr("width","100%")}if(d&&d.find("span.ui-dropdownchecklist:first").length==1){var a=d.find("span.ui-dropdownchecklist:first").width()+4;d.find("span.ui-dropdownchecklist").css("width",a+"px")}};GroupFilter.getTable=function(g,e){var j=$("<table></table>");var f;for(var a=0;a<e.length;a++){if(a%g==0){f=$("<tr></tr>");j.append(f)}var k=$(e[a]);var h=k.find(".groupFilter_label").clone();var c=$("<td></td>");f.append(c);c.append(h);var d=$("<td></td>");f.append(d);var b=k.find(".groupFilter_element").clone();d.append(b)}return j};var groupFilterContainerClone;GroupFilter.resizeToTable=function(b,f,d){var c=groupFilterContainerClone.find("div.groupFilter_item");for(var g=f;g>0;g=g-2){var e=GroupFilter.getTable(g,c);b.html(e);var a=e.width();if(a<d){return e}}return null};var FilterForm;if(!FilterForm){FilterForm=function(){}}FilterForm.hide={};FilterForm.Toggle=function(d,c,f){var d=$(d);var g;var f=d.attr("mode");if(f=="hide"){d.attr("mode","show");g=true;d.parent().find(".filter-a").removeClass("filterClicked")}else{d.attr("mode","hide");g=false;d.parent().find(".filter-a").addClass("filterClicked")}d.toggleClass("filterClicked");$("#"+c+"filterButtons").slideToggle("fast",function(){Durados.GridHandler.adjustDataTableHeight(c)});$("#"+c+"ajaxDiv [name=rowfilter]").first().slideToggle("fast",function(){Durados.GridHandler.adjustDataTableHeight(c)});FilterForm.hide[c]=g;var e=views[c].ViewName;var a=views[c].Controller;var b=rootPath+a+"/ChangeFilterVisibilty/"+e;$.post(b,{filterVisibilty:f=="show"})};FilterForm.HandleGridLoad=function(b){if(FilterForm.hide[b]==null){return}var a=$("#"+b+"filterButton");if(!a.length){return}var c=a.hasClass("filterClicked");if(FilterForm.hide[b]===false){if(!c){a.click()}}else{if(c){a.click()}}};FilterForm.ApplySearch=function(a,c,b,e){var d=$(b).siblings("input.search_text").val();if(!d||d==e){return}FilterForm.Apply(a,c,b)};FilterForm.ApplyClear=function(a,c,b){var d=$(b).siblings("input.search_text");d.val("");FilterForm.Apply(a,c,b)};FilterForm.Init=function(a){};FilterForm.Apply=function(d,h,j){var k="";if(queryString("public")=="true"||queryString("public")=="true#"){var g=views[h].gFilterUrl.indexOf("?")>-1?"&":"?";k=g+"public=true"}Durados.BeforeUnload(h);showProgress();var m="";var a;var f;if(views[h].ViewName=="durados_v_ChangeHistory"&&currentHistoryJson!=null){a=currentHistoryJson;f=FloatingDialog.TheDialog}else{a=GetJsonFilter(h);f=null}if(j==null){if(!d){a=FillJson(a,"filter_",h,f,false,true)}else{a=ClearJson(a,views[h].ViewName)}}else{m=$(j).siblings("input.search_text").val();a=FillJsonForSearch(GetJsonFilter(h),"filter_",h,m)}if(views[h].DisplayType!="Table"){FillJson(a,createPrefix,h)}saveElementScrollsPosition(h);var b=Multi.GetSelection(h);var e=$("#tree_filter_"+h).length!=0;var l=h==getMainPageGuid()?"no":"yes";$.post(views[h].gFilterUrl+k,{jsonFilter:Sys.Serialization.JavaScriptSerializer.serialize(a),guid:h,search:m,mainPage:views[h].mainPage,loadTreeFilter:e,subGrid2:l},function(o){hideProgress();var c=o.indexOf("$$error$$",0);if(c<0||c>1000){FilterForm.HandleSuccess(o,d,h,b,e)}else{ajaxNotSuccessMsg(o,h)}})};FilterForm.HandleSuccess=function(g,b,e,d,h){if(h){var f=$(g);var a=f.find("#DataTableView").html();var c=f.find("#TreeFilter").html();$("#"+e+"ajaxDiv").html(a);$("#tree_filter_"+e).html(c)}else{$("#"+e+"ajaxDiv").html(g)}success(e);resetElementScrollsPosition(e);Multi.SelectByPKs(e,d)};var prevSortedColumn="";var prevSortedDirection="";FilterForm.Sort=function(k,e){var h="";if(queryString("public")=="true"||queryString("public")=="true#"){var j=views[e].gIndexUrl.indexOf("?")>-1?"&":"?";h=j+"public=true"}if(LoadingApplicationData||movedColumnInfo[e]){return}Durados.BeforeUnload(e);showProgress();var f,g;var b=$("#"+k);f=b.attr("SortColumn");g=f==prevSortedColumn&&prevSortedDirection=="Asc"?"Desc":"Asc";saveElementScrollsPosition(e);var d=Multi.GetSelection(e);$.post(views[e].gIndexUrl+h,{SortColumn:f,direction:g,guid:e},function(c){hideProgress();var a=c.indexOf("$$error$$",0);if(a<0||a>1000){FilterForm.HandleSuccess(c,false,e,d);prevSortedColumn=f;prevSortedDirection=g}else{ajaxNotSuccessMsg(c,e)}})};var CreateDialog;if(!CreateDialog){CreateDialog=function(){}}CreateDialog.CreateAndOpen=function(p,d,b,m,x,a,q,c){var t=null;if(a){if(b=="Autocomplete"){var j=$("#"+m);t=GetAutoCompleteValueId(j)}else{if(b=="DropDown"){var e=$("#"+m+" option:selected");t=e.val()}}if(t==null||t==""){ajaxNotSuccessMsg("Please select a value.");return}}showProgress();var g=CreateDialog.Create(p,q,x.replace("Create/","Dialog/"));var k;var w=q+p+"inlineAdding";k=$("#"+w);if(k.length==0){k=$("<div>");k.attr("id",w);$("body").prepend(k)}k.html(g);if((q&&q!="null")||p=="Menu"){var l=views[q].TabCache=="True";var u=k.find("#"+q+"InlineAddingTabs");u.tabs({fx:{opacity:"toggle",duration:"fast"},cache:l,ajaxOptions:{cache:false,async:false}});disableChildrenTabs(u)}CreateDialog.Open(p,d,b,m,x,q,t,a,k,c);if(jsonViewsForInlineDialog[q]&&jsonViewsForInlineDialog[q].Fields){Durados.Dependencies.cleanUp();for(var r=0;r<jsonViewsForInlineDialog[q].Fields.length;r++){if(jsonViewsForInlineDialog[q].Fields[r].Value.DependencyData){var o=jsonViewsForInlineDialog[q].Fields[r].Key;var s=$("#"+q+inlineAddingPrefix+ReplaceNonAlphaNumeric(o));var h=s.val();Durados.Dependencies.Apply(o,h,q,k,jsonViewsForInlineDialog[q].Fields);Durados.Dependencies.createHandlers($("#"+q+inlineAddingPrefix+ReplaceNonAlphaNumeric(jsonViewsForInlineDialog[q].Fields[r].Key)),q,jsonViewsForInlineDialog[q].Fields,p,inlineAddingPrefix)}}}CreateDialog.CreateWysiwyg(q,p);complete(q);initDropdownChecklistsCreate(q);$(Durados.View).trigger("add",{pk:t,guid:q,dialog:k,viewName:p,prefix:inlineAddingPrefix,originElementId:m});return k};CreateDialog.Create=function(e,b,d){var c="";var a="";if(!b||b=="null"){if(!d){d="/Home/InlineAddingDialog/"}a=d+e}else{a=views[b].gInlineAddingDialogUrl+e}$.ajax({url:a,contentType:"application/json; charset=utf-8",data:{viewName:e,guid:b},async:false,cache:false,error:ajaxErrorsHandler,success:function(g){hideProgress();var f=g.indexOf("$$error$$",0);if(f<0||f>1000){c=g}else{ajaxNotSuccessMsg(g)}}});return c};CreateDialog.Open=function(o,p,k,b,j,l,f,g,h,q){var c=$(window).width();var e=$(window).height();currentViewName=o;var d=Rectangle.Load(currentViewName);if(d!=null){h.dialog({bgiframe:true,autoOpen:false,position:[d.left,d.top],width:d.width,height:d.height,modal:true,close:CreateDialog.CloseEvent,resizeStop:SaveDialogOnResize,zIndex:999999,dragStop:SaveDialogOnDrag,close:function(s,t){Durados.Tabs.select($("#"+l+"InlineAddingTabs"),0)},open:function(s,u){var t=$.cookie("state_"+o);if(t=="max"||IE7){dialogExt.max(h,null,l)}currentDialog=h;window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1)}})}else{h.dialog({bgiframe:true,autoOpen:false,position:"center",width:(c*0.75),modal:true,close:CreateDialog.CloseEvent,position:"center",resizeStop:SaveDialogOnResize,zIndex:999999,dragStop:SaveDialogOnDrag,close:function(t,u){if($("#"+l+"InlineAddingTabs").length>0){try{Durados.Tabs.select($("#"+l+"InlineAddingTabs"),0)}catch(s){}}},open:function(s,u){var t=$.cookie("state_"+o);if(t=="max"||IE7){dialogExt.max(h,null,l)}currentDialog=h;window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1)}})}h.dialog("option","title","Add "+p);h.dialog("option","buttons",{"Save and Close":function(){CreateDialog.Add(o,false,k,b,j,l,h,q)},Close:function(){CreateDialog.Close(h,l)}});dialogExt.initMaxButton(h,l);showProgress();var r=null;if(g){r=GetJsonViewForInlineEditing(o,l,f);if(r==null){ajaxNotSuccessMsg("The record that you request to edit has been deleted.",l);return}EditDialog.Load(f,inlineAddingPrefix,l,r,o+"inlineAdding")}else{r=GetJsonViewForInlineAdding(o,l,j.replace("InlineAddingCreate/","GetJsonView/"));AddDialog.SetDefaults(r,inlineAddingPrefix,l)}var a=$.cookie("state_"+o);if(a!="max"){if(d!=null){h.dialog("option","position",[d.left,d.top])}}jsonViewsForInlineDialog[l]=r;InitValidation(l,inlineAddingPrefix,r);subgridsHashes[l]=new Array();initDerivation(r.Derivation,h,inlineAddingPrefix,l,r.ViewName);initDerivationOnShow(r.Derivation,h,inlineAddingPrefix,l,r.ViewName);h.dialog({show:{effect:"fold",duration:500},hide:{effect:"fold",duration:500}});h.dialog("open");CreateDialog.CreateWysiwyg(l,o);hideProgress();setFocusInDialog(h);if(o=="Field"){var m=h.find('[name="DataType"]');h.find("[name=RelatedViewName]").parents("tr:first").parents("tr:first").hide();if(m.length==1){m.change(function(){setDataType(h,m)})}}};var dataTypeDiv=null;function setDataType(b,a){if(a.val()=="MultiSelect"){b.find("[name=RelatedViewName]").parents("tr:first").parents("tr:first").show()}else{b.find("[name=RelatedViewName]").parents("tr:first").parents("tr:first").hide()}if(a.val()=="SingleSelect"){var c=a.parents("table:first").parents("table:first");if(c.find("tr.data-type-settings-row").length==0){dataTypeDiv=$('<div class="relation-settings"></div>').load("/Admin/GetDataTypeDialog",function(){var h=a.parents("tr:first").parents("tr:first");var k=$('<tr class="data-type-settings-row"></tr>');k.insertAfter(h);var g=$('<td colspan="2"></td>');k.append(g);g.append(dataTypeDiv);var l=b.find("[name=Database]");var e=b.find("[name=RelatedViewName]");var m=e.val();var d=b.find(".existing-tables");var j=b.find(".existing-system-tables");d.val(m);j.val(m);l.change(function(){var o=$(this).val();if(o=="1"){d.show();j.hide()}else{d.hide();j.show()}});var f=b.find("[name=RelatedTable]");f.change(function(){var o=$(this).val();if(o=="1"){b.find(".ExistingRelatedTableName").css("display","block");b.find(".NewRelatedTableName").hide()}else{b.find(".ExistingRelatedTableName").hide();b.find(".NewRelatedTableName").css("display","block")}});if(j.val()){b.find(".InSystemDatabase").prop("checked",true);b.find(".InSystemDatabase").change()}else{b.find(".InYourDatabase").prop("checked",true);b.find(".InYourDatabase").change()}b.find(".ExistingRelatedTable").prop("checked",true);b.find(".ExistingRelatedTable").change()})}dataTypeDiv.show()}else{if(dataTypeDiv){dataTypeDiv.hide()}}}function isCreatingNewTableInYourDb(a){var b=a.find(".InYourDatabase").prop("checked");var c=a.find(".ExistingRelatedTable").prop("checked");return b&&!c}function isValidDataType(f,c){if(c.val()!="SingleSelect"){return true}var g=f.find(".InYourDatabase").prop("checked");var h=f.find(".ExistingRelatedTable").prop("checked");var a=f.find(".existing-tables");var e=f.find(".existing-system-tables");var d=f.find(".new-related-table-name");if(g){if(h){var b=a.val();if(!b){Durados.Dialogs.Alert("","Please select existing table or view.",function(){a.focus()});return false}else{f.find("[name=RelatedViewName]").val(b)}}else{var b=d.val();f.find("[name=RelatedViewName]").val(b)}}else{if(h){var b=e.val();if(!b){Durados.Dialogs.Alert("","Please select existing table or view.",function(){e.focus()});return false}else{f.find("[name=RelatedViewName]").val(b)}}else{var b=d.val();f.find("[name=RelatedViewName]").val(b)}}return true}CreateDialog.CreateWysiwyg=function(a,b){$("#"+a+"InlineAdding"+ReplaceNonAlphaNumeric(b)+'DataRowForm textarea[rich="true"]').each(function(){$(this).htmlarea("dispose")});$("#"+a+"InlineAdding"+ReplaceNonAlphaNumeric(b)+'DataRowForm textarea[rich="true"]').htmlarea()};CreateDialog.Reset=function(a){$("#"+guid+"InlineAdding"+ReplaceNonAlphaNumeric(a)+"DataRowForm")[0].reset();resetUpload()};CreateDialog.Close=function(b,a){b.dialog("close")};CreateDialog.CloseEvent=function(){};CreateDialog.Add=function(h,l,d,a,b,e,c,j){if(CreateDialog.isValid(e,h)==false){modalSuccessMsg(getErrorsList(c));return}if(h=="Field"){var g=c.find('[name="DataType"]');if(g.length==1){if(!isValidDataType(c,g)){blockOperation=false;hideProgress();return}if(isCreatingNewTableInYourDb(c)&&!confirm("The following change is going to create new table, continue?")){blockOperation=false;hideProgress();return}}}var k=FillJson(GetJsonViewForInlineAdding(h,e,b.replace("InlineAddingCreate/","GetJsonView/")),inlineAddingPrefix,e,c);if(h=="Field"&&c.find(".InSystemDatabase").prop("checked")){var f=jQuery.extend(true,{},k.Fields[0]);f.Key="sysdb";f.Value.Value=true;f.Value.Name="sysdb";k.Fields.push(f)}showProgress();$.post(b+h,{jsonView:Sys.Serialization.JavaScriptSerializer.serialize(k)},function(m){hideProgress();var o=m.indexOf("$$error$$",0);if(o<0||o>1000){if(m!=""){var p=Sys.Serialization.JavaScriptSerializer.deserialize(m);CreateDialog.HandleSuccess(l,d,a,p,e,c,h)}else{if(j){j(l,d,a,p,e,c,h)}InlineEditingDialog.Close(c,e,false,true)}}else{ajaxNotSuccessMsg(m.replace("$$error$$",""),e,h=="Field")}})};CreateDialog.onafterInlineAdding=function(){};CreateDialog.HandleSuccess=function(r,e,b,c,f,d,m){if(e=="DropDown"){var k=c.Fields[0].Value;var l=k.Value;var q=k.Default;var j=b.replace(createPrefix,editPrefix);var p=b.replace(editPrefix,createPrefix);var a=$("#"+p);a.append('<option value="'+l+'">'+q+"</option>");if(j!=p){var o=$("#"+j);o.append('<option value="'+l+'">'+q+"</option>")}var h=$("#"+b);$(CreateDialog).trigger("onafterInlineAdding",{element:h,displayValue:c,id:b,type:e,guid:f,dialog:d,viewName:m})}if(r){CreateDialog.Reset(m)}else{CreateDialog.Close(d,f)}if(e=="DropDown"){var h=$("#"+b);h.val(l);h.change();h.focus()}else{if(e=="Autocomplete"){var k=c.Fields[0].Value;var l=k.Value;var q=k.Default;var g=$("#"+b);g.val(q);g.attr("valueId",l);g.focus()}}};CreateDialog.isValid=function(a,c){var b=$("#"+a+"InlineAdding"+ReplaceNonAlphaNumeric(c)+"DataRowForm")[0];if(Spry.Widget.Form.validate(b)==false){return false}return true};var InlineEditingDialog;if(!InlineEditingDialog){InlineEditingDialog=function(){}}InlineEditingDialog.CreateAndOpen=function(l,m,h,a,c,j,g){var f=null;if(h=="Autocomplete"){var k=$("#"+a);f=GetAutoCompleteValueId(k)}else{if(h=="DropDown"){var d=$("#"+a+" option:selected");f=d.val()}else{if(h=="tableView"){var b=$(a).parent("TD.d_fieldContainer").attr("d_role")=="cell";if(b&&!g.ctrlKey){return}f=$(a).attr("pk")}}}if(f==null||f==""){ajaxNotSuccessMsg("Please select a value.");return}InlineEditingDialog.CreateAndOpen2(l,m,h,a,c,j,g,f)};InlineEditingDialog.CreateAndOpen2=function(x,m,f,w,j,y,B,C,v,h,u,o,k){showProgress();var q=InlineEditingDialog.Create(x,y,C);var s;s=$("#"+y+ReplaceNonAlphaNumeric(x)+"inlineEditing");if(s.length==0){s=$("<div>");s.attr("id",y+ReplaceNonAlphaNumeric(x)+"inlineEditing");$("body").prepend(s)}s.html(q);var t=false;if(y){t=views[y].TabCache=="True"}var p=false;if(y){var r=s.find("#"+y+"InlineEditingAccordion");if(r.length>0){r.accordion({collapsible:true,autoHeight:false,changestart:function(e,E){accordionChanged(E,y,C)}});p=true}}if((!p&&y)||x=="Menu"){var d=s.find("#"+y+"InlineEditingTabs");d.tabs({fx:{opacity:"toggle",duration:"fast"},cache:t,ajaxOptions:{cache:false,async:false}});disableChildrenTabs(d)}var D=s.find(".slider-container");slider.InitSlider(null);var z=GetJsonViewForInlineEditing(x,y,C);if(z==null){ajaxNotSuccessMsg("The record that you request to edit has been deleted.",y);return s}if(x=="View"||x=="Field"||(x=="Page"&&y==pageGuid)){PreviewDisplayModeViewJson=z}EditDialog.Load(C,inlineEditingPrefix,y,z,x+"inlineEditing");if((!p&&y)||x=="Menu"){AddDialog.HandleTab(C,"InlineEditingTabs",y);var c=$("#"+y+"InlineEditingTabs");Durados.Tabs.select(c,0);c.bind("tabsshow",function(e,E){tabLoaded(E)})}InlineEditingDialog.Open(x,m,f,w,j,y,s,C,h,u,o,k);if(!y&&x!="Menu"){try{InitValidation(y,inlineEditingPrefix,z)}catch(g){}try{var a="null";subgridsHashes[a]=new Array();initDerivation(z.Derivation,s,inlineEditingPrefix,a,z.ViewName);initDerivationOnShow(z.Derivation,s,inlineEditingPrefix,a,z.ViewName)}catch(g){}return s}InitValidation(y,inlineEditingPrefix,z);subgridsHashes[y]=new Array();initDerivation(z.Derivation,s,inlineEditingPrefix,y,z.ViewName);initDerivationOnShow(z.Derivation,s,inlineEditingPrefix,y,z.ViewName);EditDialog.DisableCloneView(inlineEditingPrefix,y,z,v);for(var l=0,A=z.Fields.length;l<A;++l){var b=z.Fields[l].Value;if(b.DependencyData){Durados.Dependencies.Apply(b.Name,b.Value,y,s,z.Fields)}}InlineEditingDialog.CreateWysiwyg(y,x);$(Durados.View).trigger("edit",{pk:C,guid:y,dialog:s,viewName:x,prefix:inlineEditingPrefix,originElementId:w});complete(y);initDropdownChecklistsEdit(y);return s};var InlineEditingViews=[];InlineEditingDialog.Create=function(e,b,d){if(InlineEditingViews[e]&&!(b==pageGuid&&e=="Page")){return InlineEditingViews[e]}var c="";var a=b?views[b].gInlineEditingDialogUrl+e:"/Home/InlineEditingDialog/"+e;if(e=="View"||e=="Field"||(e=="Page"&&b==pageGuid)){a=a+"?Pk="+d}var f=999999;if(b==pageGuid){f=10}$.ajax({url:a,contentType:"application/json; charset=utf-8",data:{viewName:e,guid:b},async:false,cache:false,error:ajaxErrorsHandler,zIndex:f,success:function(h){hideProgress();var g=h.indexOf("$$error$$",0);if(g<0||g>1000){c=h}else{ajaxNotSuccessMsg(h)}}});InlineEditingViews[e]=c;return c};InlineEditingDialog.Open=function(p,g,b,o,e,q,s,u,d,l,j,f){var k=$(window).width();var a=$(window).height();currentViewName=p;var m=function(x){var v=q!=pageGuid;var w=InlineEditingDialog.Close(s,q,v,x);if(w){if(p=="Field"||p=="View"){InlineEditingDialog.resetConfig(q)}}return w};var h=Rectangle.Load(currentViewName);if(q==pageGuid){if(!h){h=new Object()}h.left=250;h.top=110}var t=true;if(q==pageGuid){t=false}if(h!=null){s.dialog({bgiframe:true,autoOpen:false,position:[h.left,h.top],width:h.width,height:h.height,modal:t,close:InlineEditingDialog.CloseEvent,resizeStop:SaveDialogOnResize,zIndex:999999,dragStop:SaveDialogOnDrag,beforeClose:function(v,w){return m(false)},close:function(v,w){Durados.Tabs.select($("#"+q+"InlineEditingTabs"),0);if(f){f(v,w)}},open:function(v,x){var w=$.cookie("state_"+p);if(w=="max"||IE7){dialogExt.max(s,null,q)}currentDialog=s;window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1);if(q==pageGuid){s.dialog("widget").find(".ui-dialog-titlebar").hide();s.dialog("widget").css("border","none");s.dialog("widget").css("border-left","1px #ccc solid")}if(u==""){s.find("form").hide();s.find(".page-settings .page-button-container").hide()}else{s.find("form").show();s.find(".page-settings .page-button-container").show()}}})}else{s.dialog({bgiframe:true,autoOpen:false,width:(k*0.75),modal:t,close:InlineEditingDialog.CloseEvent,position:"center",resizeStop:SaveDialogOnResize,zIndex:999999,dragStop:SaveDialogOnDrag,beforeClose:function(v,w){return m(false)},close:function(v,w){Durados.Tabs.select($("#"+q+"InlineEditingTabs"),0)},open:function(v,x){var w=$.cookie("state_"+p);if(w=="max"||IE7){dialogExt.max(s,null,q)}currentDialog=s;window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1)}})}if(q!=pageGuid){dialogExt.initMaxButton(s,q);dialogExt.iniDockButton(s,q)}if(g.indexOf(translator.Settings)>-1){s.dialog("option","title",g)}else{s.dialog("option","title","Edit "+g)}if(q!=pageGuid){s.dialog("option","buttons",{"Save and Close":function(){InlineEditingDialog.Edit(p,b,o,e,q,s,u,d,l)},Close:{text:"Close",click:function(){m(true)}}})}showProgress();var c=$.cookie("state_"+p);if(c!="max"){if(h!=null){s.dialog("option","position",[h.left,h.top])}}s.dialog({show:{effect:"fold",duration:500},hide:{effect:"fold",duration:500}});s.dialog("open");InlineEditingDialog.CreateWysiwyg(q,p);hideProgress();Durados.Dialogs.BindToChangeEvent("input",s);Durados.Dialogs.BindToChangeEvent("select",s);Durados.Dialogs.BindToChangeEvent("textarea",s);if(p=="Field"){var r=s.find('[name="DataType"]');s.find("[name=RelatedViewName]").parents("tr:first").parents("tr:first").hide();if(r.length==1){r.change(function(){setDataType(s,r)});if(r.val()=="SingleSelect"){setDataType(s,r)}}}setFocusInDialog(s);if(p=="Field"||p=="View"||p=="Page"){InlineEditingDialog.SetAdminPreviewEvents(s,p,q,j)}};InlineEditingDialog.resetConfig=function(a){PreviewDisplayModeViewJson=null;$.post("/Home/PreviewModeOff/",{},function(b){if(b!="success"){return}if(isViewItem(a)){window.parent.Refresh(window.parent.getMainPageGuid(),true)}else{Refresh(a)}})};var customThemeChanged=false;InlineEditingDialog.SetAdminPreviewEvents=function(g,f,j,d){var c=new Durados.FieldEditor();var h=$(g).attr("pk");g.find('[adminPreview="true"]').each(function(){var o=$(this);var m=o.attr("name");var l="/Admin/PreviewEdit/"+f;var k=c.getElementType(o);if(k=="Text"||k=="Autocomplete"){o.bind("change",{elementType:"Text",pk:h,name:m,guid:j,url:l,dialog:g,viewName:f,element:o,previewCallback:d},InlineEditingDialog.SetUpdatePreview)}else{if(k=="Check"||k=="Color"){o.bind("change",{elementType:k,pk:h,name:m,guid:j,url:l,dialog:g,viewName:f,element:o,previewCallback:d},InlineEditingDialog.SetUpdatePreview)}else{if(k=="DropDown"||k=="Hidden"){o.bind("change",{elementType:"DropDown",pk:h,name:m,guid:j,url:l,dialog:g,viewName:f,element:o,previewCallback:d},InlineEditingDialog.SetUpdatePreview)}}}});g.find('textarea[adminPreview="true"]').each(function(){var p=$(this);var o=p.attr("id").substr(0,(p.attr("id").indexOf("inlineEditing_")));var m=p.attr("name");var l="/Admin/PreviewEdit/"+f;var k=c.getElementType(p);if(k=="TextArea"){p.bind("change",{elementType:"DropDown",pk:h,name:m,guid:o,url:l,dialog:g,viewName:f,previewCallback:d},InlineEditingDialog.SetUpdatePreview)}});g.find('input[name="ApplyColorDesignToAllViews"]').each(function(){var k=$(this);k.bind("change",{elm:k},function(){if(Durados.CheckBox.IsChecked(k)){Durados.Dialogs.Confirm(translator.ApplyColorDesignTitle,translator.ApplyColorDesignMessage,function(){Durados.CheckBox.SetChecked(k,true)},function(){Durados.CheckBox.SetChecked(k,false)})}})});g.find('input[name="ApplySkinToAllViews"]').each(function(){var k=$(this);k.bind("change",{elm:k},function(){if(Durados.CheckBox.IsChecked(k)){Durados.Dialogs.Confirm(translator.ApplySkinTitle,translator.ApplySkinMessage,function(){Durados.CheckBox.SetChecked(k,true)},function(){Durados.CheckBox.SetChecked(k,false)})}})});var b=g.find('input[name="Theme"]');var e=g.find('input[name="CustomThemePath"]');var a=function(){var k=b.val();e.attr("disabled",k!="Custom")};a();customThemeChanged=false;b.change(function(){customThemeChanged=true;a()})};PreviewDisplayModeViewJson=null;InlineEditingDialog.SetUpdatePreview=function(h){var k=h.data.guid;var j=PreviewDisplayModeViewJson;var l=h.data.viewName;var o=h.data.name;var c=h.data.element;var m=c.val();var a=views[k]==null?false:views[k].Role=="View Owner";var g=h.data.pk;if(l=="Field"&&o=="DataType"&&a){var b=null;for(var f=0,d=j.Fields.length;f<d;++f){if(j.Fields[f].Key==o){b=j.Fields[f].Value.Value;break}}$.ajax({url:"/Admin/HasData",contentType:"application/json; charset=utf-8",data:{fieldId:g},async:false,cache:false,error:ajaxErrorsHandler,success:function(e){if(e){Durados.Dialogs.Confirm(translator.ChangeTypeTitle,translator.ChangeTypeMessage,function(){InlineEditingDialog.SetUpdatePreview2(h)},function(){c.val(b)})}else{InlineEditingDialog.SetUpdatePreview2(h)}}});return false}else{if(confirmChangeType){Durados.Dialogs.Confirm(translator.ChangeTypeTitle,"This change will affect the database schema.<br/>The change can not be rolled back.<br/>A database backup is recommended.",function(){InlineEditingDialog.SetUpdatePreview2(h)},function(){c.val(confirmChangeTypePrevVal)})}else{InlineEditingDialog.SetUpdatePreview2(h)}}};InlineEditingDialog.SetUpdatePreview2=function(a){showProgress();setTimeout(function(){$(InlineEditingDialog).trigger("beforeUpdatePreview",{guid:a.guid,dialog:a.dialog,pk:a.pk,viewName:a.viewName});var g=null;if(a.data==null||a.data.elementType==null){hideProgress();return}switch(a.data.elementType){case"Check":g=$(getEventSrcElement(a)).is(":checked");break;case"Text":g=$(getEventSrcElement(a)).val();break;case"Color":var f=$(getEventSrcElement(a));var e=f.siblings("input[type=checkbox]");var j=Durados.CheckBox.IsChecked(e);g=j?f.val():"";break;case"DropDown":g=$(getEventSrcElement(a)).val();break}if(PreviewDisplayModeViewJson==null){hideProgress();return}var h=PreviewDisplayModeViewJson;for(var d=0,b=h.Fields.length;d<b;++d){if(h.Fields[d].Key==a.data.name){if(h.Fields[d].Value.Value!=g){h.Fields[d].Value.Value=g;var c=a.data.guid;if(window.parent&&window.parent.Refresh&&window.location.href.indexOf("Admin/Item/View?")>-1){c=window.parent.getMainPageGuid()}InlineEditingDialog.UpdatePreview(a,a.data.pk,a.data.name,g,c,a.data.url,a.data.viewName,a.data.dialog,a.data.previewCallback);if(plugIn()){break}if(window.parent&&window.parent.Refresh&&window.location.href.indexOf("Admin/Item/View?")>-1){window.parent.Refresh(window.parent.getMainPageGuid(),true)}else{if(window.parent&&window.parent.parent&&window.parent.parent.Refresh&&window.location.href.indexOf("Admin/IndexPage/Field?")>-1){window.parent.parent.Refresh(window.parent.parent.getMainPageGuid(),true)}}break}}}},1);hideProgress()};function getEventSrcElement(b){var a;if(!b){var b=window.event}if(b.target){a=b.target}else{if(b.srcElement){a=b.srcElement}}if(a.nodeType==3){a=a.parentNode}return a}InlineEditingDialog.UpdatePreview=function(f,h,a,l,j,b,k,g,d){try{if(k=="Field"&&(plugIn()||a=="DataType"||a=="Excluded"||a=="DisplayFormat")){g.parent().find("button.ui-button").each(function(){if($(this).text()==translator.save){if(!(l==false&&a=="Excluded")){$(this).click()}return}})}}catch(c){}try{if(k=="View"&&parent&&parent.refreshWidget2){g.parent().find("button.ui-button").each(function(){if($(this).text()==translator.save){$(this).click();return}})}}catch(c){}if(!plugIn()&&a!="DataType"&&a!="Excluded"){$.post(b,{pk:h,property:a,value:l,guid:j},function(e){if(e!="success"){return}adminPreviewChanged=true;if(f&&isViewItem(f.data.guid)){var m=window.parent.getMainPageGuid();if(a=="Skin"){window.parent.InlineEditingDialog.HandleSkin(l,m)}else{if(a=="DisplayName"&&k=="View"){window.parent.InlineEditingDialog.HandleViewDisplayName(l)}}window.parent.Refresh(m,true)}else{if(a=="DisplayName"){var o=$(".boardselected");o.text(l)}}if(d){d(h,a,l,j,b,k,g)}})}};var adminPreviewChanged=false;InlineEditingDialog.HandleViewDisplayName=function(a){$("#rowtabletitleSpan:first").text(a)};var loadCSS=function(b,d){var c=document.createElement("link");c.type="text/css";c.rel="stylesheet";c.href=b;document.getElementsByTagName("head")[0].appendChild(c);var a=document.createElement("img");a.onerror=function(){if(d){d(c)}};a.src=b};InlineEditingDialog.HandleSkin=function(e,c){var d=$('link[role="skin"]');var b=d.attr("href");b=b.substring(0,b.lastIndexOf("/")+1)+e+".css";d.attr("href",b);var a=document.createElement("img");a.onerror=function(){Durados.GridHandler.setColumnsWidth(c)};a.src=b};InlineEditingDialog.CreateWysiwyg=function(a,b){$("#"+a+"InlineEditing"+ReplaceNonAlphaNumeric(b)+'DataRowForm textarea[rich="true"]').each(function(){$(this).htmlarea("dispose")});$("#"+a+"InlineEditing"+ReplaceNonAlphaNumeric(b)+'DataRowForm textarea[rich="true"]').htmlarea()};InlineEditingDialog.Reset=function(a){$("#"+guid+"InlineEditing"+ReplaceNonAlphaNumeric(a)+"DataRowForm")[0].reset();resetUpload()};InlineEditingDialog.Close=function(d,c,a,f){var b=true;if(a){var e=d.attr("changed")=="yes";if(e){if(confirm("Exit without save?")){d.attr("changed","no")}else{b=false}}else{d.attr("changed","no")}}if(b&&f){d.dialog("close")}return b};InlineEditingDialog.CloseEvent=function(){};InlineEditingDialog.Edit=function(m,g,b,c,h,f,e,o,q){if(InlineEditingDialog.isValid(h,m)==false){modalSuccessMsg(getErrorsList(f));return}showProgress();if(b!=null){if(g=="Autocomplete"){var l=$("#"+b);e=GetAutoCompleteValueId(l)}else{if(g=="DropDown"){var d=$("#"+b+" option:selected");e=d.val()}else{if(g=="tableView"){e=$(b).attr("pk")}}}}var a=c+m;if(m=="View"||m=="Field"||m=="Page"){a=a+"?Pk="+e}if(m=="Field"){var k=f.find('[name="DataType"]');if(k.length==1){if(!isValidDataType(f,k)){blockOperation=false;hideProgress();return}if(isCreatingNewTableInYourDb(f)&&!confirm("The following change is going to create new table, continue?")){blockOperation=false;hideProgress();return}}}var p=FillJson(GetJsonViewForInlineEditing(m,h,e),inlineEditingPrefix,h,f);if(m=="Field"&&f.find(".InSystemDatabase").prop("checked")){var j=jQuery.extend(true,{},p.Fields[0]);j.Key="sysdb";j.Value.Value=true;j.Value.Name="sysdb";p.Fields.push(j)}$.post(a,{jsonView:Sys.Serialization.JavaScriptSerializer.serialize(p),pk:e,guid:h},function(r){hideProgress();var s=r.indexOf("$$error$$",0);if(s<0||s>1000){var t=Sys.Serialization.JavaScriptSerializer.deserialize(r);InlineEditingDialog.HandleSuccess(g,b,t,h,f,q);if(o){o(m,g,b,c,h,f,e)}}else{ajaxNotSuccessMsg(r.replace("$$error$$",""),h,m=="Field")}})};InlineEditingDialog.onafterInlineEditing=function(){};InlineEditingDialog.HandleSuccess=function(e,a,c,f,d,m){if(a!=null){if(e=="DropDown"){var j=$("#"+a);var h=c.Fields[0].Value;var k=h.Value;var l=h.Default;var b=$("#"+a+" option:selected");b.text(l);b.val(k);$(InlineEditingDialog).trigger("onafterInlineEditing",j)}}if(m==null||m){d.attr("changed","no");InlineEditingDialog.Close(d,f,false,true)}if(a!=null){if(e=="DropDown"){var j=$("#"+a);j.val(k);j.change()}else{if(e=="Autocomplete"){var h=c.Fields[0].Value;var k=h.Value;var l=h.Default;var g=$("#"+a);g.val(l);g.attr("valueId",k);g.focus()}else{if(e=="tableView"){var h=c.Fields[0].Value;var k=h.Value;var l=h.Default;$(a).attr("pk",k);$(a).text(l)}}}}};InlineEditingDialog.isValid=function(a,c){var b=$("#"+a+"InlineEditing"+ReplaceNonAlphaNumeric(c)+"DataRowForm")[0];if(Spry.Widget.Form.validate(b)==false){return false}return true};var Multi;if(!Multi){Multi=function(){}}Multi.Toggle=function(b,a){if(Durados.CheckBox.IsChecked($(b))){Multi.All(a)}else{Multi.Clear(a)}};Multi.All=function(a){$("#"+a+"ajaxDiv").find("input.Multi").each(function(){if($(this).parents("tr").first().attr("guid")==a){Durados.CheckBox.SetChecked($(this),"checked")}});Multi.MarkSelection(a)};Multi.Clear=function(a){$("#"+a+"ajaxDiv").find("input.Multi").each(function(){if($(this).parents("tr").first().attr("guid")==a){Durados.CheckBox.SetChecked($(this),false)}});Multi.MarkSelection(a);cellsSelection.clear();copyPaste=new Durados.CopyPaste(a)};Multi.GetSelection=function(b){var c=new Array();if(b==null||views[b]==null){return}var a=views[b].DataDisplayType;if(a=="Table"){$("#"+b+"ajaxDiv").find("input.Multi:checked").each(function(){if($(this).parents("tr").first().attr("guid")==b){var d=$(this).attr("pk");c.push(d)}})}else{$("#"+b+"ajaxDiv").find("div.boardtitle.boardselected[guid="+b+"]").each(function(){var d=$(this).attr("d_pk");c.push(d)})}return c};Multi.GetSingleSelection=function(b){var a=Multi.GetSelection(b);if(a.length==1){return a[0]}else{if(a.length>1){modalErrorMsg("Please select only one row")}else{modalErrorMsg("Please select a row")}}return null};Multi.GetNextPK=function(b,a){var c=Multi.GetElementByPK(a,b);return $(c).attr("nextPK")};Multi.GetPrevPK=function(b,a){var c=Multi.GetElementByPK(a,b);return $(c).attr("prevPK")};Multi.Init=function(a){$("#"+a+"ajaxDiv").find("input.Multi").each(function(){if($(this).parents("tr").first().attr("guid")==a){var b=$(this);b.change(function(d){var c=Durados.CheckBox.IsChecked(b);Multi.Select(a,views[a].MultiSelect,c,d.ctrlKey,b[0])})}})};Multi.Select=function(a,c,e,b,d){b=true;if(c&&b){}else{if(e){}else{Multi.Clear(a);Durados.CheckBox.SetChecked($(d),"checked")}}Multi.MarkSelection(a)};Multi.BoardAll=function(b,a){$("#"+b+"ajaxDiv div.boardtitle").each(function(){$board=$(this);if($board.attr("guid")==b){if(a){$board.addClass("boardselected");Durados.CheckBox.SetChecked($board.parent().find("input.Multi"),"checked")}else{$(this).removeClass("boardselected");Durados.CheckBox.SetChecked($(this).parent().find("input.Multi"),"")}}})};Multi.BoardClicked=function(f,d,c,b){var a=$(d);if(f!=null&&!f.ctrlKey||!views[c].MultiSelect){$("#"+c+"ajaxDiv div.boardselected").each(function(){if($(this).attr("d_pk")!=a.attr("d_pk")){$(this).removeClass("boardselected");Durados.CheckBox.SetChecked($(this).parent().find("input.Multi"),"")}})}Multi.toggleBoardSelection($(d),b)};Multi.toggleBoardSelection=function(b,a){if(b.hasClass("boardselected")){if(!a){b.removeClass("boardselected");Durados.CheckBox.SetChecked(b.parent().find("input.Multi"),"checked")}}else{b.addClass("boardselected");Durados.CheckBox.SetChecked(b.parent().find("input.Multi"),"checked")}};Multi.getFirstRowPK=function(a){var b=$("#"+a+"ajaxDiv").find("table.gridview:first");if(!b.length){return}return b.find('tr[guid="'+a+'"]:first').attr("d_pk")};Multi.MarkSelection=function(a){var b=$("#"+a+"ajaxDiv").find("table.gridview:first");if(!b.length){return}if(b.find(".hideCheckboxes").length!=0){return}var d=b.find('tr[guid="'+a+'"]');var f=0;var e=null;d.each(function(){var h=$(this);var c=$(this).attr("mode")=="board";if(c){$board=h.parents("div.boardrow").first().find("div.boardtitle").first()}var g=h.find("input.Multi:first");if(g.length==1){if(Durados.CheckBox.IsChecked(g)){if(!c){h.addClass("selected");h.removeClass("hovered")}else{$board.addClass("boardselected")}if(e==null){e=h}f++}else{if(!c){h.removeClass("selected")}else{$board.removeClass("boardselected")}}}});if(f!=1){e=null}Multi.UpdateGridTitle(e,b,a)};var displayValues=new Array();Multi.UpdateGridTitle=function(f,c,b){var d=c.parents("table.gridview").length==0;if(d){var e=$("#rowtabletitleSpan").attr("d_Dn");if(f){var a=f.attr("d_displayValue");if(a){displayValues[b]=a;e+=" - "+a}}else{displayValues[b]=e}if(e){$("#rowtabletitleSpan").next().text(a)}}};Multi.GetElementByPK=function(a,c){var b=$("#"+a+"ajaxDiv").find('input.Multi[pk="'+c+'"]').first();if(b.length==1){return b[0]}else{return null}};Multi.SelectByPK=function(a,c){var b=Multi.GetElementByPK(a,c);if(b!=null){Multi.Select(a,false,false,false,b)}};Multi.SelectByPKs=function(b,a){Multi.Clear(b);var c=[];if(a){$(a).each(function(){var d=Multi.GetElementByPK(b,this);if(d){c.push(d)}});$(c).each(function(){Durados.CheckBox.SetChecked($(this),"checked")});Multi.MarkSelection(b)}};function getCheckedQueryStringValue(a){if(Durados.CheckBox.IsChecked(a)){return"1"}else{return"0"}}function Print(a){window.print()}function rightTrim(a){while(a.substring(a.length-1,a.length)=="&"){a=a.substring(0,a.length-1)}return a}function success(a){complete(a);initDropdownchecklistFilters(a)}function initDropdownchecklistFilters(a){$("#"+a+"ajaxDiv").find("select.dropdownchecklist").each(function(){if($(this).attr("filter")=="filter"){initDropdownchecklistFilter($(this),a)}})}function begin(){showProgress()}var cellsSelection;var copyPaste;function initTooltip(b){var a=b.attr("title");if(a==""){return}if(a.indexOf("|")==-1){b.attr("title","|"+a)}b.cluetip({splitTitle:"|",clickThrough:true,cluetipClass:"jtip",arrows:true,dropShadow:false,hoverIntent:false,sticky:a.indexOf("href")!=-1,mouseOutClose:true,closePosition:"title",closeText:'<img src="/content/images/cross.png" alt="close" />'})}function initTooltips(){$("#rowtabletitleSpan").each(function(){initTooltip($(this))});Durados.Preview.init()}function triggerEditorBlur(){if(adjustDataTableHeightDisabled){return}Durados.FieldEditor.setFocus();$(document).click();Durados.FieldEditor.CloseAllEditors()}function complete(b){var a=$('.groupFilter[guid="'+b+'"]');if(a.length==1){groupFilterContainerClone=a.clone();GroupFilter.resize(a);$(window).resize(function(){GroupFilter.resize(a)})}if($("#"+b+"filterButton").length==0){a.hide()}Multi.Init(b);FilterForm.HandleGridLoad(b);adjustSubGridUI(b);Durados.GridHandler.adjustDataTable(b);if(Durados.CheckBox.IsChecked($("#"+b+"Safety"))&&!$("body").attr("unselectable")){$("body").attr("unselectable","on").addClass("unselectable")}$("input.date").each(function(){var f=num(DateFormats.getValidDateType($(this).attr("df")));var g=duradosGetJQueryDateFormat($(this).attr("df"),f);var e=g.dateFormat;switch(f){case DateFormats.dateType.dateOnly:$(this).datepicker({showButtonPanel:true,showOn:"button",buttonImage:rootPath+"Content/smoothness/images/calendar.jpg",beforeShow:datePickerBeforeShow,onChangeMonthYear:datePickerOnChangeMonthYear,buttonImageOnly:true,dateFormat:e,onSelect:function(j,h){if(h.input){setTimeout("triggerDateChanged('#"+$(h.input).attr("id")+"');",500)}}});break;case DateFormats.dateType.dateAndTime:$(this).datetimepicker({showButtonPanel:true,showOn:"button",buttonImage:rootPath+"Content/smoothness/images/calendar.jpg",beforeShow:datePickerBeforeShow,onChangeMonthYear:datePickerOnChangeMonthYear,buttonImageOnly:true,dateFormat:g.dateFormat,timeFormat:g.timeFormat,onSelect:function(j,h){if(h.input){setTimeout("triggerDateChanged('#"+$(h.input).attr("id")+"');",500)}}});break;case DateFormats.dateType.timeOnly:$(this).timepicker({showButtonPanel:true,showOn:"button",buttonImage:rootPath+"Content/smoothness/images/calendar.jpg",beforeShow:datePickerBeforeShow,onChangeMonthYear:datePickerOnChangeMonthYear,buttonImageOnly:true,timeFormat:g.timeFormat,onSelect:function(j,h){if(h.input){setTimeout("triggerDateChanged('#"+$(h.input).attr("id")+"');",500)}}});break;default:break}});Autocomplete.Init(b);hideProgress();$("#color_input").crayonbox({onSelection:function(){var e=$(this).find(".coloring").attr("title");if(!e){e="white"}$("#color_choozer").css("background-color",e);$(this).hide()},choozerId:"color_choozer",onShowClicked:function(){$(this).toggle()}});cellsSelection=new Durados.CellsSelection();copyPaste=new Durados.CopyPaste(b);if(Durados.ColumnResizer.initHandler!=null){Durados.ColumnResizer.init(b)}initTooltips();var d=Multi.GetSelection(b);if(d&&d.length>1){}else{Durados.DisplayType.InitByDisplayType(b)}try{FilterForm.Init(b);initMoreActions(b);initWatermark();initCheckboxes();initImages();initButtons();initEditors();initColorPickers()}catch(c){}Durados.GridHandler.setColumnsWidth(b);initTableDnd(b);$(Durados.View).trigger("refreshGrid",{guid:b})}savePositionTableDnd=function(e,b,d){if(d==null){return}var f=views[d].ViewName;var a=views[d].Controller;var c=rootPath+a+"/ChangeOrdinal/"+f;showProgress();$.post(c,{o_pk:e,d_pk:b,guid:d},function(){try{hideProgress()}catch(g){hideProgress()}})};function initTableDnd(b){var a=$("#"+b+"ajaxDiv");if(!a.length){return}var e=a.find("div.fixedViewPort").first();var d=e.find("table:first");if(!d.tableDnD){return}var c=null;d.tableDnD({onDrop:function(j,h){if(h){var l=h.rowIndex;if(c!=l){var k=c<l?"down":"up";var g=$(h).attr("d_pk");var f=k=="up"?$(h).next().attr("d_pk"):$(h).prev().attr("d_pk");savePositionTableDnd(g,f,b)}}},onDragStart:function(f,g){c=g.rowIndex},dragHandle:".dragHandle"});d.find("tr").each(function(){$(this).find("td:first").attr("style","padding-left: 24px !important;")});d.find("tr").hover(function(){$(this.cells[0]).addClass("showDragHandle")},function(){$(this.cells[0]).removeClass("showDragHandle")})}function triggerDateChanged(e,b){var d=$(e);if(!d.length){return}var c=num(DateFormats.getValidDateType(d.attr("dt")));var a=duradosGetJQueryDateFormat(d.attr("df"),c);if(d.val()==$.datepicker.formatDate(a.dateFormat,DuradosNADate)){d.addClass("nadate");if(b){$(b).addClass("nadateTD")}}else{d.removeClass("nadate");if(b){$(b).removeClass("nadateTD")}}}var LoadingApplicationData=false;var IE7=(navigator.appVersion.indexOf("MSIE 7.")==-1)?false:true;function getDocumentScope(c){try{c=c!=null?c:window;var a=c.document;if(c.parent&&((c.isDock&&c.isDock())||(c.location.pathname.indexOf("/IndexPage/")==-1))){a=getDocumentScope(c.parent)}}catch(b){return a}return a}function isDuringLoadIframe(){var b=false;try{b=Durados.DuringdLoadIframe||(isDockFields()&&window.parent.parent.$("#loadSettings").is(":visible"))}catch(a){}return b}function showProgress(){try{if(!isDuringLoadIframe()){LoadingApplicationData=true;if(plugIn()){$("body").css("cursor","wait");$("#pluginProgress",window.parent.document).show();$("#pluginProgress").show()}else{var a=getDocumentScope();$("body",a).css("cursor","wait");$("#progress",a).show()}}}catch(b){}}function hideProgress(){try{LoadingApplicationData=false;if(plugIn()){$("body").css("cursor","default");$("#pluginProgress",window.parent.document).hide();$("#pluginProgress").hide()}else{var a=getDocumentScope();$("body",a).css("cursor","default");var c=$("#progress",a);if(c.length==0){c=$("#progress")}c.hide()}}catch(b){}}function SetLanguage(a){var b=$("#languageDropDown").val();SetSelectedLanguage(b,a)}function SetSelectedLanguage(c,b){var a="";if(b&&views[b].gSetLanguageUrl){a=views[b].gSetLanguageUrl}else{a=top.location.href;$.ajax({url:"/Admin/SetLanguage2",contentType:"application/html; charset=utf-8",data:{languageCode:c},async:false,dataType:"html",cache:false,error:ajaxErrorsHandler,success:function(d){top.location.href=a}})}if(a.indexOf("?")>-1){a=a+"&languageCode="+c}else{a=a+"?languageCode="+c}top.location.href=a}function displayMenu(b,a){if(isDisplayed(b)){HideMenu(b,a)}else{ShowMenu(b,a)}}function isDisplayed(a){return $("#"+a).css("display")=="block"}function ShowMenu(b,a){$("#"+b).css("display","block");$("#"+a).attr("src",rootPath+"Content/Images/Minus.JPG")}function HideMenu(b,a){$("#"+b).css("display","none");$("#"+a).attr("src",rootPath+"Content/Images/Plus.JPG")}function ChangePageSize(c,a,d,b){begin();setTimeout(function(){ChangePageSize2(c,a,d,b)})}function ChangePageSize2(e,a,g,d){var f="";if(queryString("public")=="true"||queryString("public")=="true#"){var h=d.indexOf("?")>-1?"&":"?";f=h+"public=true"}d=d+f;var b=$(a).val();Durados.BeforeUnload(e);saveElementScrollsPosition(e);$.ajax({url:d,contentType:"application/html; charset=utf-8",data:{viewName:g,pageSize:b,guid:e},async:false,dataType:"html",cache:false,error:ajaxErrorsHandler,success:function(c){$("#"+e+"ajaxDiv").html(c);success(e)}})}function SafetyModeChanged(b){Durados.BeforeUnload(b);saveElementScrollsPosition(b);showProgress();var a=Durados.CheckBox.IsChecked($("#"+b+"Safety"));setTimeout(function(){$.ajax({url:views[b].gIndexUrl,contentType:"application/html; charset=utf-8",data:{viewName:views[b].gViewName,guid:b,mainPage:views[b].mainPage=="True",safety:a},async:false,dataType:"html",cache:false,error:ajaxErrorsHandler,success:function(c){$("#"+b+"ajaxDiv").html(c);success(b);resetElementScrollsPosition(b)}})},1)}function Refresh(d,e){if(!views[d]){return}var b=views[d].gIndexUrl;if(!b){return}var f="";if(queryString("public")=="true"||queryString("public")=="true#"){var h=b.indexOf("?")>-1?"&":"?";f=h+"public=true"}b=b+f;if(b=="durados_v_ChangeHistory"){FilterForm.Apply(false,d,null);return}Durados.BeforeUnload(d);saveElementScrollsPosition(d);var a=Multi.GetSelection(d);showProgress();var g="False";if(e){g="True"}setTimeout(function(){$.ajax({url:b,contentType:"application/html; charset=utf-8",data:{viewName:views[d].gViewName,guid:d,mainPage:views[d].mainPage=="True",firstTime:g},async:false,dataType:"html",cache:false,error:ajaxErrorsHandler,success:function(k){if(e){destroyDialogs(d);var j=$(k);if(j.length==0){return}var c=j.attr("guid");$("#mainAppDiv").bind("load",function(){alert("111")});$("tr").bind("load",function(){alert("111")});$("#mainAppDiv").html(k);initDataTableView(c)}else{$("#"+d+"ajaxDiv").html(k);success(d);resetElementScrollsPosition(d);Multi.SelectByPKs(d,a)}}})},1)}function destroyDialogs(a){$("#"+a+"DataRowEdit").dialog("destroy");$("#"+a+"DataRowCreate").dialog("destroy");$("#"+a+"DataRowEdit").remove();$("#"+a+"DataRowCreate").remove()}function MovePage(h,b,e,d,j,a){var k="";if(queryString("public")=="true"||queryString("public")=="true#"){var g=a.indexOf("?")>-1?"&":"?";k=g+"public=true"}a=a+k;var f=parseInt($(b).val());if(f>=1&&f<=d){$.ajax({url:a,data:{viewName:j,page:f,guid:h},async:false,cache:false,error:ajaxErrorsHandler,success:function(c){$("#"+h+"ajaxDiv").html(c);success(h)}})}else{$(b).val(e)}}function tabSelected(c,b,a){if(b=="edit"){EditDialog.RefreshFields(c,a)}$(EditDialog).trigger("tabSelected",{guid:a,ui:c,action:b})}function tabLoaded(c){var b=$(c.panel).find('div[ajaxDiv="ajaxDiv"]');if(b.length==0){return}if(b.attr("isLoaded")=="isLoaded"){return}var a=b.attr("guid");showProgress();initDataTableView(a);views[a].setTab($(c.tab));views[a].updateCounter();b.attr("isLoaded","isLoaded")}Durados.View.initDataTableView=function(){};function LoadView(a){var b=$("#"+a+"jsonViewForCreate").val();if(b!=null){b=Sys.Serialization.JavaScriptSerializer.deserialize(b)}var d=$("#"+a+"jsonViewForEdit").val();if(d!=null){d=Sys.Serialization.JavaScriptSerializer.deserialize(d)}var c=$("#"+a+"GetJsonFilter").val();if(c!=null){c=Sys.Serialization.JavaScriptSerializer.deserialize(c)}views[a]=new Durados.View(a,$("#"+a+"ViewName").val(),$("#"+a+"GetCreateUrl").val(),$("#"+a+"GetEditUrl").val(),$("#"+a+"GetEditSelectionUrl").val(),$("#"+a+"GetDuplicateUrl").val(),$("#"+a+"GetJsonViewUrl").val(),$("#"+a+"GetRichUrl").val(),$("#"+a+"GetEditRichUrl").val(),$("#"+a+"GetSelectListUrl").val(),$("#"+a+"GetJsonViewInlineAddingUrl").val(),$("#"+a+"GetJsonViewInlineEditingUrl").val(),$("#"+a+"GetInlineAddingDialogUrl").val(),$("#"+a+"GetInlineEditingDialogUrl").val(),$("#"+a+"GetInlineDuplicateDialogUrl").val(),$("#"+a+"GetInlineSearchDialogUrl").val(),$("#"+a+"GetDeleteUrl").val(),$("#"+a+"GetDeleteSelectionUrl").val(),$("#"+a+"GetFilterUrl").val(),$("#"+a+"GetSetLanguageUrl").val(),$("#"+a+"GetIndexUrl").val(),$("#"+a+"GetExportToCsvUrl").val(),$("#"+a+"GetPrintUrl").val(),$("#"+a+"GetAutoCompleteUrl").val(),$("#"+a+"DisplayName").val(),$("#"+a+"viewName").val(),b,$("#"+a+"GetUploadUrl").val(),d,c,$("#"+a+"Controller").val(),$("#"+a+"TabCache").val(),$("#"+a+"RefreshOnClose").val(),$("#"+a+"GetRefreshUrl").val(),$("#"+a+"mainPage").val(),$("#"+a+"MultiSelect").val(),$("#"+a+"Popup").val(),$("#"+a+"Mobile").val(),$("#"+a+"AllowEdit").val(),$("#"+a+"AddItemUrl").val(),$("#"+a+"EditItemUrl").val(),$("#"+a+"DuplicateItemUrl").val(),$("#"+a+"InsertItemUrl").val(),$("#"+a+"DuplicationMethod").val(),$("#"+a+"DuplicateMessage").val(),$("#"+a+"PageSize").val(),$("#"+a+"DisplayType").val(),$("#"+a+"PromoteButton").val(),$("#"+a+"addTitle").val(),$("#"+a+"dupTitle").val(),$("#"+a+"ShowUpDown").val(),$("#"+a+"EditOnlyUrl").val(),$("#"+a+"RowColorColumnName").val(),$("#"+a+"HasOpenRules").val(),$("#"+a+"MaxSubGridHeight").val(),$("#"+a+"AllowCreate").val(),$("#"+a+"WorkFlowStepsFieldName").val(),$("#"+a+"showDisabledSteps").val(),$("#"+a+"ReloadPage").val(),$("#"+a+"GetAllFilterValuesUrl").val(),$("#"+a+"DataDisplayType").val(),$("#"+a+"GridDisplayType").val(),$("#"+a+"InsideTextSearch").val(),$("#"+a+"Role").val(),$("#"+a+"OpenDialogMax").val(),$("#"+a+"SqlProduct").val())}function disableChildrenTabs(b){var a=new Array();b.find('li[haschildren="haschildren"]').each(function(){a.push(parseInt($(this).attr("index")))});b.tabs("option","disabled",a)}var accordionPk=null;function accordionChanged(q,p,f){var k=$(q.newHeader[0]);var o=$(q.newContent[0]);if(f==null){return}if(f[f.length-1]=="#"){f=f.slice(0,-1)}accordionPk=f;var s=f.split(",");if(k.attr("haschildren")=="haschildren"){var m=parseInt(k.attr("index"));var d=unescape(k.attr("url"));var j=d.split("$$");var b="";for(var h=0,l=s.length;h<l;++h){b=b+j[h]+s[h]}b=b+j[j.length-1]+"&children=true";if(true){var g=window.location.href;var c="/Home/IndexWithButtons?url="+encodeURIComponent(b+"&menu=off")+"&backUrl="+encodeURIComponent(g);var r=getDocumentScope();$("iframe[name=viewProp]",r).hide();$("#loadSettings div:first",r).text("Loading Columns Settings...");$("#loadSettings",r).show();window.location=c}else{o.html(FloatingDialog.Create(b));var a=$(q.newContent[0]).find('div[ajaxDiv="ajaxDiv"]');if(a.length==0){return}if(a.attr("isLoaded")=="isLoaded"){return}var e=a.attr("guid");showProgress();initDataTableView(e);views[e].updateCounter();a.attr("isLoaded","isLoaded")}}}function InitAccordion(c,b,f){var d=$("#"+c+"CreateAccordion");var e=$("#"+c+"EditAccordion");if(d.length==0){d=$("#nullInlineAddingAccordion")}if(e.length==0){e=$("#nullInlineEditingAccordion")}var a=true;if(views[c]){a=views[c].TabCache=="True"}if(plugIn()){hideFields(e)}d.accordion({collapsible:true,autoHeight:false,changestart:function(g,h){accordionChanged(h,c,null)}});e.accordion({collapsible:true,autoHeight:false,changestart:function(g,h){accordionChanged(h,c,f!=null?f:Multi.GetSingleSelection(c))}});return d.length>0||e.length>0}function hideFields(b){var a=b.find('h3[haschildren="haschildren"]');var c=a.next();c.remove();c.remove();a.remove()}function InitTabs(d,c){var a=$("#"+d+"CreateTabs");var g=$("#"+d+"EditTabs");var e=$("#"+d+"EditTabs_clone");if(a.length==0){a=$("#nullInlineAddingTabs")}if(g.length==0){g=$("#nullInlineEditingTabs")}var b="True";if(views[d]){b=views[d].TabCache=="True"}a.tabs({fx:{opacity:"toggle",duration:"fast"},cache:b,ajaxOptions:{cache:false,async:false}});g.tabs({fx:{opacity:"toggle",duration:"fast"},cache:b,ajaxOptions:{cache:false,async:false}});if(e.length>0){e.tabs({fx:{opacity:"toggle",duration:"fast"},cache:b,ajaxOptions:{cache:false,async:false}})}if(a.length>0){a.bind("tabsselect",function(h,j){if($(j.tab).attr("nocache")=="nocache"){a.tabs("load",j.index)}else{a.find('input[upload="upload"]').each(function(){$(this).val($(this).attr("d_file"))})}tabSelected(j,"create",d)});disableChildrenTabs(a)}if(g.length>0){g.bind("tabsselect",function(h,j){if($(j.tab).attr("nocache")=="nocache"){g.tabs("load",j.index)}else{g.find('input[upload="upload"]').each(function(){$(this).val($(this).attr("d_file"))})}tabSelected(j,"edit",d)})}if(e.length>0){e.bind("tabsselect",function(h,j){if($(j.tab).attr("nocache")=="nocache"){e.tabs("load",j.index)}else{e.find('input[upload="upload"]').each(function(){$(this).val($(this).attr("d_file"))})}tabSelected(j,"edit",d)})}var f=false;if(a.length>0){a.bind("tabsshow",function(h,j){tabLoaded(j)});f=true}if(g.length>0){g.bind("tabsshow",function(h,j){tabLoaded(j)});f=true}if(e.length>0){e.bind("tabsshow",function(h,j){tabLoaded(j)});f=true}return f}var dialogExt;if(!dialogExt){dialogExt={}}dialogExt.changeState=function(c,b,a){var d=b.attr("d_state");if(d=="max"||IE7){dialogExt.resize(c,b,a);d="dialog"}else{dialogExt.max(c,b,a);d="max"}$.cookie("state_"+currentViewName,d,{expires:1000})};dialogExt.resizeCurrent=function(){resizing=true;if(currentDialog==null){return}var a=currentDialog.prop("item");if(dialogExt.getState(currentDialog)!="max"&&!a){return}var d=currentDialog.attr("guid");if(d==null){d=currentDialog.siblings().closest('div [hasguid="hasguid"]').attr("guid")}if(d==null){return}var c=$(window).width();var b=$(window).height();var e=0;if(a){try{if(!isMobile()){e=$(".menu-container + div").position().top+13}}catch(f){}b-=e}else{b-=22;c-=6}currentDialog.dialog("option","height",b);currentDialog.dialog("option","width",c);currentDialog.dialog("option","position",[0,e]);dialogExt.resizeTabs(currentDialog,d);resizing=false};var resizing=false;dialogExt.max=function(j,g,k){resizing=true;if(g==null){g=j.siblings(".ui-dialog-titlebar").find("a.ui-dialog-titlebar-max")}g.attr("d_state","max");var h=j.dialog("option","position");try{if(h.length==2){if(h[0]==0&&h[1]==0){h="center"}else{position2=new Array();position2[0]=h[0];position2[1]=h[1];h=position2}}else{h="center"}}catch(f){h="center"}var m=j.dialog("option","height");var b=j.dialog("option","width");var c=$(window).width();var e=$(window).height();var d=Rectangle.Load(currentViewName);if(b>c*0.75){if(d==null||d.width>c*0.75){b=c*0.75}else{b=d.width}}if(m>e*0.75){if(d==null||d.height>e*0.75){m=e*0.75}else{m=d.height}}var l={position:h,height:m,width:b};var a=Sys.Serialization.JavaScriptSerializer.serialize(l);g.attr("d_rect",a);$("body").css("overflow","hidden");var c=$(window).width();var e=$(window).height();j.dialog("option","height",e-22);j.dialog("option","width",c-6);j.dialog("option","position",[0,0]);try{j.dialog("option","draggable",false);j.dialog("option","resizable",false)}catch(f){}g.children("span").removeClass("ui-icon-maxthick");g.children("span").addClass("ui-icon-resizethick");g.attr("title",translator.restore);dialogExt.resizeTabs(j,k);j.trigger("dialogresize");resizing=false};dialogExt.resizeTabs=function(b,a){var c=b.width();if(a!=null){}};dialogExt.getState=function(b){var a=b.siblings(".ui-dialog-titlebar").find("a.ui-dialog-titlebar-max");if(a==null){return"dialog"}return a.attr("d_state")};dialogExt.resize=function(f,e,g){e.attr("d_state","dialog");var a=e.attr("d_rect");var c=$(window).width();var d=$(window).height();if(a!=null&&a!=""){var h=Sys.Serialization.JavaScriptSerializer.deserialize(a);var b=h.width;var j=h.height;if(b>c*0.75){b=c*0.75}if(j>d*0.75){j=d*0.75}f.dialog("option","height",j);f.dialog("option","width",b);f.dialog("option","position",h.position)}else{f.dialog("option","height",d*0.75);f.dialog("option","width",c*0.75);f.dialog("option","position","center")}f.dialog("option","draggable",true);f.dialog("option","resizable",true);dialogExt.resizeTabs(f,g);e.children("span").removeClass("ui-icon-resizethick");e.children("span").addClass("ui-icon-maxthick");e.attr("title",translator.maximize);f.trigger("dialogresize");Durados.GridHandler.adjustDataTableHeight(g)};dialogExt.initMaxButton=function(c,b){var d=c.siblings(".ui-dialog-titlebar");var a=d.find("a.ui-dialog-titlebar-close");var f=a.clone(false);a.attr("title",translator.close);f.attr("title",translator.maximize);var e=a.parent("div:first");f.removeClass("ui-dialog-titlebar-close");f.addClass("ui-dialog-titlebar-max");f.children("span").removeClass("ui-icon-closethick");f.children("span").addClass("ui-icon-maxthick");if(!isDock(b)){d.dblclick(function(){dialogExt.changeState(c,f,b)})}f.click(function(){dialogExt.changeState(c,f,b);if(window.parent&&window.location.href.indexOf("Admin/Item/View?")>-1){window.parent.viewProperties(window.parent.getMainPageGuid(),true,window.parent.dock.width,window.parent.dock.url,window.parent.dock.viewDisplayName);window.parent.closeViewProperties()}}).hover(function(){f.addClass("ui-state-hover")},function(){f.removeClass("ui-state-hover")}).focus(function(){f.addClass("ui-state-focus")}).blur(function(){f.removeClass("ui-state-focus")});e.append(f)};function getMainViewName(){return views[getMainPageGuid()].ViewName}dialogExt.iniDockButton=function(b,a){dialogExt.initDialogTitleButton(b,a,"dock",function(){viewProperties(getMainPageGuid(),false,dock.width,dock.url,dock.viewDisplayName);b.dialog("close")},"ui-dialog-titlebar-dock","ui-icon-dockthick")};dialogExt.initDialogTitleButton=function(d,f,g,j,k,h){var e=d.siblings(".ui-dialog-titlebar");var b=e.find("a.ui-dialog-titlebar-close");var c=b.clone(false);c.attr("title",g);var a=b.parent("div:first");c.removeClass("ui-dialog-titlebar-close");c.addClass(k);c.children("span").removeClass("ui-icon-closethick");c.children("span").addClass(h);c.click(j).hover(function(){c.addClass("ui-state-hover")},function(){c.removeClass("ui-state-hover")}).focus(function(){c.addClass("ui-state-focus")}).blur(function(){c.removeClass("ui-state-focus")});a.append(c)};function handleToolbar(a){if(!isDockFields(a)){return}var b=$("#"+a+"toolbar");b.children("div").each(function(){if($(this).attr("role")!="crud"){$(this).remove()}else{$(this).children().each(function(){if($(this).attr("name")!="new"){$(this).remove()}})}});$(".filter-buttons").remove();$(".gridPager-div").remove()}var dialogAutoOpened=false;var currentDialog=null;function initDataTableView(o){var j=$('div.ajaxDiv[guid="'+o+'"]');if(!document.domain){document.domain=j.attr("d_domain")}LoadView(o);Autocomplete.Init(o);var d=$(window).width();var g=$(window).height();var q=d*0.75-55;var r=views[o].gViewName;if(r==null){j.html("");modalErrorMsg("View was not loaded properly.");return}var f=Rectangle.Load(r);if(views[o].DataDisplayType=="Preview"){var m=$("#"+o+"DataRowEdit").clone(true,true);m.attr("id",o+"DataRowEdit_clone");m.find("[id]").each(function(){$(this).attr("id",$(this).attr("id")+"_clone")});m.find("ul>li>a").each(function(){$(this).attr("href",$(this).attr("href")+"_clone")});$("body").append(m);m.dialog({bgiframe:true,autoOpen:false,modal:true,position:"center",width:(d*0.75),resizeStop:SaveDialogOnResize,zIndex:10000,open:function(s,t){currentDialog=$("#"+o+"DataRowEdit_clone")},dragStop:SaveDialogOnDrag})}try{if(f!=null){$("#"+o+"DataRowCreate").dialog({bgiframe:true,autoOpen:false,modal:true,position:[f.left,f.top],width:f.width,height:f.height,resizeStop:SaveDialogOnResize,zIndex:10000,close:function(s,t){Durados.Tabs.select($("#"+o+"CreateTabs"),0)},open:function(t,v){var u=$.cookie("state_"+views[o].gViewName);var s=views[o].DataDisplayType;if(s!="Preview"&&(u=="max"||IE7)){dialogExt.max($("#"+o+"DataRowCreate"),null,o)}currentDialog=$("#"+o+"DataRowCreate");window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1)},dragStop:SaveDialogOnDrag});$("#"+o+"DataRowEdit").dialog({bgiframe:true,autoOpen:false,modal:true,position:[f.left,f.top],width:f.width,height:f.height,resizeStop:SaveDialogOnResize,zIndex:10000,beforeClose:function(s,t){return EditDialog.Close(o,h,false,false)},close:function(s,t){Durados.Tabs.select($("#"+o+"EditTabs"),0)},open:function(t,v){var u=$.cookie("state_"+views[o].gViewName);var s=views[o].DataDisplayType;if(s!="Preview"&&(u=="max"||IE7)){dialogExt.max($("#"+o+"DataRowEdit"),null,o)}currentDialog=$("#"+o+"DataRowEdit");window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1)},dragStop:SaveDialogOnDrag});q=f.width-55}else{$("#"+o+"DataRowCreate").dialog({bgiframe:true,autoOpen:false,modal:true,position:"center",width:(d*0.75),resizeStop:SaveDialogOnResize,zIndex:10000,beforeClose:function(s,t){return EditDialog.Close(o,h,false,false)},close:function(s,t){Durados.Tabs.select($("#"+o+"CreateTabs"),0)},open:function(s,u){var t=$.cookie("state_"+views[o].gViewName);if(t=="max"||IE7){dialogExt.max($("#"+o+"DataRowCreate"),null,o)}currentDialog=$("#"+o+"DataRowCreate");window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1)},dragStop:SaveDialogOnDrag});$("#"+o+"DataRowEdit").dialog({bgiframe:true,autoOpen:false,modal:true,position:"center",width:(d*0.75),resizeStop:SaveDialogOnResize,zIndex:10000,close:function(s,t){Durados.Tabs.select($("#"+o+"EditTabs"),0)},open:function(s,u){var t=$.cookie("state_"+views[o].gViewName);if(t=="max"||IE7){dialogExt.max($("#"+o+"DataRowEdit"),null,o)}currentDialog=$("#"+o+"DataRowEdit");window.setTimeout(function(){jQuery(document).unbind("mousedown.dialog-overlay").unbind("mouseup.dialog-overlay")},1)},dragStop:SaveDialogOnDrag})}dialogExt.initMaxButton($("#"+o+"DataRowEdit"),o);dialogExt.initMaxButton($("#"+o+"DataRowCreate"),o);$("#rich").dialog({bgiframe:true,autoOpen:false,modal:true,zIndex:10000,position:"center",height:(g*0.75),width:(d*0.75)});$("#richDisabled").dialog({bgiframe:true,autoOpen:false,modal:true,zIndex:10000,position:"center",height:(g*0.75),width:(d*0.75)});$("#notRich").dialog({bgiframe:true,autoOpen:false,modal:true,zIndex:10000,position:"center",height:(g*0.75),width:(d*0.75)});$("#UrlDialog").dialog({bgiframe:true,autoOpen:false,modal:true,zIndex:10000,position:"center",height:(g*0.5),width:(d*0.5)})}catch(e){}var c=InitAccordion(o,q);if(!c){InitTabs(o,q)}slider.InitSlider(null);var p=$("#"+o+"Create"+ReplaceNonAlphaNumeric(views[o].jsonViewForCreate.ViewName)+"DataRowForm");if(p.length==1){InitValidation(o,createPrefix,views[o].jsonViewForCreate)}else{}var l=$("#"+o+"Edit"+ReplaceNonAlphaNumeric(views[o].jsonViewForEdit.ViewName)+"DataRowForm");if(l.length==1){InitValidation(o,editPrefix,views[o].jsonViewForEdit)}initDerivation(views[o].jsonViewForCreate.Derivation,$("#"+o+"DataRowCreate"),createPrefix,o,views[o].jsonViewForCreate.ViewName);initDerivation(views[o].jsonViewForEdit.Derivation,$("#"+o+"DataRowEdit"),editPrefix,o,views[o].jsonViewForEdit.ViewName);try{$("#DeleteMessage").dialog({bgiframe:true,autoOpen:false,modal:true,width:500,height:200,zIndex:10000,position:"center"});$("#DeleteSelectionMessage").dialog({bgiframe:true,autoOpen:false,modal:true,width:500,height:200,zIndex:10000,position:"center"})}catch(e){}$("select[outsideDependency='outsideDependency']").change(function(){var t=$(this);var v=GetPrefix(t,o);var x=t.attr("dependentFieldName");var u=t.attr("dependentFieldViewName");var s=$("#"+o+v+ReplaceNonAlphaNumeric(x));Dependency.ClearAll(s,o);var w=t.val();if(w==""){Dependency.Clear(s)}else{Dependency.Load(u,x,w,s,o)}});InitContextMenu(o);InitChangeFieldOrder(o);if($.browser.msie){$("input[type='checkbox']").click(function(){$(this).trigger("change")})}success(o);$(Durados.View).trigger("initDataTableView",{guid:o});var a=views[o].Popup;var h=queryString("pk");if(!dialogAutoOpened&&a&&(h&&hasRows(o)||(openSingleRow(o)))){if(!h){h=Multi.getFirstRowPK(o)}$.cookie("state_"+views[o].ViewName,"max",{expires:1000});EditDialog.Open(h,o,false);dialogAutoOpened=true}var b=queryString("Add");b=b&&(b=="newdialog"||b=="newdialog#");if(!dialogAutoOpened&&a&&b){var k={guid:o,cancel:false};$(AddDialog).trigger("autoOpenAdd",k);if(!k.cancel){AddDialog.Open(null,o,false)}dialogAutoOpened=true}if(queryString("settings")=="true"){rowtabletitleSpan.click()}}function hasRows(a){return parseInt($("#"+a+"ajaxDiv").find("table.gridview:first").attr("rowCount"))>0}function htmlEntities(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}var insideDependencyChangeWorking=false;function insideDependencyChange(a,c){if(insideDependencyChangeWorking){return false}insideDependencyChangeWorking=true;var b=$(a);var f=GetPrefix(b,c);var d=b.attr("dependentFieldViewName");var e=b.attr("dependentFieldNames").split(";");Dependency.LoadInside(d,e,f,a,c);insideDependencyChangeWorking=false;return true}function InitChangeFieldOrder(a){$("#"+a+"ajaxDiv").find('select[name="d_fieldOrder"]').change(function(){var b=$(this).val();$.ajax({url:gVD+"Admin/ChangeConfigFieldOrder/",contentType:"application/json; charset=utf-8",data:{fieldOrder:b},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(c){if(c==""){$.post(views[a].gIndexUrl,{SortColumn:b,direction:"Asc",guid:a},function(e){hideProgress();var d=e.indexOf("$$error$$",0);if(d<0||d>1000){FilterForm.HandleSuccess(e,false,a,null);prevSortedColumn=b;prevSortedDirection="Asc";InitChangeFieldOrder(a)}else{ajaxNotSuccessMsg(e,a)}})}else{ajaxNotSuccessMsg(c)}}})})}var contextInfo={};var movedColumnInfo={};var renamedFieldInfo={};function InitContextMenu(a){$("#"+a+"ajaxDiv").mousedown(function(j){var c=document.elementFromPoint(j.clientX,j.clientY);var k=$(j.target);var f=k.attr("class")=="Multi";var l=k.attr("class")=="inlineAddingImg expand";var g=$(c).parents("tr").attr("d_pk");if(f||l){$("#"+a+"ajaxDiv").disableContextMenu();cellsSelection.clear()}else{if(g){var d=Multi.GetElementByPK(a,g);if(d!=null){if((!j.ctrlKey||!views[a].MultiSelect)&&!j.shiftKey&&!Durados.CheckBox.IsChecked($(d))){Multi.Clear(a)}Durados.CheckBox.SetChecked($(d),"checked");Multi.Select(a,views[a].MultiSelect,true,j.ctrlKey,d)}if(isRightClick(j)){$("#myMenu"+a).find("li").show();$("#myMenu"+a).find('li[d_admin="d_admin"]').hide();$("#"+a+"ajaxDiv").enableContextMenu()}}else{var p;if(!k.length||k[0].tagName!="TH"){var b=k.parents("TH").first();if(b.length==1){k=b;p=k.attr("SortColumn")}}else{p=k.attr("SortColumn")}if(k.length&&p){contextInfo[a]={fieldName:p,targetElement:k};if($(k.context).attr("class")=="desc-icon"){$("#myMenu"+a).find("li").hide();var h=$("#myMenu"+a).find('li[d_admin="d_admin"]');if(h.length>0&&isLeftClick(j)){h.show();$("#"+a+"ajaxDiv").enableContextMenu();$("#"+a+"ajaxDiv").enableContextMenuLeftClick()}else{$("#"+a+"ajaxDiv").disableContextMenu()}}else{$("#"+a+"ajaxDiv").disableContextMenu();if(movedColumnInfo[a]){var m=movedColumnInfo[a].placement=="before";var o=movedColumnInfo[a].elementToMove.attr("SortColumn");moveFieldTo(views[a].ViewName,o,m,a,p,rootPath+"Admin/MoveField2/"+views[a].ViewName);Durados.GridHandler.moveColumn(a,contextInfo[a].targetElement);Durados.GridHandler.resetHeadersMoveToClass()}}}else{$("#"+a+"ajaxDiv").disableContextMenu()}}}});$("#"+a+"ajaxDiv").contextMenu({menu:"myMenu"+a},function(e,c,f){var d=$(c).offset();var b=document.elementFromPoint(d.left,d.top);d_doAction(a,e)})}function LoadCheckListFilter(a,b){showProgress();a.attr("d_loaded","d_loaded");Dependency.Load(views[b].gViewName,a.attr("name"),"",a,b);var d=a.parents("td:first");var c=a.attr("isGroupFilter");if(c=="True"){width=a.width()}else{width=d.width()-4}a.siblings(".ui-dropdownchecklist").remove();initDropdownchecklist(a,b,width);setTimeout(function(){a.dropdownchecklist("drop")},1);hideProgress()}function initDropdownchecklistFilter(a,b){if(a.find("option").length>1||a.attr("d_loaded")=="d_loaded"){initDropdownchecklist(a,b);return}}function showEmptyDropdownchecklist(a){try{a.dropdownchecklist("destroy")}catch(b){}a.dropdownchecklist({icon:{},minWidth:80})}function initDropdownchecklist(k,j,d){var a=null;try{k.dropdownchecklist("destroy")}catch(g){}if(k.attr("role")!="childrenCheckList"&&k.attr("id").indexOf("filter")!=-1){k.parents("td:first").keyup(function(l){if(l.keyCode==$.ui.keyCode.ENTER){FilterForm.Apply(false,j,null);return false}})}if(((k.closest("form").length==0||k.closest("form").attr("viewName")!=k.attr("viewName"))&&k.siblings(".ui-dropdownchecklist").length==0)||k.attr("role")=="childrenCheckList"||k.attr("role")=="childrenCheckListFilter"){var b=52;var f=k.attr("d_minWidth");if(f!=""){f=parseInt(f);if(f>0){b=f}else{if(isInDialog(k)){b=80}else{b=52}}}var e=k.attr("filter")=="filter";if(e){if(!d){d=k.parents("td:first").width()}b=10;k.bind("drop",function(m,l){if(k.find("option").length<=1&&k.attr("d_loaded")!="d_loaded"){LoadCheckListFilter(k,j);k.removeAttr("d_loaded")}})}else{if(!d){d=k.width();if(b>d){d=b}}}var h={};if($("body").attr("dir")=="rtl"){h.placement="right";h.toOpen="ui-icon-triangle-1-w"}var c=k.attr("id");if(k!=null&&k.length>0&&k.val()!=null){lastSelection[c]=k.val().join(",")}else{lastSelection[c]=""}a=k.dropdownchecklist({icon:h,toOpen:"ui-icon ui-icon-triangle-1-e",toClose:"ui-icon ui-icon-triangle-1-s",width:d,maxDropHeight:450,minWidth:b,firstItemChecksAll:true,forceMultiple:true,onComplete:function(l){var m="";var o=[];$(this).find("option").removeAttr("selected");for(i=0;i<l.options.length;i++){if(l.options[i].value==""){}if(l.options[i].selected&&(l.options[i].value!="")){}$(this).find('option[value="'+l.options[i].value+'"').attr("selected","selected");if(i>0&&l.options[i].selected){o.push(l.options[i].value)}}m=o.join(",");this.sourceSelect.trigger("blur",{select:this});if(lastSelection[c]!=m){if(k.attr("role")!="childrenCheckList"&&k.attr("id").indexOf("filter")!=-1){FilterForm.Apply(false,j,null)}}lastSelection[c]=m},textFormatFunction:function(l){return getDeimetedOptions(l)}});if(k.is(":disabled")){k.dropdownchecklist("disable")}}else{k.removeAttr("multiple");k.css("display","block")}return a}var lastSelection=[];function initDropdownChecklistsCreate(a){$("#"+a+"DataRowCreate").find("select.dropdownchecklist").each(function(){if($(this).attr("filter")=="filter"){}else{if($(this).attr("hasInsideTrigger")=="hasInsideTrigger"){showEmptyDropdownchecklist($(this))}else{initDropdownchecklist($(this),a)}}})}function initDropdownChecklistsEdit(a,b){if(!b){b=$("#"+a+"DataRowEdit")}b.find("select.dropdownchecklist").each(function(){if($(this).attr("filter")=="filter"){}else{if($(this).attr("hasInsideTrigger")=="hasInsideTrigger"){showEmptyDropdownchecklist($(this))}else{initDropdownchecklist($(this),a)}}})}function getDeimetedOptions(b){var a="";for(i=0;i<b.length;i++){if(b[i].selected&&(b[i].value!="")){if(a!=""){a+=","}a+=b[i].text}}return a}var slider;if(!slider){slider={}}slider.InitSlider=function(a,b){if(a==null){a=$(document)}if(!b){b=3}var c=$("body").attr("dir")=="rtl";a.find(".ui-slider").anythingSlider({theme:"default",mode:"horiz",expand:false,resizeContents:false,showMultiple:b,easing:"swing",buildArrows:true,buildNavigation:false,buildStartStop:false,appendForwardTo:null,appendBackTo:null,appendControlsTo:null,appendNavigationTo:null,appendStartStopTo:null,toggleArrows:false,toggleControls:false,startText:"Start",stopText:"Stop",forwardText:"&raquo;",backText:"&laquo;",tooltipClass:"tooltip",enableArrows:true,enableNavigation:true,enableStartStop:true,enableKeyboard:true,startPanel:1,changeBy:1,hashTags:true,infiniteSlides:true,navigationFormatter:null,navigationSize:false,autoPlay:false,autoPlayLocked:false,autoPlayDelayed:false,pauseOnHover:false,stopAtEnd:false,playRtl:c,delay:2000,resumeDelay:2000,animationTime:400,delayBeforeAnimate:0,isVideoPlaying:function(d){return false}})};var itemCreateDialog=null;var itemEditDialog=null;function InitItemDialog(k){LoadView(k);Autocomplete.Init(k);var f;var l;var h=null;var p=13;var b=null;var m=$(window).width()-75;if(isDock(k)||plugIn()){h=[8,118];f=$(window).width()-25;l="auto"}else{b=$(".menu-container + div");var q=[0,0];if(b!=null&&b.length>0){try{q=b.position()}catch(e){}}if(q!=null&&q.top!=null){p=q.top+13}else{p=13}if(isMobile()){p=30}h=[0,p];f=$(window).width();l=$(window).height()-p}itemCreateDialog=$("#"+k+"DataRowCreate");if(views[k].Mobile){var j=$("<div></div>");try{j.dialog({autoOpen:false})}catch(e){}try{j.dialog("destroy")}catch(e){}try{itemCreateDialog.dialog({autoOpen:false,modal:false,position:[0,65],width:f,height:l,open:function(d,r){dialogExt.max(itemCreateDialog,null,k);currentDialog=itemCreateDialog},stack:false,resizable:false})}catch(e){}}else{itemCreateDialog.dialog({bgiframe:true,autoOpen:false,modal:false,closeOnEscape:false,position:h,width:f,height:l,open:function(d,r){dialogExt.max(itemCreateDialog,null,k);currentDialog=itemCreateDialog},stack:false,resizable:false,dragStop:SaveDialogOnDrag})}itemEditDialog=$("#"+k+"DataRowEdit");try{itemEditDialog.dialog({bgiframe:true,autoOpen:false,modal:false,closeOnEscape:false,position:h,width:f,height:l,stack:false,resizable:false,dragStop:SaveDialogOnDrag,beforeClose:function(d,r){return EditDialog.Close(k,null,false,false)},close:function(d,r){if(window.parent){setTimeout(function(){window.parent.closeViewProperties()},1)}},open:function(d,r){if(isDock(k)||plugIn()){dialogExt.max(itemEditDialog,null,k)}currentDialog=itemEditDialog}})}catch(e){}if(isDock(k)||plugIn()){dialogExt.initMaxButton(itemEditDialog,k)}else{itemCreateDialog.prop("item",true);itemEditDialog.prop("item",true);Durados.Dialogs.zIndex(itemCreateDialog,0);Durados.Dialogs.zIndex(itemEditDialog,0);$("#"+k+"DataRowCreate").siblings(".ui-dialog-titlebar").hide();$("#"+k+"DataRowEdit").siblings(".ui-dialog-titlebar").hide()}var o=$("#"+k+"CreateTabs");var g=$("#"+k+"EditTabs");var a=views[k].TabCache=="True";o.tabs({fx:{opacity:"toggle",duration:"fast"},cache:a,ajaxOptions:{cache:false,async:false}});g.tabs({fx:{opacity:"toggle",duration:"fast"},cache:a,ajaxOptions:{cache:false,async:false}});o.bind("tabsselect",function(d,r){if($(r.tab).attr("nocache")=="nocache"){o.tabs("load",r.index)}});$("#"+k+"DataRowCreate").siblings(".ui-dialog-titlebar").hide();$("#"+k+"DataRowEdit").siblings(".ui-dialog-titlebar").hide();var c=InitAccordion(k,m,queryString("pk"));$("#"+k+"EditAccordion").find("h3:not([haschildren])").append('<span class="ui-icon ui-icon-resizethick ui-accordion-header-open"></span>');$("#"+k+"EditAccordion").find("h3:[haschildren]").append('<span class="ui-icon ui-icon-triangle-1-e ui-accordion-header-open"></span>');if(!c){InitTabs(k,m)}slider.InitSlider(null);$("#DeleteMessage").dialog({bgiframe:true,autoOpen:false,modal:true,width:500,height:200,position:"center"});$("#DeleteSelectionMessage").dialog({bgiframe:true,autoOpen:false,modal:true,width:500,height:200,position:"center"});$("select[outsideDependency='outsideDependency']").change(function(){var r=$(this);var t=GetPrefix(r,k);var v=r.attr("dependentFieldName");var s=r.attr("dependentFieldViewName");var d=$("#"+k+t+ReplaceNonAlphaNumeric(v));Dependency.ClearAll(d,k);var u=r.val();if(u==""){Dependency.Clear(d)}else{Dependency.Load(s,v,u,d,k)}});$("select[insideDependency='insideDependency']").change(function(){var d=$(this);var t=GetPrefix(d,k);var r=d.attr("dependentFieldViewName");var s=d.attr("dependentFieldNames").split(";");Dependency.LoadInside(r,s,t,this,k)});InitValidation(k,createPrefix,views[k].jsonViewForCreate);InitValidation(k,editPrefix,views[k].jsonViewForEdit);initDerivation(views[k].jsonViewForCreate.Derivation,$("#"+k+"DataRowCreate"),createPrefix,k,views[k].jsonViewForCreate.ViewName);initDerivation(views[k].jsonViewForEdit.Derivation,$("#"+k+"DataRowEdit"),editPrefix,k,views[k].jsonViewForEdit.ViewName);if($.browser.msie){$("input[type='checkbox']").click(function(){$(this).trigger("change")})}if(!isMobile()){success(k)}$(Durados.View).trigger("initItemDialog",{guid:k})}function Grid(a){this.guid=a;this.parent=null;this.root=true;this.childrenList=new Array();this.add=function(b,h,d,c,e){var f=new Grid(b);this.childrenList.push(f);f.tr=h;f.pk=h.attr("d_pk");f.parent=this;f.button=d;f.placement=c;f.disabled=e;this.root=false;gridHash[b]=f}}var gridHash=new Array();var parentGrid=null;function addToParentGrid(b,a,g,d,c,f){var e=getGrid(b);if(e!=null){e.add(a,g,d,c,f)}}function getGrid(a){if(parentGrid==null){parentGrid=new Grid(a);gridHash[a]=parentGrid;return parentGrid}else{return gridHash[a]}}function updateParentGrid(a){var c=getGrid(a);if(c==null){return}var b=c.parent;if(b==null){return}Refresh(b.guid)}function updateParent(a){var h=getGrid(a);if(h==null){return}var c=h.parent;if(c==null){return}var f=c.guid;if(!views[a].updateParent){updateParent(f)}var d=h.pk;var e=h.tr;if(d==null||d==""){return}var g=views[f].gViewName;if(g==null||g==""){return}var b=rootPath+views[a].Controller+"/UpdateParent/"+g;$.ajax({url:b,contentType:"application/json; charset=utf-8",data:{pk:d,guid:f},async:true,dataType:"json",cache:false,error:function(){return},success:function(m){if(typeof(result)=="string"){var l=result.indexOf("$$error$$",0);var k=!(l<0||l>1000);if(k){return}}var j=$(m);j.each(function(){var o=this.Name;var q=this.Value;var p=this.DisplayValue;var r=getTd(e,o);updateTd(r,q,p)});updateParent(f)}})}function getTd(b,a){return b.find('td[d_name="'+a+'"]:first')}function updateTd(d,b,a){var c=d.attr("d_val");if(c!=b){d.attr("d_val",b);d.html(a)}}function expand(k,f,j,h,l){var d=$(k).attr("state");if(d==null){return}var b=$(k).attr("src");var e=$(k).parent("div").siblings("div");var g=e.attr("pk");var a=g=="";var o=j;var m=$(k).attr("nocache")=="nocache";if(d=="collapsedEmpty"||f||(d=="collapsed"&&m)){var c=unescape(e.attr("url"));if(h==null){h=false}c=c.replace("$$",g);showProgress();$.ajax({url:c,contentType:"application/json; charset=utf-8",data:{children:true,disabled:h},async:true,dataType:"html",cache:false,error:ajaxErrorsHandler,success:function(u){var s=u.indexOf("$$error$$",0);if(s<0||s>1000){var t=$(k).attr("updateParent")=="Row";var r=$(k).attr("updateParent")=="Grid";if(a){var p=expandInGrid(k,u,o);if(p!=null){try{initDataTableView(p);addToParentGrid(l,p,$(k).parents("tr:first"),k,j,h);views[p].updateParent=t;views[p].updateParentGrid=r}catch(v){}}}else{e.html(u)}$(k).attr("state","expand");if($(k)[0].tagName=="IMG"){$(k).attr("src",b.replace("Plus","Minus"))}else{$(k).text("")}var q=e.find('div[ajaxDiv="ajaxDiv"]');if(q.length==1){var p=q.attr("guid");if(p!=null){initDataTableView(p);addToParentGrid(l,p,$(k).parents("tr:first"),k,j,h);views[p].updateParent=t;views[p].updateParentGrid=r}}hideProgress()}else{ajaxNotSuccessMsg(u)}hideProgress()}})}else{if(d=="collapsed"){e.css("display","block");$(k).attr("state","expand");$(k).attr("src",b.replace("Plus","Minus"));if(a){changeStateInGrid(k,d)}}else{if(d=="expand"){e.css("display","none");$(k).attr("state","collapsed");$(k).attr("src",b.replace("Minus","Plus"));if(a){changeStateInGrid(k,d)}}}}}function changeStateInGrid(b,e){var d=$(b).parents("tr:first");var a=d.next();var c=a.attr("d_role")=="subGrid";if(c){if(e=="expand"){a.hide();d.removeClass("expanded")}else{a.show();d.addClass("expanded")}}switchSelectedClass(b);Durados.GridHandler.adjustParentHeight(d)}function switchSelectedClass(b){var c=$(b).parents("td:first");var a=$(b).attr("selectedClass");if(c.hasClass(a)){c.removeClass(a)}else{c.addClass(a)}}function expandInGrid(b,r,h){var d=$(b).parents("tr:first");resetExpandButtons(d,b);var a=d.next();var c=a.attr("d_role")=="subGrid";var y=d.parents("table:first");if(c){a.remove()}if(!h){h=2}else{if(h==-1){var g=$(b).parents("td").first();h=d.children().index(g);if(!h){h=2}}else{h+=1}}var s=d[0].cells.length;if(h>s){h=s-1}var l=s-h;var m=$("<tr d_role='subGrid' class='trsubgrid'></tr>");var e="<td class='tablecmdsubgrid' colspan='"+h+"'></td>";var u=$(e);var j=$('<div class="subgridControl" />');var x=$('<span class="ui-icon ui-icon-closethick" />').click(function(){$(b).click()});var f=$('<span class="ui-icon ui-icon-maxthick" />').click(function(){location.href=$(b).siblings("a").attr("href")});j.append(x).append(f);u.append(j);m.append(u);var o=$("<td class='subGridData' colspan='"+l+"'></td>");m.append(o);var p=m;p.insertAfter(d);var q=o.width();o.html(r);var v=p.find("div.fixedViewPort").first();var k=p.find("div.ajaxDiv:first");var t=k.attr("guid");if(v.width()>q){v.width(q)}else{}switchSelectedClass(b);d.addClass("expanded");if(k.length&&t){adjustSubGridUI(t);return t}return null}function getRowCount(a){return $("#"+a+"ajaxDiv").find("table.gridview:first").attr("rowCount")}function openSingleRow(c){var e=$("#"+c+"ajaxDiv").find("table.gridview:first");var a=e.attr("openSingleRow")=="True";if(!a){return false}var d=getRowCount(c);return(d==1)}function adjustSubGridUI(d){var c=$("#"+d+"ajaxDiv");if(!c.length){return}var f=c.parents("td:first");var e=f.parents("tr:first");if(e.attr("d_role")=="subGrid"){f.css({paddingTop:0,paddingBottom:0,paddingRight:0});f.find("table.gridview").parent().css({paddingBottom:0});var b=$("#"+d+"ajaxDiv").find("table.gridview:first").attr("rowCount");var a=$("#"+d+"ajaxDiv").find("table.gridview:first").attr("pageSize");if(parseInt(b)<parseInt(a)){c.find(".gridPager-div").hide()}}}function resetExpandButtons(b,a){b.find("img.expand").each(function(){var d=$(this).attr("src");$(this).attr("state","collapsedEmpty");$(this).attr("src",d.replace("Minus","Plus"));var c=$(this).attr("selectedClass");if($(this).parents("td:first").hasClass(c)){switchSelectedClass(this)}})}var inlineValidations=[];function InitValidation(c,f,d){$(d.Fields).each(function(){var k=this.Value;var h=$("#"+c+f+ReplaceNonAlphaNumeric(k.Name));var j="the"+c+f+d.ViewName+"_"+k.Name;if(!c||c=="null"){inlineValidations[f+","+d.ViewName+","+k.Name]=getFieldValidation(k,j,h)}else{views[c].validations[f+","+d.ViewName+","+k.Name]=getFieldValidation(k,j,h)}});if($("#"+c+"pageSize").length>0){var g=$("#"+c+"pageSize").val().length;var e="";for(var b=0,a=g;b<a;++b){e=e+"0"}new Spry.Widget.ValidationTextField(c+"currentPage","integer",{isRequired:true,useCharacterMasking:true})}}function isValidDate(f,b){var c=$(f);var e=c.val();if(!e){return true}var d=b;var a=Date.parseExact(e,d);return a!=null}function checkIsValidDate(c,d,e){if(c<1||c>32||d<0||d>11||e>2900||e<1900){return false}var a=new Date(e,d,c);if((a.getMonth()!==d)||(a.getDate()!==c)||(a.getFullYear()!==e)){return false}return true}var valid_m_names=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function getFieldValidation(g,a,d){if(g.Disabled){return null}var h={isRequired:g.Required};var f=g.ValidationType;if(!f){f="none"}h.useCharacterMasking=true;if(g.Type=="Text"||g.Type=="AutocompleteColumn"){if(g.ValidationType=="date"){if(isMobile()){h.validation=function(){return true}}else{var c=duradosGetSpryDateFormat(g.Format);h.validation=function(){return isValidDate(d,c)}}f="custom"}else{if(g.ValidationType=="custom"){if(!g.Format){f="none";h.useCharacterMasking=false}else{h.pattern=g.Format;h.validateOn=["change"]}}}if(g.ValidationType=="integer"||g.ValidationType=="real"){if(g.Min){h.minValue=g.Min}}else{if(g.Min){h.minChars=g.Min}}if(g.Max){if(g.ValidationType=="integer"||g.ValidationType=="real"){h.maxValue=g.Max}else{h.maxChars=g.Max}}return new Spry.Widget.ValidationTextField(a,f,h)}else{if(g.Type=="Autocomplete"){return new Spry.Widget.ValidationTextField(a,"custom",{validation:function(){return GetAutoCompleteValueId(d)!=""},isRequired:g.Required})}else{if(g.Type=="DropDown"||g.Type=="OutsideDependency"||g.Type=="InsideDependency"||g.Type=="InsideDependencyUniqueNames"||g.Type=="Groups"){return new Spry.Widget.ValidationSelect(a,h)}else{if(g.Type=="TextArea"){var b=d.attr("rich")=="true";if(!b){if(g.Min){h.minValue=g.Min}if(g.Max&&g.Max>0){h.maxChars=g.Max}}h.validateOn=[];try{return new Spry.Widget.ValidationTextarea(a,h)}catch(e){return null}}else{if(g.Type=="CheckList"&&g.Required){return new Spry.Widget.ValidationSelect(a,{isRequired:g.Required,invalidValue:""})}}}}}return null}var AddItemsDialog;if(!AddItemsDialog){AddItemsDialog=function(){}}AddItemsDialog.GetButtons=function(b,e,a,c){var d={};d[translator.add]=function(){AddItemsDialog.Add(b,e,a,c)};d[translator.cancel]=function(){c.dialog("close")};d[translator.add]=function(){AddItemsDialog.Add(b,e,a,c)};return d};AddItemsDialog.CreateAndOpen=function(m,o,d,e,k,c){searchGuidPostfix++;searchGuid=k+searchGuidPostfix;var l="";var q="";if(c){var p=$(c).parents("div.childrenViewer").first().attr("itemsFilter");if(p&&p.indexOf(",")>0){var j=p.split(",");var b=$(c).parents("div.ui-tabs").find('[name="'+j[0]+'"]');if(b.is("input")){q=GetAutoCompleteValueId(b)}else{q=b.val()}l="&df="+j[1]+"&dfval="+q}}var f={guid:k,viewName:m,searchUrl:e,filterVal:q,cancel:false};$(AddItemsDialog).trigger("beforeAddItems",f);if(f.cancel){return}var g=FloatingDialog.Show(f.searchUrl+"&guid="+searchGuid+l,"Add Items from "+o,null,true);var h=AddItemsDialog.GetButtons(k,d,searchGuid,g);g.dialog("option","buttons",h);initDataTableView(searchGuid);var a=true;views[searchGuid].MultiSelect=a};AddItemsDialog.Add=function(f,d,g,e){var c=Multi.GetSelection(g);if(!c.length){ajaxNotSuccessMsg("Please select a row(s)");return}showProgress();var l=AddItemsDialog.getParentGuid(f);var b="";if(l!=null){b=views[l].ViewName}var k=AddItemsDialog.getParentKey(f);if(k==null){k=""}var j=views[f].ViewName;var a=AddItemsDialog.getSelectAll(g);if(a==null){a=false}var h={guid:f,viewName:j,parentViewName:b,addItemsUrl:d,searchGuid:g,parentGuid:l,fk:k,isSelectAll:a};$(AddItemsDialog).trigger("afterAddItems",h);$.post(h.addItemsUrl,{viewName:h.viewName,guid:h.guid,pks:String(c),parentViewName:h.parentViewName,fk:h.fk,isSelectAll:h.isSelectAll,searchGuid:h.searchGuid},function(o){hideProgress();var m=o.indexOf("$$error$$",0);if(m<0||m>1000){FilterForm.HandleSuccess(o,false,f,c);var p={guid:f,viewName:j,pks:c,parentViewName:b,fk:k};$(AddItemsDialog).trigger("afterAddItems",p);e.dialog("close")}else{e.dialog("close");Refresh(f);setTimeout(function(){ajaxNotSuccessMsg(o,f)},1)}setTimeout(function(){loadMainMenu(f)},1)})};function loadMainMenu(a){$.ajax({url:rootPath+views[a].Controller+"/GetMainMenu/",contentType:"application/html; charset=utf-8",data:{},async:false,cache:false,success:function(b){$("div.workspaceMenu").html(b);InitTopMenu()}})}function GetWorkspaceMenu(){$.ajax({url:"/Admin/GetWorkspaceMenu/",contentType:"application/html; charset=utf-8",data:{},async:false,cache:false,success:function(a){$("div.workspaceMenu").html(a);$("#mainmenu").superfish()}})}$(AddItemsDialog).bind("beforeAddItems",function(b,a){if(a.viewName=="View"){a.searchUrl="/Admin/Index/durados_Schema?firstTime=true"}});AddItemsDialog.getParentGuid=function(a){var b=$("#"+a+"ajaxDiv");if(b.length>0){var d=b.parents("div[ajaxdiv='ajaxDiv']:first");if(d.length>0){return d.attr("guid")}else{var c=b.parents("form:first").parents('div[hasguid="hasguid"]:first').attr("guid");if(c==null){return null}else{return c}}}return null};AddItemsDialog.getParentKey=function(b){var c=$("#"+b+"ajaxDiv");var e=c.parents("tr:first");var a=e.prev();var d=a.attr("d_pk");if(d==null){d=c.parent().parent().find("div.childrenViewer:first").attr("pk");if(d==null){d=c.parents("div[hasguid='hasguid']:first").attr("pk");if(d==null){return null}else{return d}}else{return d}}else{return d}};AddItemsDialog.getSelectAll=function(a){var b=$("#"+a+"ajaxDiv");return isChecked=Durados.CheckBox.IsChecked($(b).find("table.gridview tr.gridviewhead th.thCheck input:first"))};function d_addItems(d,c,f,g,e,b,a){showProgress();setTimeout(function(){AddItemsDialog.CreateAndOpen(g,e,c,f,b,a)},1)}function d_addNew(g,c,a,b,l,k,h,d,j,e,m){var f=$(h).closest("form").length==0;if((c||!f)&&!a){AddDialog.Open(g,k,false,d,j,e,m)}else{window.location=b+"&allowEdit="+d+"&insertAbovePK="+j+"&duplicateRecursive="+e}}function d_edit(h,d,b,c,m,l,j,k){if(h==null&&$(j).attr("pk")!=null){var f=$(j).parent("TD.d_fieldContainer").attr("d_role")=="cell";if(f&&!k.ctrlKey){return}h=$(j).attr("pk")}var g=$(j).closest("form").length==0;var a=l!=null&&views[l]!=null&&views[l].DataDisplayType=="Preview";if(((d||!g)&&!b)||a){EditDialog.Open(h,l,false)}else{c=c.replace("pk=____","pk="+h);window.location.href=c}}function d_Duplicate(d,b,a,g,c,h,f,e,j,k){if(j=="Shallow"){d_addNew(d,b,a,g,h,f,e,true,d,false)}else{if(j=="Recursive"){d_addNew(d,b,a,g,h,f,e,true,d,true)}else{if(j=="User"){if(confirm(k)){d_addNew(d,b,a,g,h,f,e,true,d,true)}else{d_addNew(d,b,a,g,h,f,e,true,d,false)}}}}}function d_DuplicateRecursive(f,a,d,c,g,b,e){showProgress();$.post(views[b].gDuplicateUrl,{pk:f,guid:b},function(j){hideProgress();var h=j.indexOf("$$error$$",0);if(h<0||h>1000){if(j==null||j==""){ajaxNotSuccessMsg("error")}else{d_edit(j,a,d,c.replace("xxxx",j),g,b,e)}}else{ajaxNotSuccessMsg("error")}})}function getFieldJson(d,h){var b=jQuery.extend(true,{},h);b.Fields=[];for(var c=0,a=h.Fields.length;c<a;++c){var g=h.Fields[c];if(g.Key==d){var e=jQuery.extend(true,{},g);b.Fields[0]=e;break}}return b}var fieldsDialog=null;function AddColumn(a){d_doAction(getMainPageGuid(),"addColumn",a)}function GetJson(b){var a=null;$.ajax({url:rootPath+"Admin/GetJson/"+b,data:{viewName:b},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(c){a=c}});return a}function ShowJson(a,e){var c="<div>"+GetJson(e);c+='<br/><br/>Pyton Code:</br><div id="highlighter_590399" class="syntaxhighlighter nogutter syntaxhighlighter python"><table border="0" cellpadding="0" cellspacing="0"><tbody><tr><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">import</code> <code class="python plain">json,httplib</code></div><div class="line number2 index1 alt1"><code class="python plain">connection </code><code class="python keyword">=</code> <code class="python plain">httplib.HTTPSConnection(</code><code class="python string">\'api.backand.com\'</code><code class="python plain">, </code><code class="python value">443</code><code class="python plain">)</code></div><div class="line number3 index2 alt2"><code class="python plain">connection.connect()</code></div><div class="line number4 index3 alt1"><code class="python plain">connection.request(</code><code class="python string">\'PUT\'</code><code class="python plain">, </code><code class="python string">\'/1/classes/GameScore/Ed1nuqPvcm\'</code><code class="python plain">, json.dumps({</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"score"</code><code class="python plain">: </code><code class="python value">73453</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">}), {</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"X-backand-Application-Id"</code><code class="python plain">: </code><code class="python string">"<span class="application_id">${APPLICATION_ID}</span>"</code><code class="python plain">,</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"X-backand-REST-API-Key"</code><code class="python plain">: </code><code class="python string">"<span class="rest_api_key">${REST_API_KEY}</span>"</code><code class="python plain">,</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"Content-Type"</code><code class="python plain">: </code><code class="python string">"application/json"</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">})</code></div><div class="line number11 index10 alt2"><code class="python plain">result </code><code class="python keyword">=</code> <code class="python plain">json.loads(connection.getresponse().read())</code></div><div class="line number12 index11 alt1"><code class="python functions">print</code> <code class="python plain">result</code></div></div></td></tr></tbody></table></div></div>';var b=$(c);var d="Json Code";FloatingDialog.Open(b,d,true,a);b.dialog("option","height","auto");b.dialog("option","width","700");b.dialog("option","resizable",true);hideProgress()}function d_doAction(x,b,G,M){if(!x){x=getMainPageGuid()}if(LoadingApplicationData){return}var p=$("#"+x+"ajaxDiv");var a=EditDialog.AllowEdit(x,r);var m=views[x].ViewName;switch(b){case"editValue":if(!M.guid){M.guid=getMainPageGuid()}if(!M.pk){M.pk=Multi.GetSingleSelection(x)}if(!M.viewName){M.viewName=getMainViewName()}editValue(M.viewName,M.fieldName,M.value,M.pk,M.guid);if(M.refresh){refreshView(M.guid)}if(G){G(M)}break;case"json":ShowJson(x,m);break;case"edit":var O=Multi.GetSelection(x);if(O.length==1){var r=O[0];var z=views[x].Popup;var B=views[x].Mobile;var j=views[x].EditItemUrl+"&pk="+(r+"");d_edit(r,z,B,j,m,x,p)}else{if(O.length>1){EditDialog.OpenSelection(x,false)}else{modalErrorMsg("Please select a row")}}break;case"paint":var O=Multi.GetSelection(x);if(O.length==0){modalErrorMsg("Please select a row");return}begin();try{var F=GetJsonViewForEdit(x);var Q=getFieldJson(views[x].RowColorColumnName,F);var j=views[x].EditOnlyUrl;var A=$("#color_input").val().toLowerCase();if(!A){A=""}var g;for(var N=0;N<O.length;N++){r=O[N];Q.Fields[0].Value.Value=A;g=$.ajax({async:false,type:"POST",url:j,data:{guid:x,pk:r,jsonView:Sys.Serialization.JavaScriptSerializer.serialize(Q),guid:x}}).responseText;if(g!='"success"'){ajaxNotSuccessMsg("Changes did not saved: "+g)}else{$("#d_row_"+x+r).attr("class",A)}}hideProgress()}catch(J){hideProgress();modalErrorMsg(J.description)}break;case"add":var z=views[x].Popup;var B=views[x].Mobile;var j=views[x].AddItemUrl;d_addNew(null,z,B,j,m,x,p,!a.disabled,"",false);break;case"duplicate":var O=Multi.GetSelection(x);if(O.length==1){var r=O[0];var z=views[x].Popup;var B=views[x].Mobile;var q=views[x].DuplicateItemUrl+"&pk="+(r+"");var K=views[x].EditItemUrl+"&pk="+(r+"");var C=views[x].DuplicationMethod;var o=views[x].DuplicateMessage;d_Duplicate(r,z,B,q,K,m,x,p,C,o)}else{if(O.length>1){ajaxNotSuccessMsg("Please select only one row")}else{ajaxNotSuccessMsg("Please select a row")}}break;case"insert":var O=Multi.GetSelection(x);if(O.length==1){var r=O[0];var z=views[x].Popup;var B=views[x].Mobile;var j=views[x].InsertItemUrl;d_addNew(null,z,B,j,m,x,p,!a.disabled,(r+""),false)}else{if(O.length>1){ajaxNotSuccessMsg("Please select only one row")}else{ajaxNotSuccessMsg("Please select a row")}}break;case"delete":var O=Multi.GetSelection(x);if(O.length==1){var r=O[0];DeleteDialog.Open(r,x)}else{if(O.length>1){DeleteDialog.OpenSelection(x)}else{ajaxNotSuccessMsg("Please select a row")}}break;case"history":var O=Multi.GetSelection(x);if(O.length==1){var k=rootPath+"History/HistoryFilter/durados_v_ChangeHistory";historyGuidID++;History(k,x,"history"+historyGuidID,m)}else{if(O.length>1){ajaxNotSuccessMsg("Please select only one row")}else{ajaxNotSuccessMsg("Please select a row")}}break;case"copy":copyPaste.copy();break;case"paste":copyPaste.paste();break;case"send":Send.Show(x);break;case"complete":var O=Multi.GetSelection(x);if(O.length==1){var r=O[0];var u=null;var s=rootPath+views[x].Controller+"/Step/"+views[x].gViewName;$.ajax({url:s,data:{viewName:m,pk:r,guid:x,noPrevDialog:true},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(w){u=w}});WorkFlow.CompleteStep(r,x,views[x].WorkFlowStepsFieldName,u,null)}else{ajaxNotSuccessMsg("Please select a row")}break;case"config":window.open(rootPath+"Admin/ConfigField/"+m+"?fieldName="+contextInfo[x].fieldName,contextInfo[x].fieldName);break;case"hide":var D=function(w){showProgress();var S=rootPath+"Admin/HideField/"+m+"?fieldName="+contextInfo[x].fieldName+"&hideInDialogs="+(w?"true":"false");$.ajax({url:S,contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(T){hideProgress();Durados.GridHandler.hideColumn(contextInfo[x].targetElement,x)}})};Durados.Dialogs.Confirm("Hide Column","Do you to hide it in the Add and Edit dialogs as well?",function(){D(true)},function(){D(false)});break;case"unhide":var P={viewName:m,fieldName:contextInfo[x].fieldName};selectField(m,contextInfo[x].fieldName,x,unhideFieldCallback,P,"HideInTable;True");break;case"open":var O=Multi.GetSelection(x);if(O.length==1){var r=O[0];var v=rootPath+"Admin/Open/"+m+"?pk="+r;window.open(v)}break;case"commit":showProgress();var j=rootPath+"Admin/RefreshConfig/";refreshConfig(j,x);fieldsDialog=null;hideProgress();break;case"before":movedColumnInfo[x]={elementToMove:contextInfo[x].targetElement,placement:"before"};Durados.GridHandler.setHeadersMoveToClass(x,"Left");break;case"after":movedColumnInfo[x]={elementToMove:contextInfo[x].targetElement,placement:"after"};Durados.GridHandler.setHeadersMoveToClass(x,"Right");break;case"left":var R=$(contextInfo[x].targetElement).prev();var y=R.attr("SortColumn");if(y){movedColumnInfo[x]={elementToMove:contextInfo[x].targetElement,placement:"before"};moveFieldTo(m,contextInfo[x].fieldName,true,x,y,rootPath+"Admin/MoveField2/"+m);Durados.GridHandler.moveColumn(x,R);movedColumnInfo={}}else{ajaxNotSuccessMsg("There is no left column.")}break;case"right":var R=$(contextInfo[x].targetElement).next();var y=R.attr("SortColumn");if(y){movedColumnInfo[x]={elementToMove:contextInfo[x].targetElement,placement:"after"};moveFieldTo(m,contextInfo[x].fieldName,false,x,y,rootPath+"Admin/MoveField2/"+m);Durados.GridHandler.moveColumn(x,R);movedColumnInfo={}}else{ajaxNotSuccessMsg("There is no right column.")}break;case"rename":renamedFieldInfo=contextInfo[x];renamedFieldInfo.guid=x;var c=renamedFieldInfo.targetElement;var L=c.find("A");if(!L.length){L=c.find("div")}L.css("visibility","hidden");var t=c.offset();var l=$("#reNameForm");if(!l.length){var l=$('<input id="reNameForm" type="text" />');$("body").append(l);l.blur(renameFieldCallBack);l.keydown(function(w){if(w.keyCode==$.ui.keyCode.ENTER){renameFieldCallBack()}})}l.val(L.text().trim());if($("body").attr("dir")!="rtl"){l.css({top:t.top+3,left:t.left+10,display:"inline"})}else{var H=c.width()+10;l.css({top:t.top+3,left:t.left-100+H,display:"inline"})}l.focus();l[0].select();break;case"saveAsDefaults":Durados.ColumnResizer.saveState(x,true);break;case"restoreDefaults":Durados.ColumnResizer.restoreState(x);break;case"addColumn":var d="/Admin/InlineAddingCreate/";var h=CreateDialog.CreateAndOpen("Field","Field",null,null,d,false,x,function(w,V,Y,U,S,T,X){var W=T.find("#"+S+"inlineAdding_DisplayName").val();W=ReplaceNonAlphaNumeric(W);if(Durados.Indications.fitToWindowWidth(S)){Durados.GridHandler.setNewColumnWidth(S,W)}if(G){G(W)}else{commitAndReload()}});var I=h.find('select[name="Fields_Parent"]');if(I.length>0){I.find("option").each(function(){var w=$(this);if(w.text()==m){I.val(w.attr("value"));return false}})}var f=I.parent("td:first");f.hide();f.prev().hide();break;case"properties":var e="/Admin/InlineEditingEdit/";var E=GetFieldPK(m,contextInfo[x].fieldName);if(E==null||E==""){ajaxNotSuccessMsg("Could not find the column.")}InlineEditingDialog.CreateAndOpen2("Field","Field",null,null,e,x,null,E,true,propertiesCallback,false);break;default:var O=Multi.GetSelection(x);$(Durados.View).trigger("anotherRowFunction",{guid:x,pks:O})}}var dock=null;function isViewPropertiesFloat(){return $.cookie("viewProperties")=="float"}function toggleViewProperties(e,d,g,c,h){var a=$("#d_viewProp");if(a.length){try{var b=a[0].contentWindow;if(b==null||b.Durados==null||b.Durados.DuringdLoadIframe){return}b.$("#DataRowEdit").dialog("close")}catch(f){return}}else{viewProperties(e,d,g,c,h)}}function mobileMenu(d){var a=$("#mainAppDiv");var c=$("#mobileMenuDiv");if(c.length>0){}else{c=$('<div id="mobileMenuDiv" style="width:'+($(window).width()*0.8)+"px; height:"+($(window).height()-a.offset().top)+'px; position:absolute; top:37px; z-index:1000; border:1px solid black;" class="mobile-settings-menu"></div>');$("body").prepend(c);var b=$(".mobileMenuContent");c.append(b);b.show(400);b.find(".mobile-settings-menu").mobileSettings({topTitle:d,beforeNavigationCallback:function(e){showProgress()}});return}if(c.is(":visible")){c.hide(400)}else{c.show(400)}}var nestableState=null;function pagesManager(d,c){var b=$("#mainAppDiv");$("#AppFilterTreeDiv").remove();b.attr("class","main_app_1_tree");var a=$('<div id="AppFilterTreeDiv" style="width:'+d+"px; background-color:White !important; height:"+($(window).height()-b.offset().top-16)+'px; " class="filter_tree dark-bg"></div>');a.append('<div id="loadSettings" class="loading"><div>'+translator.LoadingSettingsMessage+'</div><img src="/Content/Images/wait.gif" alt="'+translator.LoadingSettingsMessage+'" /></div>');b.before(a);if($("body").attr("dir")!="rtl"){b.css("margin-left",d+"px")}else{b.css("margin-right",d+"px")}$.ajax({url:c,contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(f){a.html(f);var e=$(".pages-manager");e.nestable({maxDepth:2}).on("change",function(){var h=window.JSON.stringify($(".pages-manager").nestable("serialize"));if(h!=nestableState){savePages(h)}});slider.InitSlider(null,2);$(".workspace-slider-container .anythingSlider-default").css("width","240px").css("height","50px");var g=$("#AppFilterTreeDiv").height()-260;$(".pages-manager-scroll").css("height",g+"px");a.find('input[name="Workspace"]').change(function(){changeWorkspace($(this).val(),a.find(".slider-active:first").attr("index"))});e.find(".dd3-content").mouseup(function(){selectPage($(this))});e.find(".dd3-settings").click(function(){pageSettings($(this))});selectFirstPage(e);$("#AppFilterTreeDiv .pages-done").click(function(){var j=getSelectedPage();var h=j.attr("url");var l=h.indexOf("?")>-1?"&":"?";var k=j.parent("li:first").attr("data-id");window.location=h+l+"menuId="+k});if(document.location.href.indexOf("/Admin/Pages")>-1){if(queryString("p")=="on"){openAddPageDialog()}}}});$(window).resize()}function getDefaultPageName(){var e=$(".pages-manager .page-name");var d="Page";var b="page";for(var a=1;a<1000;a++){var c=false;e.each(function(){var f=$(this).text().trim();if(f==b+a||f==d+a){c=true;return false}});if(!c){return d+a}}}function getSelectedPage(){var a=$(".pages-manager");return a.find(".dd3-selected")}function selectFirstPage(a){var d=a.find(".home-page-show:first");page=null;var c=queryString("menuId");if(c){page=a.find('li[data-id="'+c.replace("#","")+'"]:first').find(".dd3-content")}if(page&&page.length==1){selectPage(page)}else{if(d.length==1){page=d.parent();selectPage(page)}else{var b=a.find(".dd3-content:first");if(b.length==1){page=b;selectPage(page)}else{selectPage2(null,"/Home/Default?workspaceId="+getWorkspaceId(),true,"",{workspaceId:getWorkspaceId()})}}}}function changeWorkspace(b,a){showProgress();var c=$("#AppFilterTreeDiv");closePageSettings(c);if(pageSettingsDialog){pageSettingsDialog.dialog("destroy")}$.ajax({url:"/Admin/ChangeWorkspace/",data:{workspaceId:b},contentType:"application/json; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(f){try{if(!f.Failure){var d=$(".pages-manager-wrapper");d.html(f);var e=$(".pages-manager");e.nestable({maxDepth:2}).on("change",function(){var h=window.JSON.stringify($(".pages-manager").nestable("serialize"));if(h!=nestableState){savePages(h)}});var g=$("#AppFilterTreeDiv").height()-260;$(".pages-manager-scroll").css("height",g+"px");d.find(".dd3-content").mouseup(function(){selectPage($(this))});d.find(".dd3-settings").click(function(){pageSettings($(this))});GetWorkspaceMenu();if(a){$("#topMenu div.workspace").attr("class","workspace space-selected"+a);$(".workspace-slider-container .ui-slider-item-workspace").removeClass("workspace-slider-active");$(".workspace-slider-container .slider-active").removeClass("slider-active");$(".workspace-slider-container .workspace-selector.item"+a+":first").parent().addClass("workspace-slider-active");$("#topMenu div.workspace .w-text").text($(".workspace-slider-container .workspace-slider-active .w-text").text())}selectFirstPage(d)}else{reloadPage()}}catch(j){}finally{hideProgress()}}})}var selectedPage=null;function selectPage(e,d){if(e==selectedPage&&!d){return}var a=!d&&pageSettingsDialogOpen&&pageSettingsDialog!=null;var c=e.attr("url");var f=e.parents("li:first").attr("data-id");$("#settings a").attr("href",GetUrlWithSettings(c,"menuId="+f+"&settings=true"));$("#columns a").attr("href",GetUrlWithSettings(c,"menuId="+f+"&settings=fields"));selectPage2(e,c,e.find(".dd3-settings").attr("viewName")=="View",e.text(),{firstTime:true,guid:pageGuid});if(a){pageSettings(e.parents("li:first").find(".dd3-settings"))}}function selectPage2(h,d,e,k,g){var a="dd3-selected";var b="dd3-item-selected";if(h&&h.length==1){$(".pages-manager").find(".dd3-content").removeClass(a);$(".pages-manager").find("li").removeClass(b);h.addClass(a);h.parent("li:first").addClass(b);selectedPage=h}else{selectedPage=null}var f=$("#mainAppFrame");var j=d.indexOf("?")>-1?"&":"?";f.attr("src",d+j+"menu=off")}function getWorkspaceId(){return $("#xxPageXx_inlineEditing_Workspace").val()}function savePages(a){var b=getWorkspaceId();var c={workspaceId:b,json:a};$.post("/Admin/SavePages",c,function(d){if(d.Success){nestableState=a;GetWorkspaceMenu()}else{changeWorkspace(b);Durados.Dialogs.Alert("",d.Exception)}})}function toggleAddPageView(b,a){if(a=="Grid1"||a=="Grid2"||a=="Cards"||a=="Preview"){b.find(".add-page-create-view").show()}else{b.find(".add-page-create-view").hide()}}function toggleAddPageDasboard(b,a){if(a=="Charts"){b.find(".add-page-create-dashboard").show()}else{b.find(".add-page-create-dashboard").hide()}}function openAddPageDialog(){showProgress();$.ajax({url:"/Admin/AddPage",contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(a){try{$("<div></div>").appendTo("body").append(a).dialog({modal:true,title:"Add Page",zIndex:10000,autoOpen:true,width:"400px",height:"auto",position:["center","center"],resizable:false,close:function(){var c=$(this);c.remove();c.dialog("destroy")},open:function(){var g=$(this);var d=g.find("select.add-page-type").val();toggleAddPageView(g,d);toggleAddPageDasboard(g,d);g.find("select.add-page-type").change(function(){d=$(this).val();toggleAddPageView(g,d);toggleAddPageDasboard(g,d);var l=$(this)[0].selectedIndex;if(l==-1){g.find(".page-type-image").css("background-position","0 -70px")}else{l=l-1;if(l==-1){l=0}g.find(".page-type-image").css("background-position","-"+(170+l*110)+"px 0")}});var f=g.find("select.add-page-entity");f.change(function(){var o=$(this).val();try{var l=g.find(".add-page-name");if(!l.val()){var m=f.find('option[value="'+o+'"]').attr("displayName");l.val(m)}}catch(q){}var p=f.find('option[value="'+o+'"]').attr("isNewView")=="yes";if(p){g.find('[name="add-page-editable-table"],[for="add-page-editable-table"]').show()}});var e=g.find("[name=createView]");e.change(function(){var l=$(this).val();g.find('[name="add-page-editable-table"],[for="add-page-editable-table"]').hide();if(l=="0"){f.hide()}else{if(l=="1"){f.hide()}else{f.show()}}});var j=g.find("[name=createDashboard]");j.change(function(){var l=$(this).val();var m=g.find("select.add-page-dashboard");m.hide();if(l=="3"){m.hide()}else{m.show()}});var h=queryString("v");if(!h){h="2"}if(h!="2"){var c=g.find(".add-page-name");if(!c.val()){c.val(getDefaultPageName())}}if(h.charAt(h.length-1)=="#"){h=h.substr(0,h.length-1)}g.find("[value="+h+"]").prop("checked",true).change();g.find("#NewDashboard").prop("checked",true).change();var k=$(this).parent().find(".ui-dialog-buttonset").css("float","none");k.find("button:first").css("margin-left","10px");k.find("button:last").css("float","right")},buttons:{Cancel:function(){$(this).dialog("close")},Next:function(){addPage($(this))}}})}catch(b){}finally{hideProgress()}}})}function addPage(j){var a=$(".pages-manager");var e=j.find("select.add-page-entity").val();var d=j.find("[name=createView]").val();var b=j.find("input.add-page-name").val();var f=j.find("select.add-page-type").val();var k=b;var h=$("#NewTable").prop("checked")&&(f=="Grid1"||f=="Grid2"||f=="Cards"||f=="Preview");var g=$("#Excel").prop("checked")&&(f=="Grid1"||f=="Grid2"||f=="Cards"||f=="Preview");var l=j.find("select.add-page-entity").find('option[value="'+e+'"]').attr("isNewView")=="yes";var c=j.find("select.add-page-editable-table").val();if(c==-1){c=""}if(!f){Durados.Dialogs.Alert("Missing data","Please select Page Layout");return}if(!b){Durados.Dialogs.Alert("Missing data","Please Name your page");hideProgress();return}if(f=="Grid1"||f=="Grid2"||f=="Cards"||f=="Preview"){if($("#Select").prop("checked")){if(!e||e==-1){Durados.Dialogs.Alert("Missing data","Please select table");hideProgress();return}}else{if(!h&&!g){Durados.Dialogs.Alert("Missing data","Please Select one of the radio options");hideProgress();return}}}if(h&&!k){Durados.Dialogs.Alert("Missing data","Please enter Table Name");hideProgress();return}if(g){j.dialog("close");hideProgress();duradosImport("View",AddPageImportFromExcel,j,b);return}if(l&&(!c||c==-1||c=="")){Durados.Dialogs.Alert("Missing data","Please select Editable Table");hideProgress();return}if(f=="Charts"){if(!IsAddDashboardDataOK(j)){hideProgress();return}else{h=j.find("input[name=createDashboard]:checked").val()==3;e=j.find('select[name="add-page-dashboard"]').val()}}showProgress();CreatePage(selectedPage,a,f,e,h,g,b,c,j)}function IsAddDashboardDataOK(a){var b=a.find("input[name=createDashboard]:checked").val();var c=a.find('select[name="add-page-dashboard"]').val();if(b!=3&&b!=4){Durados.Dialogs.Alert("Missing data","Please select option");return false}if(b==4&&c==-1){Durados.Dialogs.Alert("Missing data","Please select Dashboard");return false}return true}function AddNewChartToDashboard(b){showProgress();var a={dashboardId:b};$.post("/Admin/AddChart",a,function(c){try{if(c.Success){}}catch(d){}finally{hideProgress()}})}function CreatePage(k,a,d,e,g,h,b,c,j){var f={viewName:e,workspace:getWorkspaceId(),isNew:g,isExcel:h,menuName:b,type:d,editableTable:c};$.post("/Admin/AddPage",f,function(o){try{if(o.Success){var m="page-type-"+o.LinkType;var l=$('<li class="dd-item dd3-item" data-id="'+o.id+'"><div class="dd-handle dd3-handle"></div><div class="dd3-content" url="'+o.Url+'"><span class="page-type '+m+'"></span><span class="page-name">'+b+'</span><span class="home-page"></span><span viewName="'+o.configViewName+'" pk="'+o.pk+'"  hideFromMenu="no" homepage="no" class="dd3-settings"></span></div></li>');if(k){k.parents("li:first").after(l)}else{a.find("ol.dd-list").prepend(l)}a.nestable({expandBtnHTML:'<button data-action="expand" type="button">Expand</button>',collapseBtnHTML:'<button data-action="collapse" type="button">Collapse</button>',maxDepth:2});var q=window.JSON.stringify($(".pages-manager").nestable("serialize"));savePages(q);var t=l.find(".dd3-content");t.mouseup(function(){selectPage($(this))});var p=l.find(".dd3-settings");p.click(function(){pageSettings($(this))});if(j){j.dialog("close")}t.mouseup();if(g||h){selectPage2(t,GetUrlWithSettings(o.Url,"settings=fields"),true,t.text());setTimeout(function(){newTebleIndication()},2000)}else{p.click()}}else{if(o.Exception){Durados.Dialogs.Alert("",o.Exception)}}}catch(r){}finally{hideProgress()}})}function newTebleIndication(){indication2("New Table","New Table","Add more column to the table by clicking the Add Column button",300,160,[160,180])}function indication2(f,e,d,c,b,a){indication1(f,e,$('<div style="position:relative"><table width="100%"><tr><td align="middle" width="50%"><img src="/Content/Images/arrow-up.png"></td><td align="middle" width="50%"><img src="/Content/Images/arrow-up.png"></td></tr><tr><td colspan=2><span class="indication-msg" style="font-size: 18px;color: green;">'+d+'</span></td></tr><tr><td colspan=2><input type="checkbox" /><span>do not show me that again</span></td></tr></table></div>'),c,b,a)}function indication1(f,d,e,c,b,a){if(!$.cookie(f)){e.dialog({title:d,modal:false,open:function(){var g=$(this);g.parent().css("opacity",0.9);g.parent().css("background-color","#C5C5C5");g.css("background-color","#C5C5C5");g.find("input").click(function(){$.cookie(f,true,10000)});$("body").click(function(){g.dialog("close")})},width:c,height:b,position:a,create:function(g,h){$(".ui-widget-header").hide()},resizable:false,draggable:false})}}function designTable(a){$('<div><iframe width="100%" height="100%" style="border:none" src="'+a+'"></iframe></div>').appendTo("body").append(html).dialog({modal:true,title:"Design Table",zIndex:10000,autoOpen:true,width:"auto",height:"auto",position:["center","center"],resizable:false,open:function(){var b=$(this)},buttons:{Finish:function(){$(this).dialog("close")}}})}function AddPageImportFromExcel(g,j){var a=$(".pages-manager");var c=j;var b=g.find("input.add-page-name").val();var d=g.find("select.add-page-type").val();var h=b;var f=c=="0";var e=true;CreatePage(selectedPage,a,d,c,f,e,b)}var pageGuid="xxPageXx_";function closePageSettings(a){a.css("width",250);$("#mainAppDiv").css("margin-left",250);$(window).resize();pageSettingsDialogOpen=false;pageWasOpen=false}var prevMenuName="";var pageSettingsDialog=null;var pageSettingsDialogOpen=false;function pageSettings(f){var b=$("#AppFilterTreeDiv");if(!pageSettingsDialogOpen){b.css("width",500);$("#mainAppDiv").css("margin-left",500);$(window).resize();pageSettingsDialogOpen=true}if(pageSettingsDialog){pageSettingsDialog.dialog("destroy")}if(!views[pageGuid]){views[pageGuid]=new Durados.View(pageGuid)}views[pageGuid].gInlineEditingDialogUrl="/Admin/GetPageSettings/";views[pageGuid].gGetJsonViewInlineEditingUrl="/Home/GetJsonView/";var k=f.attr("viewName");if(!k){k="MyCharts"}var c=f.attr("pk");var l="/Admin/InlineEditingEdit/";pageSettingsDialog=InlineEditingDialog.CreateAndOpen2(k,"Page "+translator.Settings,null,null,l,pageGuid,null,c,true,null,false,function(){selectPage(f.parent(),true)},function(){closePageSettings(b)});pageSettingsDialog.dialog("option","height",$("#AppFilterTreeDiv").height()-15);pageSettingsDialog.dialog("option","width",250);pageSettingsDialog.dialog("option","draggable",false);pageSettingsDialog.dialog("option","resizable",false);var j=pageSettingsDialog.find('[name="PageName"]');var g=pageSettingsDialog.find('[name="HideFromMenu"]');var h=pageSettingsDialog.find('[name="Homepage"]');pageSettingsDialog.find(".page-settings-done").click(function(){pageSettingsDialog.dialog("close")});j.val($.trim(selectedPage.text()));Durados.CheckBox.SetChecked(g,selectedPage.find(".dd3-settings").attr("hideFromMenu")=="yes");Durados.CheckBox.SetChecked(h,selectedPage.find(".dd3-settings").attr("homepage")=="yes");prevMenuName=j.val();j.blur(function(){var m=$(this).val();if(m!=prevMenuName){data={workspaceId:getWorkspaceId(),menuId:selectedPage.parents("li:first").attr("data-id"),name:m};$.post("/Admin/ChangePageName",data,function(o){if(o.Success){selectedPage.find(".page-name").text(m);j.val(m);prevMenuName=m;GetWorkspaceMenu()}else{j.val(prevMenuName);Durados.Dialogs.Alert("",o.Exception)}})}});g.change(function(){var m=Durados.CheckBox.IsChecked($(this));var o=Durados.CheckBox.IsChecked(h);if(o&&m){Durados.Dialogs.Alert("","Cannot hide Homepage from menu");Durados.CheckBox.SetChecked($(this),false);return false}data={workspaceId:getWorkspaceId(),menuId:selectedPage.parents("li:first").attr("data-id"),hideFromMenu:m};$.post("/Admin/ChangeHideFromMenu",data,function(p){if(p.Success){if(m){selectedPage.addClass("hide-from-menu")}else{selectedPage.removeClass("hide-from-menu")}GetWorkspaceMenu()}else{Durados.Dialogs.Alert("",p.Exception)}})});h.change(function(){var o=Durados.CheckBox.IsChecked($(this));var m=Durados.CheckBox.IsChecked(g);if(o&&m){Durados.Dialogs.Alert("","Cannot hide Homepage from menu");Durados.CheckBox.SetChecked($(this),false);return false}data={workspaceId:getWorkspaceId(),menuId:selectedPage.parents("li:first").attr("data-id"),homepage:o};$.post("/Admin/ChangeHomepage",data,function(p){if(p.Success){var q=$(".pages-manager");q.find(".home-page").removeClass("home-page-show");q.find(".dd3-settings").attr("homepage","no");if(o){selectedPage.find(".home-page").addClass("home-page-show");selectedPage.find(".dd3-settings").attr("homepage","yes")}else{selectedPage.find(".home-page").removeClass("home-page-show")}}else{Durados.Dialogs.Alert("",p.Exception)}})});pageSettingsDialog.find(".page-settings-delete").click(function(){Durados.Dialogs.Confirm("Delete Page","Are you sure that you want to delete this page?",function(){var m=selectedPage.parents("li:first").attr("data-id");data={workspaceId:getWorkspaceId(),menuId:m};$.post("/Admin/DeletePage",data,function(p){if(p.Success){var o=getPrevPage(selectedPage);if(!o||o.length==0){o=getNextPage(selectedPage)}if(!o||o.length==0){var q=$("#mainAppFrame");q.attr("src","");pageSettingsDialog.dialog("close");closePageSettings(b);selectedPage=null}else{selectPage(o)}f.parents("li:first").remove();GetWorkspaceMenu()}else{Durados.Dialogs.Alert("",p.Exception);changeWorkspace(getWorkspaceId())}})})});var d=f.attr("viewName");var e=f.parents("li:first").attr("data-id");if(k=="View"){var a=f.parent("div").attr("url");pageSettingsDialog.find(".page-settings-advanced").click(function(){reloadWithSettings(a,"menuId="+e+"&settings=true")});pageSettingsDialog.find(".page-settings-fields").click(function(){reloadWithSettings(a,"menuId="+e+"&settings=fields")})}else{if(k=="Page"){pageSettingsDialog.find(".url").blur(function(){var m=$(this);var o=m.attr("value");InlineEditingDialog.UpdatePreview(null,c,m.attr("name"),o,pageGuid,"/Admin/PreviewEdit/Page/","Page",pageSettingsDialog,function(){selectPage(f.parent(),true)})})}}}function getNextPage(c){var b=c.parents("li.dd-item:first");if(b.length==0){return null}var a=b.next();if(a.length>0){return a.find(".dd3-content:first")}return null}function getPrevPage(d){var c=d.parents("li.dd-item:first");if(c.length==0){return null}var b=c.prev();if(b.length>0){return b.find(".dd3-content:first")}var a=c.parents("li.dd-item:first");if(a.length==0){return null}return a.find(".dd3-content:first")}function reloadWithSettings(b,a){b=b.replace("/Index/","/IndexPage/");var d=b.indexOf("?")>-1?"&":"?";window.location.href=b+d+a}function GetUrlWithSettings(b,a){b=b.replace("/Index/","/IndexPage/");var d=b.indexOf("?")>-1?"&":"?";return b+d+a}function viewProperties(j,g,b,a,e){if(dock==null){dock={width:b,url:a,viewDisplayName:e}}if(g){showProgress();setTimeout(function(){var m="/Admin/InlineEditingEdit/";var l=views[j].ViewName;var k=GetViewPK(l);if(k==null||k==""){ajaxNotSuccessMsg("Could not find the column.")}InlineEditingDialog.CreateAndOpen2("View",e+" "+translator.Settings,null,null,m,j,null,k,true,propertiesCallback,false);hideProgress();$.cookie("viewProperties","float",{expires:1000})},10)}else{var d=$("#mainAppDiv");$("#AppFilterTreeDiv").remove();d.attr("class","main_app_1_tree");var h=$('<div id="AppFilterTreeDiv" style="width:'+b+"px; height:"+($(window).height()-d.offset().top-16)+'px; " class="filter_tree dark-bg"></div>');h.append('<div id="loadSettings" class="loading"><div>'+translator.LoadingSettingsMessage+'</div><img src="/Content/Images/wait.gif" alt="'+translator.LoadingSettingsMessage+'" /></div>');d.before(h);if($("body").attr("dir")!="rtl"){d.css("margin-left",b+"px")}else{d.css("margin-right",b+"px")}var c=$('<iframe id="d_viewProp" name="viewProp" width="'+(b-2)+'" frameborder="0" style="margin-top:3px; display: none;"></iframe>');h.append(c);c.height((h.height()-8));try{c.attr("src",a)}catch(f){bbb}$(window).resize(function(){viewDivResize(h,d,c)});$(window).resize();$.cookie("viewProperties","",{expires:1000})}}function viewDivResize(b,a,c){b.height(($(window).height()-a.offset().top-16));c.height((b.height()-8))}function closeViewProperties(){var b=$("#mainAppDiv");var a=$("#AppFilterTreeDiv");var c=b.children().first().attr("guid");a.remove();b.removeAttr("class");if($("body").attr("dir")!="rtl"){b.css("margin-left",0)}else{b.css("margin-right",0)}$(window).resize()}function propertiesCallback(){showProgress();commitAndReload()}function commitAndReload(){var a=rootPath+"Admin/RefreshConfig/";refreshConfig(a,null,true);reloadPage()}function reloadPage(c,a){if(c){var d=window.location.href;if(d.charAt(d.length-1)=="#"){d=d.substr(0,d.length-1)}if(a){d=d.replace("&settings=true","");d=d.replace("&settings=fields","")}d=d+c;window.location.href=d;if(a){return}}location.reload()}function GetFieldPK(b,c){var a=null;$.ajax({url:rootPath+"Admin/GetFieldPK/"+b,data:{viewName:b,fieldName:c},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(d){a=d}});return a}function GetViewPK(b){var a=null;$.ajax({url:rootPath+"Admin/GetViewPK/"+b,data:{viewName:b},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(c){a=c}});return a}function renameFieldCallBack(){if(!renamedFieldInfo){return}var b,d,h;b=renamedFieldInfo.guid;d=renamedFieldInfo.targetElement;h=renamedFieldInfo.fieldName;if(!b||!d||!h){return}var a=$("#reNameForm");var g=d.find("A");if(!g.length){g=d.find("div")}var f=g.text().trim();var c=a.val().trim();if(f!=c){showProgress();var e=views[b].ViewName;$.ajax({url:rootPath+"Admin/RenameField/"+e,data:{viewName:e,fieldName:h,NewDisplayName:c},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler});g.text(c);hideProgress()}a.hide();g.css("visibility","visible");renamedFieldInfo={}}function resetRenamedField(){if(!renamedFieldInfo){return}var a=$("#reNameForm");if(a.css("display")!="inline"){return}var b=renamedFieldInfo.targetElement;var c=b.find("A");if(!c.length){c=b.find("div")}a.hide();c.css("visibility","visible");renamedFieldInfo={}}function selectField(e,f,a,d,c,b){if(fieldsDialog){showProgress();setTimeout(function(){fieldsDialog.dialog("open");hideProgress()},1)}else{showProgress();setTimeout(function(){var g=rootPath+"Admin/Fields/"+e+"?viewName="+e+"&filter="+b;fieldsDialog=SearchDialog.CreateAndOpen(e,"Select Column","","",g,a,null,null,d,c);hideProgress()},10)}}function unhideFieldCallback(f,b,c,a,e,g,d){if(b.length==1){unhideField(views[c].ViewName,contextInfo[c].fieldName,c,b[0],rootPath+"Admin/UnhideField/"+views[c].ViewName)}}function unhideField(d,e,b,c,a){showProgress();$.ajax({url:a,data:{viewName:d,fieldName:e,guid:b,pk:c},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(g){var f=rootPath+"Admin/RefreshConfig/";refreshConfig(f,b);fieldsDialog=null;hideProgress()}})}function moveFieldTo(d,f,c,b,e,a){showProgress();$.ajax({url:a,data:{viewName:d,fieldName:f,before:c,guid:b,to:e},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(g){hideProgress()}})}var FloatingDialog;if(!FloatingDialog){FloatingDialog=function(){}}FloatingDialog.Show=function(a,f,c,g,e,h,k,b,j,d){div=$("<div class='FloatingDialogDiv'>");$("body").prepend(div);if(a!=null&&a!=""){if(h){FloatingDialog.CreatePost(a,c,e,div,k,b,j)}else{div.html(FloatingDialog.Create(a,c));if(g==null){g=false}}}FloatingDialog.Open(div,f,g,e,b,j,d);return div};FloatingDialog.Create=function(a,c){var b="";if(c==null){c={}}$.ajax({url:a,contentType:"application/html; charset=utf-8",data:c,async:false,cache:false,error:ajaxErrorsHandler,success:function(e){hideProgress();var d=e.indexOf("$$error$$",0);if(d<0||d>1000){b=e}else{ajaxNotSuccessMsg(e)}}});return b};FloatingDialog.CreatePost=function(b,c,a,e,d){if(c==null){c={}}$.post(b,c,function(g){var f=g.indexOf("$$error$$",0);if(f<0||f>1000){e.html(g);if(e.attr("adding")=="hide"){e.find("a").slice(0,2).each(function(){$(this).hide();$(this).next("span").hide()})}initDataTableView(a);if(d){d(a,e)}hideProgress()}else{hideProgress();ajaxNotSuccessMsg(g)}})};FloatingDialog.Open=function(g,j,k,h,b,l,f){showProgress();var c=$(window).width();var e=$(window).height();if(!b){b=c*0.75}if(!l){l=e*0.75}if(!f){f="center"}g.attr("guid",h);currentViewName="float";var d=Rectangle.Load("float");if(d!=null){g.dialog({bgiframe:true,autoOpen:false,position:[d.left,d.top],width:d.width,height:d.height,title:j,modal:k,resizeStop:SaveFloatDialogOnResize,zIndex:100000,dragStop:SaveFloatDialogOnDrag,open:function(m,p){var o=$.cookie("state_"+currentViewName);if(o=="max"||IE7){dialogExt.max(g,null,h)}currentDialog=g}})}else{g.dialog({bgiframe:true,autoOpen:false,width:b,height:l,title:j,modal:k,position:f,resizeStop:SaveFloatDialogOnResize,zIndex:100000,dragStop:SaveFloatDialogOnDrag,open:function(m,p){var o=$.cookie("state_"+currentViewName);if(o=="max"||IE7){dialogExt.max(g,null,h)}currentDialog=g}})}dialogExt.initMaxButton(g,h);var a=$.cookie("state_"+currentViewName);if(a!="max"){if(d!=null){g.dialog("option","position",[d.left,d.top])}}g.dialog({show:{effect:"fold",duration:500},hide:{effect:"fold",duration:500}});g.dialog("open");FloatingDialog.TheDialog=g};function loadFilterParameters(e,d,b){var c=$(e).parents("form:first");var a=d;c.find("input").each(function(){var f=$(this);var g=f.attr("name");var h=f.val();if(f.attr("class")=="Autocomplete"){h=GetAutoCompleteValueId(f)}if(g!=null&&g!=""){a=a.replace("$"+g,h)}});c.find("select").each(function(){var f=$(this);var g=f.attr("name");var h=f.val();if(g!=null&&g!=""){a=a.replace("$"+g,h)}});return a}var SearchDialog;if(!SearchDialog){SearchDialog=function(){}}SearchDialog.GetButtons=function(b,a,d,h,c,g,f){var e={};e[translator.select]=function(){SearchDialog.Select(b,a,d,h,c,g,f)};e[translator.cancel]=function(){c.dialog("close")};e[translator.select]=function(){SearchDialog.Select(b,a,d,h,c,g,f)};return e};var searchGuidPostfix=0;SearchDialog.CreateAndOpen=function(h,j,f,b,d,g,e,a,k,c){begin();setTimeout(function(){SearchDialog.CreateAndOpen2(h,j,f,b,d,g,e,a,k,c)},10)};SearchDialog.CreateAndOpen2=function(m,o,k,b,e,l,h,a,p,d){searchGuidPostfix++;searchGuid=l+searchGuidPostfix;var f="";if(a&&a!=""){f="&d_filter="+loadFilterParameters(h,a,l)}var g=FloatingDialog.Show(e+"&guid="+searchGuid+f+"&checkbox=true","Search "+o,null,true);var j=SearchDialog.GetButtons(l,searchGuid,k,b,g,p,d);g.dialog("option","buttons",j);initDataTableView(searchGuid);var c=k=="CheckList";views[searchGuid].MultiSelect=c;return g};SearchDialog.Select=function(g,h,f,a,e,p,c){var b=Multi.GetSelection(h);if(!b.length){ajaxNotSuccessMsg("Please select a row(s)");return}if(f=="DropDown"){var k=$("#"+a);k.val(b[0]);k.change();var d={guid:g,pk:b[0],fieldName:k.attr("name")};$(SearchDialog).trigger("afterSearchSelected",d)}else{if(f=="Autocomplete"){var l=b[0];var o=displayValues[h];if(o!=null){var j=$("#"+a);j.val(o);j.attr("valueId",l);var d={guid:g,pk:l,fieldName:j.attr("name")};$(SearchDialog).trigger("afterSearchSelected",d);j.focus()}}else{if(f=="CheckList"){var k=$("#"+a);var m=k.val();if(m==null){m=[]}$(b).each(function(){m.push(String(this))});k.val(m);k.dropdownchecklist("refresh")}else{if(p){p(c,b,g,h,f,a,e)}}}}e.dialog("close")};function reorder(g,e,c,b){var h=Multi.GetSelection(g);if(h.length==0){ajaxNotSuccessMsg("Please select a row");return}if(h.length>1){ajaxNotSuccessMsg("Please select only one row");return}var a=h[0];var f=$("#d_row_"+g+a);var d=null;if(e=="up"){d=f.prev();if(d.length==1&&d.attr("d_row")=="d_row"){f.insertBefore(d);var j=d.attr("d_pk");reorderOnServer(g,a,j,c,b)}}else{if(e=="down"){d=f.next();if(d.length==1&&d.attr("d_row")=="d_row"){f.insertAfter(d);var j=d.attr("d_pk");reorderOnServer(g,a,j,c,b)}}}return false}function reorderOnServer(b,d,c,e,a){$.ajax({url:a,contentType:"application/html; charset=utf-8",data:{o_pk:d,d_pk:c,guid:b},async:true,cache:false,error:ajaxErrorsHandler,success:function(g){var f=views[b].DataDisplayType;if(f=="Table"){if(g=="success"){refreshView(b);loadMainMenu(b)}else{ajaxNotSuccessMsg(g)}}}})}var Excel;if(!Excel){Excel=function(){}}Excel.Import=function(l,j,f,g,b,k){var h=d_Dialog.CreateAndOpen(l,j,"durados_Import","Import");var m=$(d_Dialog).find('select[name="ImportMode"]');var a=0;try{if(j!=null&&views[j]!=null){m.find("option").each(function(){switch($(this).val()){case"1":if(!views[j].AllowCreate){$(this).remove();a++}break;case"2":if(!views[j].AllowEdit){$(this).remove();a++}break;case"3":if(!views[j].AllowCreate||!views[j].AllowEdit){$(this).remove();a++}break}})}}catch(e){}if(a==3){m.parent("td").hide();m.parent("td").prev().hide()}else{m.parent("td").show();m.parent("td").prev().show()}if($(d_Dialog).data("events").PerformMethod){$(d_Dialog).unbind("PerformMethod")}$(d_Dialog).bind("PerformMethod",function(v,t){var s=t.dialog.find("#"+j+inlineAddingPrefix+"FileName").val();var q="";var y=t.dialog.find("#"+j+inlineAddingPrefix+"SheetName");if(y.length==1){q=y.val()}var d=true;var u=t.dialog.find("#"+j+inlineAddingPrefix+"WriteErrors");if(u.length==1){d=Durados.CheckBox.IsChecked(u)}var z=true;var w=t.dialog.find("#"+j+inlineAddingPrefix+"RollBackOnError");if(w.length==1){z=Durados.CheckBox.IsChecked(w)}var x=4;var p=t.dialog.find("#"+j+inlineAddingPrefix+"ImportMode");if(p.length==1){x=parseInt(p.val())}if(s==""){ajaxNotSuccessMsg("Please upload excel file");return}if(!x&&a<3){ajaxNotSuccessMsg("Please select import mode");return}if(!x){x=1}var r=t.dialog.find("input:radio[name=importType]:checked").val();showProgress();var o=rootPath+(views[j]==null?"Admin":views[j].Controller)+"/Import/"+l;$.post(o,{fileName:s,sheetName:q,writeErrors:d,rollBackOnError:z,ImportModeIndex:x,importType:r,pageName:k},function(A){hideProgress();if(!A.success){Durados.Dialogs.Alert("Import Finished",A.message)}else{if(g){g(b,A.viewName)}Durados.Dialogs.Alert("Import Finished",A.message,function(){if(!A.hasErrors){t.dialog.dialog("close")}});refreshMainContent()}})});$(d_Dialog).find("div[name=ImportAddTemplate] a").attr("href","/Home/ExportToCsv/"+l+"?guid="+j+"&NoData=true");$(d_Dialog).find("div[name=ImportEditTemplate] a").attr("href","/Home/ExportToCsv/"+l+"?guid="+j+"&NoData=false");var c=j==null||views[j]==null?true:views[j].Role=="View Owner";f=f==null?false:f;if(c){$(d_Dialog).find("div[name=ImportEditTemplate]").hide()}if(c&&!f){$(d_Dialog).find("div[name=importTypeDiv]").hide()}hideProgress()};var d_Dialog;if(!d_Dialog){d_Dialog=function(){}}d_Dialog.CreateAndOpen=function(h,e,a,g){showProgress();var d=CreateDialog.Create(a,e);var c;var j=e+h+a;c=$("#"+j);if(c.length==0){c=$("<div>");c.attr("id",j);$("body").prepend(c)}c.html(d);var b=false;if(e){b=views[e].TabCache=="True"}var f=c.find("#"+e+"InlineAddingTabs");f.tabs({fx:{opacity:"toggle",duration:"fast"},cache:b,ajaxOptions:{cache:false,async:false}});disableChildrenTabs(f);d_Dialog.Open(h,e,a,c,g);if(e){complete(e);initDropdownChecklistsCreate(e)}return c};d_Dialog.Open=function(h,f,a,e,g){var b=$(window).width();var d=$(window).height();currentViewName=a;var c=Rectangle.Load(currentViewName);if(c!=null){e.dialog({bgiframe:true,autoOpen:false,position:[c.left,c.top],width:c.width,height:c.height,modal:true,close:CreateDialog.CloseEvent,resizeStop:SaveDialogOnResize,zIndex:10000,dragStop:SaveDialogOnDrag})}else{e.dialog({bgiframe:true,autoOpen:false,width:(b*0.75),modal:true,close:CreateDialog.CloseEvent,position:"center",resizeStop:SaveDialogOnResize,zIndex:10000,dragStop:SaveDialogOnDrag})}e.dialog("option","title",g);e.dialog("option","buttons",{Run:function(){d_Dialog.PerformMethod(h,f,e)},Close:function(){CreateDialog.Close(e,f)}});showProgress();json=GetJsonViewForInlineAdding(a,f);if(f){var j=views[f].gViewName;views[f].gViewName=a;AddDialog.SetDefaults(json,inlineAddingPrefix,f);views[f].gViewName=j}else{AddDialog.SetDefaults(json,inlineAddingPrefix,"null")}if(c!=null){e.dialog("option","position",[c.left,c.top])}if(f){InitValidation(f,inlineAddingPrefix,json)}e.dialog({show:{effect:"fold",duration:500},hide:{effect:"fold",duration:500}});e.dialog("open");hideProgress()};d_Dialog.PerformMethod=function(c,a,b){$(d_Dialog).trigger("PerformMethod",{viewName:c,guid:a,dialog:b})};function showCopyDialog(e,d){var c=$(window).width();var b=$(window).height();var f=$("#copyConfigDialog");f.dialog({bgiframe:true,autoOpen:false,position:"center",width:(c*0.75),modal:true,close:CreateDialog.CloseEvent,position:"center",resizeStop:SaveDialogOnResize,zIndex:10000,dragStop:SaveDialogOnDrag});f.dialog("option","title","Copy Cnfiguration");f.dialog("option","buttons",{OK:function(){copyConfig(e,d,f)},Cancel:function(){f.dialog("close")}});f.dialog("open")}function copyConfig(d,c,f){var b=$("#sourceView").val();var e=$("#destView").val();if(b==null||b==""){ajaxNotSuccessMsg("Please enter source view.");return}if(e==null||e==""){ajaxNotSuccessMsg("Please enter destination view.");return}$.ajax({url:gVD+"Durados/Copy/"+e,contentType:"application/json; charset=utf-8",data:{templateView:b},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(a){modalSuccessMsg(a);f.dialog("close")}})}function showCloneDialog(c){var b=$(window).width();var a=$(window).height();var d=$("#cloneViewDialog");d.dialog({bgiframe:true,autoOpen:false,position:"center",width:(b*0.75),modal:true,close:CreateDialog.CloseEvent,position:"center",resizeStop:SaveDialogOnResize,zIndex:10000,dragStop:SaveDialogOnDrag});d.dialog("option","title","Clone View");d.dialog("option","buttons",{OK:function(){cloneView(c,d)},Cancel:function(){d.dialog("close")}});d.dialog("open")}function cloneView(b,c){var a=$("#baseViewName").val();var d=$("#clonedViewName").val();if(a==null||a==""){modalErrorMsg("Please enter base view.");return}if(d==null||d==""){modalErrorMsg("Please enter the cloned view name.");return}$.ajax({url:gVD+"Durados/Clone/"+a,contentType:"application/json; charset=utf-8",data:{clonedViewName:d},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(e){alert(e);c.dialog("close")}})}function refreshConfig(c,b,d){var a=$("#"+b+"ajaxDiv").find('select[name="d_fieldOrder"]').val();$.ajax({url:c,contentType:"application/json; charset=utf-8",data:{fieldOrder:a},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(e){if(d){return}refreshConfigSuccess(b,a);modalSuccessMsg(e)}})}function refreshConfigSuccess(b,a){$.post(views[b].gIndexUrl,{SortColumn:a,direction:"Asc",guid:b},function(d){hideProgress();var c=d.indexOf("$$error$$",0);if(c<0||c>1000){FilterForm.HandleSuccess(d,false,b,null);prevSortedColumn=a;prevSortedDirection="Asc";InitChangeFieldOrder(b)}else{ajaxNotSuccessMsg(d,b)}})}function copyOrder(b,a){var c=Multi.GetSelection(a);if(c.length==0){ajaxNotSuccessMsg("Please select a row");return}$.ajax({url:b,contentType:"application/json; charset=utf-8",data:{fieldPK:c[0],guid:a},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(d){modalSuccessMsg(d)}})}function repairOrder(b,a){var c=Multi.GetSelection(a);if(c.length==0){ajaxNotSuccessMsg("Please select a row");return}$.ajax({url:b,contentType:"application/json; charset=utf-8",data:{viewName:"View",pk:c[0],guid:a},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(d){modalSuccessMsg(d)}})}function runReport(b,c){if(!AddDialog.isValid(b,c)){return}showProgress();var a;a=FillJson(GetJsonFilter(b),createPrefix,b);$.post(views[b].gFilterUrl,{jsonFilter:Sys.Serialization.JavaScriptSerializer.serialize(a),guid:b,search:"",mainPage:views[b].mainPage},function(e){hideProgress();var d=e.indexOf("$$error start$$",0);if(d<0||d>100000){FilterForm.HandleSuccess(e,false,b,null)}else{var f=e.indexOf("$$error end$$",0);ajaxNotSuccessMsg(e.substring(d+15,f),b)}})}var historyGuidID=0;var currentHistoryJson=null;function History(c,b,e,f){var a=Multi.GetSelection(b);if(a.length>1){modalErrorMsg("Please select only one row");return}historyGuidID++;e=e+historyGuidID;var d=getHistoryFilter(c,b,f);currentHistoryJson=d;FloatingDialog.Show(c,"History Log",{jsonFilter:Sys.Serialization.JavaScriptSerializer.serialize(d),guid:e},true,e,true)}function menuOrganizer(a,c){try{FloatingDialog.Show(a,c+" - Assign Views",null,true,"menuOrganizer_guid_",true,function(k,j){var q=j.find("div.fixedViewPort").first();var m=$("<div></div>");var o=$('<a href="#"><span class="menu-popup">Organize Menus</span></a>');o.click(function(){var s="/Admin/IndexPage/Menu?guid=Menu_c20_&mainPage=True&menu=off";FloatingDialog.Show(s,c+" - Organize Menus",null,true,"menu_guid_",true,null,800,"auto");return false});m.append(o);q.prepend(m);var r=q.find("table:first");var g=r.find('tr[d_row="d_row"]:first');if(g.length==0){return}var f=g.children("td").length;var p=24;var l=function(s){var t=$('<tr class="menu-organizer-header" d_row="d_row"></tr>');var u=$('<td colspan="'+f+'"></td>');t.append(u);t.css("height",p);u.text(s);return t};var h="Not in Menu";var d="Top Menu";var e=h;r.prepend(l(e));r.find("tr").each(function(){var t=$(this);var s=t.attr("d_hideinmenu");var u=t.attr("d_menu_parent");if(s=="No"&&u==""&&e==h){e=d;t.before(l(e))}else{if(s=="No"&&u!=""&&u!=e&&(e==h||e==d)){e=u;t.before(l(e))}}})},600,"auto")}catch(b){}hideProgress()}function getHistoryFilter(c,b,f){var d={Fields:[{Key:"ActionHistory_Parent",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"ActionHistory_Parent",Permanent:false,Required:false,Searchable:false,Type:"DropDown",ValidationType:null,Value:null}},{Key:"HistoryUsers_Parent",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"HistoryUsers_Parent",Permanent:false,Required:false,Searchable:false,Type:"DropDown",ValidationType:null,Value:null}},{Key:"ViewName",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"ViewName",Permanent:false,Required:false,Searchable:true,Type:"Text",ValidationType:null,Value:null}},{Key:"PK",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"PK",Permanent:false,Required:false,Searchable:true,Type:"TextArea",ValidationType:null,Value:null}},{Key:"UpdateDate",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"UpdateDate",Permanent:false,Required:false,Searchable:false,Type:"Text",ValidationType:null,Value:null}},{Key:"FieldName",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"FieldName",Permanent:false,Required:false,Searchable:true,Type:"TextArea",ValidationType:null,Value:null}},{Key:"ColumnNames",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"ColumnNames",Permanent:false,Required:false,Searchable:false,Type:"TextArea",ValidationType:null,Value:null}},{Key:"OldValue",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"OldValue",Permanent:false,Required:false,Searchable:true,Type:"Text",ValidationType:null,Value:null}},{Key:"NewValue",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"NewValue",Permanent:false,Required:false,Searchable:true,Type:"Text",ValidationType:null,Value:null}},{Key:"Id",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"Id",Permanent:false,Required:false,Searchable:false,Type:"Text",ValidationType:null,Value:null}},{Key:"ChangeHistoryId",Value:{Default:null,DependencyChildren:null,Format:null,Min:0,Max:0,Name:"ChangeHistoryId",Permanent:false,Required:false,Searchable:false,Type:"Text",ValidationType:null,Value:null}}]};d.Fields[2].Value.Value=f;var a=Multi.GetSelection(b);if(a.length==1){var e=a[0];d.Fields[3].Value.Value=e}return d}function ctrlNavigate(b,d){var a=$(b).attr("d_url");var c=$(b).parent("TD.d_fieldContainer").attr("d_role")=="cell";if(c&&!d.ctrlKey){return false}if(d.ctrlKey){window.open(a,"_blank")}else{window.location.href=a}return false}function sendConfig(a){$.ajax({url:a,contentType:"application/json; charset=utf-8",async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:modalSuccessMsg})}function debugit(a){$("#y-debug").html($("#y-debug").html()+a+" / ")}var hideAjaxErrorMsg=false;function ajaxErrorsHandler(b,f,d){hideProgress();var e="";try{if(b.readyState!=4){e="Request failed!";return}else{if(b.status==501){e="Internal Server Error!"}else{if(b.status==404){e="Page Not Found - The server is down!"}else{if(b.status==403){e="Forbidden - You are not allowed to do this action (or session timeout)!"}else{if(b.status==401){e="Session expired!";var c="/Account/LogOn?ReturnUrl=";if(b.responseText&&b.responseText.length<200){c+=b.responseText}top.location.href=c}else{e=translator.GeneralErrorMessage}}}}}}catch(a){e=translator.GeneralErrorMessage}if(!hideAjaxErrorMsg){modalErrorMsg(e)}}function ajaxNotSuccessMsg(e,c,d){if(!e){e="Data didn't loaded successfully!"}e=e.replace("$$error$$","");if(c){if(!d){complete(c)}}e=e.replace("/n","<br /><br />");var a=$(window).height();$("#modal_errors").dialog("option","title",translator.SystemInfoMsg);modalErrorMsg(e);var b=$("#modal_errors").height();if(b>a-10){$("#modal_errors").dialog("option","height",a-10)}}function modalSuccessMsg(a){$("#modal_errors").dialog("option","title",translator.SystemInfoMsg);$("#modal_errors").dialog("option","height","auto");showMsgInModalDialog(a)}function modalErrorMsg(a){$("#modal_errors").dialog("option","title",translator.SystemInfoMsg);$("#modal_errors").dialog("option","height","auto");if(a.replace(/\s/g,"")!="m_CancelError"){showMsgInModalDialog(a)}}function showMsgInModalDialog(b){hideProgress();var a=$("#modal_errors");a.html(b);handleMoreInfo(a,b);a.dialog("open")}function handleMoreInfo(a,d){var c=a.find(".additional-info-link");var b=a.find(".additional-info-icon");if(c.length!=1){return}var e=a.find(".additional-info");e.hide();b.removeClass("additional-info-icon-col");b.addClass("additional-info-icon-exp");a.find(".additional-info-link,.additional-info-icon").click(function(){if(e.is(":visible")){e.hide();b.removeClass("additional-info-icon-exp");b.addClass("additional-info-icon-col")}else{e.show();b.removeClass("additional-info-icon-col");b.addClass("additional-info-icon-exp")}})}function adjustFreeBg(b){var j=$("#"+b+"ajaxDiv div.fixedViewPort").first();if(j.length==0){return}var f=$("#"+b+"ajaxDiv table.gridview").first();if(f.length==0){return}var a=j.find(".freeBg:last");if(a.length==0){return}a.show();var g=f.find("td:last");if(g.length!=1){return}var e=a.height();if(e==0){e=45}var c=$(".fixedViewPort").position().top+$(".fixedViewPort").height()-e-2;var d=c+"px";a.css("top",d);return f.height()+", "+a.height()}var toResize;var dialogResize;$(document).ready(function(){resizeWindow();mainMenu();try{$('<div id="modal_errors"></div>').dialog({autoOpen:false,position:"center",width:($(window).width()*0.5),modal:true,position:"center",zIndex:99999999,title:"System error message",buttons:{Close:function(){$("#modal_errors").dialog("close");hideProgress()}}})}catch(c){}initSplitters();FilterForm.InitTreeFilter();$(window).resize(function(){resizeWindow()});$(document).bind("keyup",function(b){if(b.keyCode==$.ui.keyCode.ESCAPE){Durados.GridHandler.resetHeadersMoveToClass();resetRenamedField()}});if($.browser.webkit){$("body").addClass("webkit")}logTitle.initiate();if(!isMobile()){try{initRotateMenu()}catch(c){}}if(queryString("settings")=="fields"||queryString("settings")=="view"){$("#rowtabletitleSpan").click()}var a=false;var d=IsFieldsSettings();window.onbeforeunload=function(){if(adminPreviewChanged){a=true}try{CancelPreview(null)}catch(b){return}if(a&&d){return"You have attempted to leave this page.  If you have made any changes to the fields without clicking the Save button, your changes will be lost."}}});function mainMenu(){$("#sideMenu ul li.selected3").prev().css("border-bottom","none");$("#sideMenu ul li:not(:first-child)").click(function(){$("#sideMenu ul li").css("border-bottom","1px solid #d3d3d3");$("#sideMenu ul li.selected3").removeClass();$(this).closest("li").addClass("selected3").prev().css("border-bottom","none")});$("#menu ul li a").click(function(){$("#menu ul li.selected2").removeClass();$(this).closest("li").addClass("selected2")});$("#sideMenu ul li:first-child .collapse").click(function(){$("#sideMenu2").show();$("#sideMenu2").animate({left:"-=211"},"slow",function(){$(this).css("position","relative")});$("#sideMenu ul").animate({width:"toggle"},"slow",function(){$("#sideMenu").hide();resizeWindow()});$.cookie("sideMenu","hide",{expires:1000})});$("#sideMenu2").click(function(){$(this).hide();$(this).css("position","absolute");$(this).css("left","211px");$("#sideMenu").show();$("#sideMenu ul").animate({width:"toggle"},"slow");resizeWindow();$.cookie("sideMenu","show",{expires:1000})});var a=$("#sideMenu ul").children("li").length<=1;if(a||$.cookie("sideMenu")=="hide"){$("#sideMenu2").css("position","relative");$("#sideMenu2").show();$("#sideMenu2").css("left","0");$("#sideMenu").hide();$("#sideMenu ul").hide()}}function IsFieldsSettings(){try{if(parent&&parent.parent&&parent.parent.location.href){return queryString2(parent.parent.location.href,"settings")=="fields"}else{return false}}catch(a){return false}}function CancelPreview(a){if(adminPreviewChanged){adminPreviewChanged=false;url="/Admin/CancelPreview/"+(a==null?getMainViewName():a);$.ajax({url:url,contentType:"application/json; charset=utf-8",data:{},async:false,dataType:"json",cache:false})}}function initMoreActions(a){var b=a+"ajaxDiv";$("#"+b).find(".slide-down:first").unbind("click").bind("click",function(c){$(this).next(".more-actions").slideToggle("fast","jswing")});$("#"+b).find(".more-actions:first").unbind("mouseleave").bind("mouseleave",function(c){$(this).slideUp("fast","jswing")});$("#"+b).find(".more-actions:first").unbind("click").bind("click",function(c){$(this).slideUp("fast","jswing")})}function initButtons(){$(".button:not(.button-init)").addClass("button-init").button()}function initImages(){Durados.Image.Init()}function initEditors(){$(".gridview td[hoverEdit].enabledCell").each(function(){$(this).append('<a><span class="Edit-icon" title="Edit"></span></a>')})}function initCheckboxes(){$("input:checkbox:not([safari])").checkbox({cls:"jquery-safari-checkbox"});$("input[safari]:checkbox").checkbox({cls:"jquery-safari-checkbox"});$("input:radio:not(.radioClass)").checkbox()}function initColorPickers(){$("input[color=1]").each(function(){var a=$(this);if(a.css("display")!="none"){initColorPicker(a)}})}function initColorPicker(a){var b=a.siblings("input[type=checkbox]");b.unbind("change").bind("change",function(){var e=Durados.CheckBox.IsChecked(b);var d=e?"enable":"disable";if(!e){var c="#ffffff";a.spectrum("set",c)}a.spectrum(d)});a.spectrum({color:"#ffffff",showInput:true,showAlpha:true,clickoutFiresChange:true,showInitial:true,showPalette:true,localStorageKey:"spectrum.homepage.modubiz",palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(153, 153, 153)","rgb(183, 183, 183)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(239, 239, 239)","rgb(243, 243, 243)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(133, 32, 12)","rgb(153, 0, 0)","rgb(180, 95, 6)","rgb(191, 144, 0)","rgb(56, 118, 29)","rgb(19, 79, 92)","rgb(17, 85, 204)","rgb(11, 83, 148)","rgb(53, 28, 117)","rgb(116, 27, 71)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]]})}function initWatermark(){$.fn.watermark=function(a){return this.each(function(){var b=$(this);var c=b.attr("dvalue")||b.val();b.bind("focus",function(){if(b.val().length===0||b.val()===c){b.val("").removeClass("watermarkThis")}});b.bind("blur change",function(){if(b.val().length===0||b.val()===c){b.val(c).addClass("watermarkThis")}else{b.removeClass("watermarkThis")}}).trigger("blur")})};$(".watermark").watermark({defaultClass:"",waterMarkClass:"watermarkThis"})}function initRotateMenu(){$("#mainmenu").superfish();$("#mymenu").superfish();return;$(".zone #menuheadbutton, .zone a").click(function(b){$(".submenu-container").slideToggle("fast")});$(".zone").mouseleave(function(b){$(".submenu-container").slideUp("fast")});if(!isIE()){var a=0;$("#menuheadbutton").rotate({bind:{mouseover:function(){$(this).rotate({animateTo:30})},mouseout:function(){$(this).rotate({animateTo:0})}}})}$("a.submenu-item").click(function(b){$(".slider").css({opacity:"0"});$(".slider").animate({opacity:"1",left:"1024px"},700,"jswing");$(".slider").animate({opacity:"0",left:"50px"},300)});$(".submenu-item.item1").live("click",function(b){$("#menuheadbutton").attr("class","item1")});$(".submenu-item.item2").live("click",function(b){$("#menuheadbutton").attr("class","item2")});$(".submenu-item.item3").live("click",function(b){$("#menuheadbutton").attr("class","item3")});$(".submenu-item.item4").live("click",function(b){$("#menuheadbutton").attr("class","item4")});$(".submenu-item.item5").live("click",function(b){$("#menuheadbutton").attr("class","item5")});$(".submenu-item.item6").live("click",function(b){$("#menuheadbutton").attr("class","item6")});$(".submenu-item.item7").live("click",function(b){$("#menuheadbutton").attr("class","item7")});$(".submenu-item.item8").live("click",function(b){$("#menuheadbutton").attr("class","item8")});$(".submenu-item.item9").live("click",function(b){$("#menuheadbutton").attr("class","item9")});$(".submenu-item.item10").live("click",function(b){$("#menuheadbutton").attr("class","item10")})}var adjustDataTableHeightDisabled=false;function adjustDataTableHeight(){Durados.FieldEditor.CloseAllEditors();Durados.GridHandler.adjustDataTableHeight(0);Durados.GridHandler.setHeadersDivWidth()}function refreshMainContent(){var a=getMainPageGuid();if(a){AddDialog.Refresh(a,null)}}function getMainPageGuid(){return $("#mainAppDiv").find("div.fixedViewPort").first().attr("d_fix")}function getMainPageDiv(){guid=getMainPageGuid();if(!guid){return""}return $("#"+guid+"ajaxDiv div.fixedViewPort").first()}function getMainPageHeight(){return $("#"+getMainPageGuid()+"ajaxDiv div.fixedViewPort").first().height()}$(Durados.View).bind("rowChanged",function(d,c){var b=c.tr.attr("d_pk");var a=c.tr.attr("guid");if(b!=null){Multi.SelectByPK(a,b)}});function setIReportCss(){$("body").css("margin-bottom",0);$("body").css("padding-bottom",0)}var iframehide="no";function setIframeSize(a){if(a.contentDocument&&a.contentDocument.body.scrollHeight){a.style.height=$(window).height()-120}else{if(a.Document&&a.Document.body.scrollHeight){a.height=$(window).height()-80}}}var UrlDialog;if(!UrlDialog){UrlDialog={}}UrlDialog.GetButtons=function(a,e,f,b,c){var d={};d[translator.ok]=function(){UrlDialog.Update(a,e,f,b,c)};d[translator.cancel]=function(){$(this).dialog("close")};return d};UrlDialog.Open=function(d,c,j,h,f){begin();var e=$("#UrlDialog");if(e.parents('div[role="dialog"]').length==0){var a=$(window).width();var b=$(window).height();var g=a*0.75-55;$("#UrlDialog").dialog({bgiframe:true,autoOpen:false,modal:true,zIndex:10000,position:"center",height:(b*0.5),width:(a*0.5)})}e.dialog("option","title",translator.editRowOn+h);e.dialog("option","buttons",UrlDialog.GetButtons(d,c,j,f,e));e.dialog("open");UrlDialog.Load(d,c,j,f);complete(f)};UrlDialog.GetA=function(a){return $(a).parent().siblings("a:first")};UrlDialog.Load=function(d,c,j,f){var h=UrlDialog.GetA(d);var k=h.find("span").text();var b=h.attr("href");if(b==k){k=""}if(b==""||b=="#"){b="http://"}var g=h.attr("target")=="_blank"||h.text()=="";var e=$("#UrlDialog");e.find('input[name="urlDisplayName"]').val(k);e.find('input[name="urlAddress"]').val(b);Durados.CheckBox.SetChecked(e.find('input[name="urlNewWindow"]'),g)};UrlDialog.Update=function(d,c,l,g,f){begin();var m=f.find('input[name="urlDisplayName"]').val();var b=f.find('input[name="urlAddress"]').val();var h=Durados.CheckBox.IsChecked(f.find('input[name="urlNewWindow"]'));var e=h?"_blank":"_self";var j=UrlDialog.GetA(d);if(b==""){b="#"}if(m==""&&b!="#"){m=b}j.find("span").text(m);j.attr("href",b);j.attr("target",e);var k=m+"|"+e+"|"+b;if(!m||m==b){k=b}if(c==""){j.attr("value",k);UrlDialog.HandleSuccess(g,f);j.parent().blur();if(g==pageGuid){j.blur()}}else{$.post(rootPath+views[g].Controller+"/EditUrl/"+views[g].gViewName,{pk:c,fieldName:l,value:k,guid:g},function(o){var a=o.indexOf("$$error$$",0);if(a<0||a>1000){UrlDialog.HandleSuccess(g,f);j.parent().blur()}else{ajaxNotSuccessMsg(o,g)}})}};UrlDialog.HandleSuccess=function(a,b){b.dialog("close");hideProgress()};var elementScrollsPosition={x:0,y:0};function saveElementScrollsPosition(a){var b;if(!a){b=getMainPageDiv()}else{b=$("#"+a+"ajaxDiv div.fixedViewPort").first()}if(!b.length){return}elementScrollsPosition.y=b.scrollTop();elementScrollsPosition.x=b.scrollLeft()}function resetElementScrollsPosition(a){var b;if(!a){b=getMainPageDiv()}else{b=$("#"+a+"ajaxDiv div.fixedViewPort").first()}if(!b.length){return}if(elementScrollsPosition.y){b.scrollTop(elementScrollsPosition.y)}if(elementScrollsPosition.x){b.scrollLeft(elementScrollsPosition.x)}elementScrollsPosition.y=0;elementScrollsPosition.x=0;Durados.GridHandler.scrollHeaders(a)}function isInDialog(a){return $(a).parents("div.ui-dialog:first").length>0}var Roles;if(!Roles){Roles={}}$(Durados.View).bind("derivationFieldChanged",function(g,f){if((f.viewName=="Workspace"||f.viewName=="View"||f.viewName=="Field"||f.viewName=="Page")&&!f.value){var d;if(f.viewName=="Workspace"){d="By unchecking the Override checkbox, the Workspace Roles will inherit the Systems Roles. The current Roles will be lost. Click OK to proceed."}else{if(f.viewName=="View"){d="By unchecking the Override checkbox, the View Roles will inherit the Workspace Roles. The current Roles will be lost. Click OK to proceed."}else{if(f.viewName=="Field"){d="By unchecking the Override checkbox, the Field Roles will inherit the View Roles. The current Roles will be lost. Click OK to proceed."}else{if(f.viewName=="Page"){d="By unchecking the Override checkbox, the Page Roles will inherit the Workspace Roles. The current Roles will be lost. Click OK to proceed."}}}}f.cancel=!confirm(d);if(f.cancel){Durados.CheckBox.SetChecked(f.derivationField,true);f.derivationField.parent("td:first").focus()}else{var c="";var b;var a;if(f.prefix==editPrefix){a=$("#"+f.guid+"DataRowEdit");c=a.attr("pk")}else{if(f.prefix==inlineEditingPrefix){a=$("#"+f.guid+f.viewName+"inlineEditing");c=a.attr("pk")}else{a=$("#"+f.guid+"DataRowCreate")}}$.ajax({url:gVD+"Admin/GetInheritRoles",contentType:"application/json; charset=utf-8",data:{type:f.viewName,pk:c},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(o){if(o=="error"){Durados.CheckBox.SetChecked(f.derivationField,true);f.derivationField.parent("td:first").focus();alert("Failed to change roles. Please notify administrator and try later.")}else{var h=a.find('select[name="AllowCreateRoles"]');var q=a.find('select[name="AllowDeleteRoles"]');var p=a.find('select[name="AllowEditRoles"]');var l=a.find('select[name="AllowSelectRoles"]');var e=a.find('select[name="DenyCreateRoles"]');var m=a.find('select[name="DenyDeleteRoles"]');var k=a.find('select[name="DenyEditRoles"]');var j=a.find('select[name="DenySelectRoles"]');if(f.viewName=="Page"){clearAndLoadChecklist(l,o.AllowSelectRoles)}else{clearAndLoadChecklist(h,o.AllowCreateRoles);if(f.viewName!="Field"){clearAndLoadChecklist(q,o.AllowDeleteRoles)}clearAndLoadChecklist(p,o.AllowEditRoles);clearAndLoadChecklist(l,o.AllowSelectRoles);clearAndLoadChecklist(e,o.DenyCreateRoles);if(f.viewName!="Field"){clearAndLoadChecklist(m,o.DenyDeleteRoles)}clearAndLoadChecklist(k,o.DenyEditRoles);clearAndLoadChecklist(j,o.DenySelectRoles)}}}})}}});function pageMoved(a){success(a)}function calculatedFieldChanged(c,d,a,b){url=rootPath+views[a].Controller+"/CalculatedFieldChanged/"+c;$.ajax({url:url,contentType:"application/json; charset=utf-8",data:{fieldName:d,pk:b,guid:a},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(e){Sharing.Update(e,true)}})}var Sharing;if(!Sharing){Sharing={}}Sharing.Update=function(b,a){$(b.Views).each(function(){var c=$(this);$(c.Rows).each(function(){var g=$(this);var f=c.Name;var d=g.PK;var e=$('table.gridview>tr[d_pk="'+d+'"]');if(e.length==1){$(g.Fields).each(function(){var l=$(this);var o=l.Name;var k=l.Value;var j=l.DisplayValue;var m=e.find('td[d_name="'+o+'"]');var h=m.attr("d_guid");Durados.FieldEditor.setCellValue(m,k,j,h,o);if(a){setTimeout(function(){m.addClass("sharingCellChanged");setTimeout(function(){m.removeClass("sharingCellChanged")},2000)},1)}})}})})};var DuradosMail;if(!DuradosMail){DuradosMail={}}DuradosMail.sendMailTo=function(f,e,c,a){var d=$("<iframe>");d.attr("src","about:blank");d.css("display","none");$("body").append(d);var b="mailto:"+f+"?subject="+c+"&amp;body="+encodeURIComponent(a)+"&cc="+e;d[0].contentWindow.location.href=b;d.remove()};DuradosMail.send=function(f,e,c,a,d,b){DuradosMail.sendMailTo(f,e,c,a)};var Send;if(!Send){Send={}}Send.DialogName=function(){return"dialog_email"};Send.Show=function(b){var c=views[b].gViewName;var a=Multi.GetSelection(b);if(a==null){return}if(a.length==0){hideProgress();modalErrorMsg("Please select a row");return}if(a.length>10){hideProgress();modalErrorMsg("Please select no more than 10 rows");return}if(!isIE()){Send.ShowCustom(a,c,b)}else{$.ajax({url:rootPath+views[b].Controller+"/GetJsonLetter/"+c,contentType:"application/json; charset=utf-8",data:{pks:String(a)},async:false,cache:false,success:function(d){hideProgress();DuradosMail.send(d.To,d.Cc,d.Subject,d.Body,d.FileName,d.Content)}})}};Send.ShowCustom=function(c,d,a){try{if(!$("#mydialog").is(":data(dialog)")){$("#sendEmailDiv").dialog({autoOpen:false,width:750,modal:false,closeOnEscape:false,position:"center",zIndex:999999,title:"Send",buttons:{Send:function(){Send.Send(c,d,a)},Cancel:function(){$(this).dialog("close")}}})}var e=Rectangle.Load("SendProposal");if(e!=null){$("#sendEmailDiv").dialog("option","position",[e.left,e.top])}Send.Load(c,d,a);$("#sendEmailDiv").dialog("open");Send.CreateWysiwyg();complete(a)}catch(b){}};Send.CreateWysiwyg=function(){$("#sendEmailDiv textarea").each(function(){$(this).htmlarea("dispose")});$("#sendEmailDiv textarea").htmlarea()};Send.Load=function(c,b,a){$.ajax({url:rootPath+views[a].Controller+"/GetLetter/"+b,contentType:"application/json; charset=utf-8",data:{pk:String(c)},async:false,cache:false,error:function(d,f,e){alert(d.getAllResponseHeaders()+" "+f+" "+e)},success:function(e){hideProgress();var d=e.indexOf("$$error$$",0);if(d<0||d>1000){$("#sendEmailDiv").html(e)}}})};Send.Send=function(f,e,c){begin();var b=$("#sendEmailDiv").find("Iframe").contents().find("body");var d=$('#sendEmailDiv input[name="subject"]').val();var h=$('#sendEmailDiv input[name="to"]').val();var g=$('#sendEmailDiv input[name="cc"]').val();var a=b.text();$.post(rootPath+views[c].Controller+"/Send/"+e,{pk:String(f),subject:d,to:h,cc:g,body:a},function(k){var j=k.indexOf("$$error$$",0);if(j<0||j>1000){$("#sendEmailDiv").dialog("close");success(c);return}else{modalErrorMsg(k.replace("$$error$$",""));return;complete(c)}})};Send.SaveDialogOnResize=function(b,c){var a=Rectangle.New(c.position.top,c.position.left,c.size.width,c.size.height);Rectangle.Save(a,Send.DialogName())};Send.SaveDialogOnDrag=function(b,c){var a=Rectangle.Load(Send.DialogName());if(a!=null){a.top=c.position.top;a.left=c.position.left;Rectangle.Save(a,Send.DialogName())}};Durados.GridHandler={setColumnsWidth:function(h,j){if(Durados.Indications.fitToWindowWidth(h)){var c=$("#"+h+"ajaxDiv");if(!c.length){return}var l=c.find("div.fixedViewPort").first();if(!l.length){return}var e="tr.gridviewhead";var k=0;var a=c.find(e+" th:not(.tablecmdhead,.lastTD)");var m=[];var d=0;var f=l.width();if(l.innerHeight()<l[0].scrollHeight){d=Durados.GridHandler.getScrollbarWidth();f-=d}var b=0;c.find(e+" th.tablecmdhead:visible").each(function(){b+=$(this).outerWidth()});f-=b;a.each(function(){var o=$(this).outerWidth();k+=o;m.push({element:$(this),width:o})});$(m).each(function(){var q=this.element;var s=this.width;var r=s/k;var p=Math.floor(r*f);var o=Durados.GridHandler.getCellIndex(this.element[0]);Durados.GridHandler.setColumnWidth(h,o,p,true)});if($("body").attr("dir")!="rtl"){a.last(":not(.ScrollPlace)").css("border-right-width","0px")}var g=$("#"+h+"ajaxDiv table.gridview td.ImageFieldType img");g.each(function(){Durados.Image.SetSize($(this))});if(j==null){j=1}d=0;if(l.innerHeight()<l[0].scrollHeight){d=Durados.GridHandler.getScrollbarWidth()}if((l.outerWidth()-d)<l[0].scrollWidth&&j<7){Durados.GridHandler.setColumnsWidth(h,++j)}Durados.GridHandler.firstColumnsWidthDone=0}},setNewColumnWidth:function(c,g){var d=$("#"+c+"ajaxDiv table.gridview tr.gridviewhead th:not(.tablecmdhead,.lastTD)");var b=d.length;var e=0;if(b){var a=0;d.each(function(){a+=$(this).outerWidth()});e=Math.floor(a/b)}else{e=$("#"+c+"ajaxDiv div.fixedViewPort").width()}var f={Key:g,Value:{width:e}};Durados.ColumnResizer.saveState(c,false,f,false)},adjustDataTable:function(a){Durados.GridHandler.adjustDataTableHeight(a);Durados.GridHandler.setDataTableScrollAndCellsWidth(a)},isAppUseFixedHeadres:true,isFixedHeadersTable:function(a){if(!Durados.GridHandler.isAppUseFixedHeadres){return false}return $("#"+a+"ajaxDiv div.headWrapper").first().attr("d_fix")==a},firstColumnsWidthDone:0,headersOffset:0,firstDo:20,scollBarsWith:0,getScrollbarWidth:function(){if(Durados.GridHandler.scollBarsWith>0){return Durados.GridHandler.scollBarsWith}var c=document.createElement("p");c.style.width="100%";c.style.height="200px";var d=document.createElement("div");d.style.position="absolute";d.style.top="0";d.style.left="0";d.style.visibility="hidden";d.style.width="200px";d.style.height="150px";d.style.overflow="hidden";d.appendChild(c);document.body.appendChild(d);var b=c.offsetWidth;d.style.overflow="scroll";var a=c.offsetWidth;if(b==a){a=d.clientWidth}document.body.removeChild(d);return Durados.GridHandler.scollBarsWith=(b-a)},setIsMainDivHasVScroll:function(a,b){var c=Durados.GridHandler.isMainDivHasVScroll[a];Durados.GridHandler.isMainDivHasVScroll[a]=b;if(c!=b){Durados.GridHandler.setFreezeHeaders(a,b)}},setFreezeHeaders:function(b,a){if(a){if(!Durados.GridHandler.isFixedHeadersTable(b)){Durados.GridHandler.setDataTableScrollAndCellsWidth(b)}}else{if(Durados.GridHandler.isFixedHeadersTable(b)){Durados.GridHandler.removeFreezeHeaders(b)}}},removeFreezeHeaders:function(c){if(!c||Durados.GridHandler.isMainDivHasVScroll[c]||!Durados.GridHandler.isFixedHeadersTable(c)){return}var b=$("#"+c+"ajaxDiv div.headWrapper").first();var a=$("#"+c+"ajaxDiv div.fixedViewPort .gridview").first();b.find(".ScrollPlace").remove();a.prepend($("<thead>").append(b.find("tr")));b.remove()},setDataTableScrollAndCellsWidth:function(s){if(!Durados.GridHandler.isAppUseFixedHeadres||!s||!Durados.GridHandler.isMainDivHasVScroll[s]){return}if(!Durados.Indications.isMainGrid(s)){return}var x=$("#"+s+"ajaxDiv").find("table.gridview:first").attr("rowCountInPage");if(!x){return}if(x>20){return}var B=$("#"+s+"ajaxDiv table.gridview").first();if(!B.length){return}var u=Durados.GridHandler.firstColumnsWidthDone==0;if(Durados.GridHandler.isFixedHeadersTable(s)&&u){return}var e=$("#"+s+"ajaxDiv div.fixedViewPort").first();var A=B.attr("d_editMode")=="on";if(u){var w=B.find("thead");if(!w.length){return}var r=w.height();var l=e.width()-Durados.GridHandler.scollBarsWith;if(A){l--}var k=$('<div class="headWrapper"></div>').attr("d_fix",s);var C=B.attr("multiSelect");k.html('<table cellspacing="0" class="gridviewhead"  multiSelect="'+C+'" >'+w.html()+"</table>");k.children("table").first().css("width","100%");w.remove();k.insertBefore(e);e.height(e.height()-r);if(($.browser.webkit||$.browser.mozilla)&&$("body").attr("dir")=="rtl"){k.find("tr").append('<td class="ScrollPlace" style="padding:0;margin:0;width:'+Durados.GridHandler.getScrollbarWidth()+'px"><div style="width:'+Durados.GridHandler.getScrollbarWidth()+'px">&nbsp;</div></td>')}else{k.find("tr").append('<td class="ScrollPlace" style="padding:0;margin:0;width:'+Durados.GridHandler.getScrollbarWidth()+'px"><div style="width:'+Durados.GridHandler.getScrollbarWidth()+'px">&nbsp;</div></td>')}}if(Durados.GridHandler.firstColumnsWidthDone>Durados.GridHandler.firstDo){return}var g=$("#"+s+"ajaxDiv table.gridviewhead").first();if(g.length==0||!g[0].rows||!g[0].rows.length){return}var m=B[0].rows.length-1;var b=B[0].rows[m];if(!b){hideProgress();return}var f=b.cells.length-1;var t=g[0].rows[(g[0].rows.length-1)];var o=1;for(var z=Durados.GridHandler.firstColumnsWidthDone;z<f;z++){if(b.cells[z].firstChild.className=="ganttDataRowDiv"||$(b.cells[z]).hasClass("tablecmd")){continue}var v=t.cells[z+Durados.GridHandler.headersOffset];var y=b.cells[z];var a=$(v);var p=a.outerWidth();var j=$(y);var q=j.outerWidth();if(p>q){Durados.GridHandler.setColumnWidth(s,z,p,true)}else{if(p<q){Durados.GridHandler.setColumnWidth(s,z,p,true)}}Durados.GridHandler.firstColumnsWidthDone++;if(u&&Durados.GridHandler.firstColumnsWidthDone==Durados.GridHandler.firstDo){break}}if(u){e.unbind("scroll");e.bind("scroll",function(){var c=s;Durados.GridHandler.scrollData(c);triggerEditorBlur()});if(Durados.GridHandler.firstColumnsWidthDone<f){showProgress();setTimeout(function(){var c=s;Durados.GridHandler.setDataTableScrollAndCellsWidth(c)},50)}else{Durados.GridHandler.firstColumnsWidthDone=0;hideProgress()}}else{Durados.GridHandler.firstColumnsWidthDone=0;hideProgress()}hideProgress()},scrollData:function(a){if(!Durados.GridHandler.isAppUseFixedHeadres||!a){return}var b=$("#"+a+"ajaxDiv div.headWrapper").first();var c=$("#"+a+"ajaxDiv div.fixedViewPort").first();if(b.length==1&&b.attr("d_fix")==a){b.scrollLeft(c.scrollLeft())}},scrollHeaders:function(a){if(!Durados.GridHandler.isAppUseFixedHeadres||!a){return}var b=$("#"+a+"ajaxDiv div.headWrapper").first();if(b.length==1&&b.attr("d_fix")==a){$("#"+a+"ajaxDiv div.fixedViewPort").first().scrollLeft(b.scrollLeft())}},setHeadersDivWidth:function(){if(!Durados.GridHandler.isAppUseFixedHeadres){return}var a=$("div.headWrapper");if(a.length>0){a.each(function(){var c=$(this).attr("d_fix");if(c){var e=$("#"+c+"ajaxDiv div.fixedViewPort").first();if(e.attr("d_fix")==c){var b=e.width();if(b>100){a.width(b)}}}})}},scrollParentsData:function(a){if(!Durados.GridHandler.isAppUseFixedHeadres){return}a.parents("div.fixedViewPort").each(function(){var b=$(this).attr("d_fix");if(b){var c=$("#"+b+"ajaxDiv div.headWrapper").first();if(c.length==1&&c.attr("d_fix")==b){c.scrollLeft($(this).scrollLeft())}}})},setHeaderWidth:function(m){var k=m.parents("div.fixedViewPort").first().attr("d_fix");if(!k||!Durados.GridHandler.isFixedHeadersTable(k)){return}var b=$("#"+k+"ajaxDiv table.gridviewhead").first();if(b.length==0||!b[0].rows||!b[0].rows.length){return}var l=b[0].rows[(b[0].rows.length-1)];var j=Durados.GridHandler.getCellIndex(m[0]);var g=l.cells[j+Durados.GridHandler.headersOffset];var a=g.offsetWidth-21;var d=m[0].offsetWidth-21;if(a<d){g.firstChild.style.width=d+"px"}else{if(a>d){var f=$("#"+k+"ajaxDiv table.gridview").first();var e=f[0].rows.length-1;f[0].rows[e].cells[j].firstChild.style.width=a+"px"}}},setColumnWidth:function(f,l,d,j){if(!f){return}var a=$("#"+f+"ajaxDiv table.gridviewhead").first();var c=$("#"+f+"ajaxDiv table.gridview").first();if(a.length){var g;var k;var o;for(i=0;i<a[0].rows.length;i++){var m=a[0].rows[i].className;if(m=="trsubgrid"||m=="rowfilter"){continue}g=$(a[0].rows[i].cells[l]);k=g.children("div").first();o=d-num(g.css("padding-right"))-num(g.css("padding-left"))-num(k.css("margin-right"))-num(k.css("margin-left"))-num(g.css("border-right-width"))-num(g.css("border-left-width"));if(o<5){o=5}k.width(o)}}if(c.length){var h=c.attr("d_editMode")=="on";var b=1;var g;var k;var o;for(i=0;i<c[0].rows.length;i++){var m=c[0].rows[i].className;if(m=="trsubgrid"||m=="rowfilter"){continue}g=$(c[0].rows[i].cells[l]);k=g.children("div").first();o=d-num(g.css("padding-right"))-num(g.css("padding-left"))-num(k.css("margin-right"))-num(k.css("margin-left"))-num(g.css("border-right-width"))-num(g.css("border-left-width"));if(o<5){o=5}k.width(o)}if(j!==true){var e=$("#"+f+"ajaxDiv table.gridview td.ImageFieldType img");e.each(function(){Durados.Image.SetSize($(this))})}}Durados.GridHandler.scrollData(f)},getCellIndex:function(a){var b=a.cellIndex||0;if(b==0){do{if(a.nodeType==1){b++}a=a.previousSibling}while(a);--b}return b},hideColumn:function(e,d){if(!e||!d){return}if(e.length>0){e=e[0]}var g=$("#"+d+"ajaxDiv table.gridview").first();var b=$("#"+d+"ajaxDiv table.gridviewhead").first();var f=b.length==1;if(g.length!=1&&!f){return}g.find('img.expand[state="expand"]').click();g=g[0];var a=Durados.GridHandler.getCellIndex(e);if(f){b=b[0];for(i=0;i<b.rows.length;i++){var c=Durados.GridHandler.headersOffset;if($(b.rows[i]).hasClass("rowfilter")){c++}if(b.rows[i].cells.length>a){$(b.rows[i].cells[a-c]).remove()}}}for(i=0;i<g.rows.length;i++){var c=Durados.GridHandler.headersOffset;if($(g.rows[i]).hasClass("rowfilter")){c++}if(g.rows[i].cells.length>a-c){$(g.rows[i].cells[a-c]).remove()}}Durados.GridHandler.setColumnsWidth(d)},moveColumn:function(f,j){if(!j||!f||!movedColumnInfo[f]){return}var k=movedColumnInfo[f].elementToMove;var c=movedColumnInfo[f].placement;if(j.length>0&&k.length>0){j=j[0];k=k[0]}else{return}var d=$("#"+f+"ajaxDiv table.gridview").first();var g=$("#"+f+"ajaxDiv table.gridviewhead").first();var e=g.length==1;if(d.length!=1&&!e){return}d.find('img.expand[state="expand"]').click();d=d[0];var b=Durados.GridHandler.getCellIndex(k);var h=Durados.GridHandler.getCellIndex(j);if(b<h){h--}if(e){g=g[0];for(i=0;i<g.rows.length;i++){if(g.rows[i].cells.length>h){if(c=="before"){$(g.rows[i].cells[b]).detach().insertBefore(g.rows[i].cells[h])}else{$(g.rows[i].cells[b]).detach().insertAfter(g.rows[i].cells[h])}}}}b-=Durados.GridHandler.headersOffset;h-=Durados.GridHandler.headersOffset;for(i=0;i<d.rows.length;i++){var l=$(d.rows[i]).hasClass("rowfilter");if(l){b--;h--}if(d.rows[i].cells.length>h){if(c=="before"){$(d.rows[i].cells[b]).detach().insertBefore(d.rows[i].cells[h])}else{$(d.rows[i].cells[b]).detach().insertAfter(d.rows[i].cells[h])}}if(l){b++;h++}}if(Durados.Indications.fitToWindowWidth(f)){var a=$("#"+f+"ajaxDiv table.gridview tr.gridviewhead th:not(.tablecmdhead,.lastTD)");if($("body").attr("dir")!="rtl"){a.find(":not(.ScrollPlace)").css("border-right-width","1px");a.last(":not(.ScrollPlace)").css("border-right-width","0px")}}},setHeadersMoveToClass:function(b,a){$("#"+b+"ajaxDiv").addClass("MovingColumn"+a)},resetHeadersMoveToClass:function(){$.each(movedColumnInfo,function(a,b){var c=$("#"+a+"ajaxDiv");c.removeClass("MovingColumnLeft");c.removeClass("MovingColumnRight")});movedColumnInfo={}},adjustDataTableHeight:function(t){var f=getMainPageGuid();if(!t){t=f}if(!t){adjustFreeBg(t);return}var d=t==f;var b=$("#"+t+"ajaxDiv div.fixedViewPort").first();if(b.length==0){return}var x=$("#"+t+"ajaxDiv table.gridview").first();if($.browser.webkit&&b.attr("view")=="dashboard"){b.find("div.gridboard").width(b.width()-30)}var a=x.css("margin-bottom");var h=0;if(a){h=parseInt(a.replace("px",""))}var r=x.css("margin-top");var m=0;if(r){m=parseInt(r.replace("px",""))}var v=x.outerHeight()+m+h;if(!d&&Durados.GridHandler.isViewInSubGrid(b)){var s=views[t].MaxSubGridHeight;s=parseInt(s);if(!s){s=400}if(v>s){b.css("overflow","auto").height(s);Durados.GridHandler.setIsMainDivHasVScroll(t,true)}else{b.css("height","auto");Durados.GridHandler.setIsMainDivHasVScroll(t,false)}Durados.GridHandler.adjustParentHeight(b);adjustFreeBg(t);return}var o;var p=b.parents('div[role="dialog"]');if(p.length>0){o=p.first().height();if(v<500){b.css("height","auto");Durados.GridHandler.setIsMainDivHasVScroll(t,false);adjustFreeBg(t);return}}else{o=$(window).height()}var u;var l=$(".gridPager-div:first");var j=0;if(l.length==1){j=l.outerHeight()+parseInt(l.css("margin-top").replace("px",""))+parseInt(l.css("margin-bottom").replace("px",""))+5;if(j==0){j=40}}var c=b.offset().top;if(t==f){Durados.SplitLayout.adjustSplitContentHeight("#AppTreeDiv",o);Durados.SplitLayout.adjustSplitContentHeight("#AppFilterTreeDiv",o);if(views[t]!=null&&views[t].DataDisplayType=="Preview"){PreviewDisplay.adjustSize(t,o)}}var w=v+24+c+j;var k=false;if(k&&w<o){b.css("height","auto");Durados.GridHandler.setIsMainDivHasVScroll(t,false);var g=adjustFreeBg(t);return}else{Durados.GridHandler.setIsMainDivHasVScroll(t,true);c=b.offset().top;var q=$("#footer").height();u=o-c-j-q+5}b.css("overflow","auto").height(u);var e=adjustFreeBg(t);Durados.GridHandler.setColumnsWidth(t)},isMainDivHasVScroll:{},adjustParentHeight:function(c){var a=c.parents("div.fixedViewPort").first();if(a.length==1){var b=a.attr("d_fix");if(b){if(Durados.GridHandler.isMainDivHasVScroll[b]){return false}Durados.GridHandler.adjustDataTableHeight(b)}}},isViewInSubGrid:function(a){return a.parents('tr[d_role="subGrid"]').first().length==1},insertElementIntoViewport:function(b){var e=b.parents("div.fixedViewPort");if(e.length>0){var a=false;var d=b.offset();var c=0;e.each(function(){var g=null;var j=null;var f=null;var k;var h=$(this).attr("d_fix");if(this.scrollWidth>g){f=$(this).offset();j=$(this).height();g=$(this).width();if(f.left+g<d.left+150){k=$(this).scrollLeft()+(d.left-g-f.left)+b.width()+150;if(k<0){k=0}$(this).scrollLeft(k);$(this).siblings("div.headWrapper").scrollLeft(k);a=true}else{if(d.left<f.left+30){k=$(this).scrollLeft()-(f.left-d.left)-30;$(this).scrollLeft(k);$(this).siblings("div.headWrapper").scrollLeft(k);a=true}}}if(this.scrollHeight>j){if(!f){f=$(this).offset();j=$(this).height();g=$(this).width()}if(f.top+j<d.top+60){k=$(this).scrollTop()+(d.top-j-f.top)+60;if(k<0){k=0}$(this).scrollTop(k)}else{if(f.top>d.top){k=$(this).scrollTop()-(f.top-d.top)-30;$(this).scrollTop(k)}}}c++})}return a},showContentAsTooltip:function(a){if(a.scrollWidth>a.offsetWidth&&!$(a).children(".richTextContainer").length){a.title=$(a).text()}}};Durados.ColumnResizer={handler:null,initHandler:function(a){Durados.ColumnResizer.handler=$('<div class="resizehandler" />').appendTo("body");Durados.ColumnResizer.handler.mousedown(function(){Durados.ColumnResizer.isDragging=true}).mouseup(function(){Durados.ColumnResizer.isDragging=false});Durados.ColumnResizer.handler.draggable({axis:"x",start:function(){$(this).addClass("dragged")},stop:function(b,c){Durados.ColumnResizer.setColumnWidth();Durados.ColumnResizer.saveState(a);$(this).removeClass("dragged").hide();Durados.ColumnResizer.isDragging=false}})},th:null,guid:null,isDragging:false,init:function(a){var b="#"+a+"ajaxDiv tr.gridviewhead:first th[SortColumn]";$(b).bind("mouseover",function(){if(Durados.ColumnResizer.handler==null){return}if(Durados.ColumnResizer.isDragging){return}Durados.ColumnResizer.guid=a;Durados.ColumnResizer.th=$(this);var e=Durados.ColumnResizer.th.offset();var c=e.left;if($("body").attr("dir")!="rtl"){c+=$(this).outerWidth()-5;if(c+5>=$(window).width()){return}}var d=Durados.ColumnResizer.th.outerHeight();Durados.ColumnResizer.handler.css({top:e.top,left:c,height:d});Durados.ColumnResizer.handler.show()})},setColumnWidth:function(){var f=Durados.ColumnResizer.th;var d=Durados.ColumnResizer.handler;var c=Durados.ColumnResizer.guid;if(!f.length){return}var b=Durados.GridHandler.getCellIndex(f[0]);var e=0;var a=0;var g=Durados.Indications.fitToWindowWidth(c)&&f.next().length;if($("body").attr("dir")!="rtl"){e=d.offset().left+5-f.offset().left;if(g){a=f.next().offset().left-5-d.offset().left+f.next().outerWidth()}}else{e=f.offset().left-d.offset().left+f.outerWidth();if(g){a=d.offset().left-f.next().offset().left}}Durados.GridHandler.setColumnWidth(c,b,e);if(g){b=Durados.GridHandler.getCellIndex(f.next()[0]);Durados.GridHandler.setColumnWidth(c,b,a)}Durados.GridHandler.setColumnsWidth(c)},saveState:function(b,g,f,c){var e=[];$("#"+b+"ajaxDiv tr.gridviewhead:first th[SortColumn]").each(function(){var k=$(this).attr("SortColumn");var j=$(this);var l=$(j).children("div").first().width();e.push({Key:k,Value:{width:l}})});if(f!=null){e.push(f)}var a="&user=";if(g){a+="default"}else{a+="current"}var d={Fields:e};var h=views[b].ViewName;$.ajax({url:rootPath+views[b].Controller+"/SaveCustomView/"+h,type:"POST",data:"viewName="+encodeURIComponent(h)+a+"&state="+encodeURIComponent(Sys.Serialization.JavaScriptSerializer.serialize(d)),async:c==null?true:c,cache:false,error:ajaxErrorsHandler,success:function(j){if(g){modalSuccessMsg("Saved")}}})},restoreState:function(a){var b=views[a].ViewName;$.ajax({url:rootPath+views[a].Controller+"/RestoreCustomView/"+b,type:"POST",data:"viewName="+encodeURIComponent(b),async:true,cache:false,error:ajaxErrorsHandler,success:function(c){Refresh(a)}})}};function BookmarkPage(a){var c="BookmarkNameEdit";if(!$("#"+c).length){$("body").append('<div id="'+c+'"><table><tr><td><b>Bookmark name:</b></td><td><input type="text" id="bookmarkNameTxt" value=""/></dt></tr></table></div>');Bookmarks.getBookmarkNotificationChecklist(c);$("#"+c).dialog({autoOpen:false,position:"center",width:($(window).width()*0.4),modal:true,position:"center",zIndex:999999,title:"Add Bookmark",buttons:{Cancel:function(){$("#BookmarkNameEdit").dialog("close")},Add:BookmarkPageCallback}})}var b=$("#"+c);b.attr("guid",a);$("#bookmarkNameTxt").val(views[a].gViewDisplayName);Bookmarks.initgbChecklist(b);b.dialog("open")}function BookmarkPageCallback(){begin();var b=$("#BookmarkNameEdit").attr("guid");var a=$("#bookmarkNameTxt").val().trim();var e=views[b].ViewName;var d=getFriendlyFilter(b);var c={viewName:e,guid:b,Url:location.href,Name:a||views[b].gViewDisplayName,Desc:d};$.ajax({url:rootPath+views[b].Controller+"/CreateBookmark/"+e,contentType:"application/json; charset=utf-8",data:c,async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(f){if(f=="-1"){}else{$('<li><a href="/Durados/LoadBookmark/?id='+f+'" title="'+d+'">'+(a||views[b].gViewDisplayName)+"</a></li>").insertAfter("#bookmarksMenu li:first");Bookmarks.validateAndSaveMessages("add",{pk:f,dialog:$("#BookmarkNameEdit")})}$("#BookmarkNameEdit").dialog("close")}});hideProgress()}function openBookmarksManager(){var a="guid=654321";var b=FloatingDialog.Show("/Durados/BookmarksManager/durados_Link","Manage Bookmarks",a,true,654321,true);b.attr("adding","hide");FloatingDialog.TheDialog.bind("dialogclose",function(c,d){var e=location.href.split("#")[0];if(e.indexOf("refreshBookmarks=refresh")>-1){location.reload()}else{e+=e.indexOf("?")==-1?"?":"&";location.href=e+"refreshBookmarks=refresh"}})}Durados.TreeView={moveNodes:{selectedKeys:"",toolBarLabel:"",el:null},assignLeavesToTree:function(a,b){if(!Durados.TreeView.moveNodes.selectedKeys){Durados.TreeView.moveNodes.el=b;Durados.TreeView.moveNodes.selectedKeys=Multi.GetSelection(a).join(",");if(!Durados.TreeView.moveNodes.selectedKeys){alert("No selection made!");return}Durados.TreeView.moveNodes.toolBarLabel=Durados.TreeView.moveNodes.el.innerHTML;Durados.TreeView.moveNodes.el.innerHTML="Cancel"}else{Durados.TreeView.moveNodes.el.innerHTML=Durados.TreeView.moveNodes.toolBarLabel;Durados.TreeView.moveNodes.selectedKeys="";Durados.TreeView.moveNodes.el=null}},initTreeView:function(f,d,c,e){var b=rootPath+views[c].Controller+"/TreeOneLevelNodes/"+f;var a=rootPath+views[c].Controller+"/EditTreeNode/"+f+"?viewName="+f;var c=c;var f=f;var e=e;$("#TreeInnerDiv").bind("before.jstree",function(h,g){}).jstree({rtl:$("body").attr("dir")=="rtl",plugins:["themes","json_data","ui","crrm","dnd","contextmenu"],json_data:{ajax:{url:b,data:function(g){return{operation:"get_children",id:g.attr?g.attr("id").replace("node_",""):""}}}},search:{ajax:{url:b,data:function(g){return{operation:"search",search_str:g,id:n.attr?n.attr("id").replace("node_",""):1}}}},ui:{},core:{},themes:{url:rootPath+"Content/tree/themes/default"+(($("body").attr("dir")=="rtl")?"-rtl":"")+"/style.css",theme:"default"+(($("body").attr("dir")=="rtl")?"-rtl":""),dots:true,icons:true}}).bind("select_node.jstree",function(m,k){if(Durados.TreeView.moveNodes.selectedKeys){$.post(a,{operation:"assign_to_node",id:$(k).attr("id").replace("node_",""),keys:Durados.TreeView.moveNodes.selectedKeys,itemsView:views[c].gViewName,guid:c},function(p){Durados.TreeView.moveNodes.el.innerHTML=Durados.TreeView.moveNodes.toolBarLabel;Durados.TreeView.moveNodes.selectedKeys="";Durados.TreeView.moveNodes.el=null;if(p.status){refreshView(c)}else{ajaxNotSuccessMsg("Operation Failed",c)}});return false}var o=$(k.rslt.obj).attr("id").replace("node_","");refreshView(c,e+"="+o+"&children=true","");var j=GetJsonFilter(c);for(var h=0,g=j.Fields.length;h<g;++h){var l=j.Fields[h].Value;if(l.Name==e){l.Value=o}}}).bind("create.jstree",function(h,g){$.post(a,{operation:"create_node",id:g.rslt.parent.attr("id").replace("node_",""),title:g.rslt.name,guid:c},function(j){if(j.status){$(g.rslt.obj).attr("id","node_"+j.id)}else{$.jstree.rollback(g.rlbk)}})}).bind("remove.jstree",function(h,g){$(g).each(function(){var j=null;$.ajax({async:false,type:"POST",url:a,data:{operation:"remove_node",id:this.id.replace("node_",""),guid:c},success:function(k){j=k}});if(!j||!j.status){modalErrorMsg(j)}else{$(this).remove()}})}).bind("rename.jstree",function(h,g){$.post(a,{operation:"rename_node",id:g.rslt.obj.attr("id").replace("node_",""),title:g.rslt.new_name,guid:c},function(j){if(!j.status){$.jstree.rollback(g.rlbk)}})}).bind("move_node.jstree",function(h,g){g.rslt.o.each(function(j){$.ajax({async:false,type:"POST",url:a,data:{operation:"move_node",id:$(this).attr("id").replace("node_",""),ref:g.rslt.cr===-1?1:g.rslt.np.attr("id").replace("node_",""),title:g.rslt.name,copy:g.rslt.cy?1:0,guid:c},success:function(k){if(!k.status){$.jstree.rollback(g.rlbk)}else{$(g.rslt.oc).attr("id","node_"+k.id);if(g.rslt.cy&&$(g.rslt.oc).children("UL").length){g.inst.refresh(g.inst._get_parent(g.rslt.oc))}}}})})})}};var Data;if(!Data){Data={}}Data.GetScalar=function(d,c,e,b){var a=null;showProgress();url=rootPath+views[b].Controller+"/GetScalar/"+d;$.ajax({url:url,contentType:"application/json; charset=utf-8",data:{viewName:d,pk:c,fieldName:e},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(f){a=f}});hideProgress();return a};var Diagnostics;if(!Diagnostics){Diagnostics={}}Diagnostics.GetButtons=function(a){var b={};b[translator.cancel]=function(){Diagnostics.Cancel()};return b};Diagnostics.Diagnose=function(h){Diagnostics.endDiagnose=false;showProgress();var f=FloatingDialog.Show(null,"Diagnostics",null,true);var g=Diagnostics.GetButtons(f);f.dialog("option","buttons",g);f.attr("class","diagnoseDialog");var d=$("<p></p>");f.append(d);f.status=d;var j=$("<div></div>");f.append(j);f.views=j;j.height(f.height()-50);d.html("started...");var a="";var c=Multi.GetSelection(h);var b=rootPath+"Durados/StartDiagnose/";$.ajax({url:b,contentType:"application/json; charset=utf-8",data:{pks:Sys.Serialization.JavaScriptSerializer.serialize(c)},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(k){a=k}});var e=a.split(",");Diagnostics.DiagnoseView(e,0,f)};Diagnostics.DiagnoseView=function(a,b,c){if(b>=a.length||Diagnostics.endDiagnose){setTimeout(function(){c.status.html("endded...")},1);setTimeout(function(){url=rootPath+"Durados/EndDiagnose/";$.ajax({url:url,contentType:"application/json; charset=utf-8",data:{},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(e){setTimeout(function(){c.dialog("close");hideProgress()},1000)}})},1000);return}var d=a[b];url=rootPath+"Durados/Diagnose/"+d;$.ajax({url:url,contentType:"application/html; charset=utf-8",data:{viewName:d},async:false,dataType:"html",cache:false,error:ajaxErrorsHandler,success:function(e){++b;c.status.html(b+" out of "+a.length);c.views.prepend($("<p>"+d+"</p>"));setTimeout(function(){Diagnostics.DiagnoseView(a,b,c)},1)}})};Diagnostics.Cancel=function(){Diagnostics.endDiagnose=true};function Dictionary(c,b){var a=Multi.GetSelection(b);var a=Multi.GetSelection(b);var d;if(a.length==1){d=a[0]}else{modalErrorMsg("Please select a view.");return}var e=GetViewNameByPK(d);c=c.replace("xxx",e);window.location=c}function GetViewNameByPK(a){var b="";url=rootPath+"Durados/GetViewNameByPK/";$.ajax({url:url,contentType:"application/html; charset=utf-8",data:{pk:a},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(c){b=c}});return b}var Messages;if(!Messages){Messages={}}Messages.Show=function(b,a){showProgress();setTimeout(function(){var c=rootPath+"MessageBoard/FilterByView/"+b+"?viewName="+b;var d=SearchDialog.CreateAndOpen(b,"Messages","","",c,a,null,null,null,null);hideProgress()},10)};function sync(c,b){var a=Multi.GetSelection(b);var a=Multi.GetSelection(b);if(a.length==0){modalErrorMsg("Please select a view.");return}$.ajax({url:c,contentType:"application/html; charset=utf-8",data:{configViewPks:String(a)},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(d){if(d.success){modalSuccessMsg(d.message)}else{modalErrorMsg(d.message)}}})}function showSpryFormats(b){var a=$("#SpryFormatsTooltip");if(!a.length){return}var c=$(b).offset();a.css("top",c.top+18).css("left",c.left).show()}function hideSpryFormats(a){$("#SpryFormatsTooltip").hide()}var DuradosNADate=new Date(1930,0,1);datePickerBeforeShow=function(a){setTimeout(function(){if($(a).datepicker("widget").find("button.ui-datepicker-na").length){return}var c=$(a).datepicker("widget").find(".ui-datepicker-buttonpane");var b=$('<button class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all ui-datepicker-na" type="button">N/A</button>');b.unbind("click").bind("click",function(){$(a).datepicker("setDate",DuradosNADate);$(a).datepicker("hide");triggerDateChanged("#"+a.id)});b.appendTo(c)},1)};datePickerOnChangeMonthYear=function(a){setTimeout(function(){if($(a).datepicker("widget").find("button.ui-datepicker-na").length){return}var c=$(a).datepicker("widget").find(".ui-datepicker-buttonpane");var b=$('<button class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all ui-datepicker-na" type="button">N/A</button>');b.unbind("click").bind("click",function(){$(a).datepicker("setDate",DuradosNADate);$(a).datepicker("hide");triggerDateChanged("#"+a.id)});b.appendTo(c)},1)};var EditView;if(!EditView){EditView={}}EditView.open=function(c,e,d){var f="/Admin/InlineEditingEdit/";var b=InlineEditingDialog.CreateAndOpen2(e,d,null,null,f,null,null,c,true,function(o,k,p,m,h,j,l){var g="/Admin/RefreshConfig/";showProgress();refreshConfig(g,null,true);reloadPage();hideProgress()});b.dialog("option","width",1000);var a=InitAccordion(null,1000,c);if(!a){InitTabs(null,1000)}slider.InitSlider(null)};var Page;if(!Page){Page={}}Page.edit=function(b){var e="/Admin/InlineEditingEdit/";var c=InlineEditingDialog.CreateAndOpen2("Page","Page",null,null,e,null,null,b,true,function(m,j,o,l,g,h,k){var f="/Admin/RefreshConfig/";showProgress();refreshConfig(f,null,true);reloadPage();hideProgress()});c.dialog("option","width",1000);var a=InitAccordion(null,1000,b);if(!a){InitTabs(null,1000)}slider.InitSlider(null);var d={dialog:c,viewName:"Page"};initPageDependency(d)};var UploadConfig;if(!UploadConfig){UploadConfig={}}UploadConfig.Open=function(b,a){d_Dialog.CreateAndOpen(b,a,"durados_UploadConfig","Upload Configuration");$(d_Dialog).bind("PerformMethod",function(d,c){var f=c.dialog.find("#"+a+inlineAddingPrefix+"FileName").val();if(f==""){ajaxNotSuccessMsg("Please upload the configuration zip file");return}showProgress();$.post(rootPath+views[a].Controller+"/UploadConfig/",{fileName:f},function(e){hideProgress();if(!e.success){ajaxNotSuccessMsg(e.message)}else{modalSuccessMsg(e.message);$.ajax({url:"/Admin/Restart",contentType:"application/html; charset=utf-8",dataType:"json",async:false,success:function(g){refreshMainContent()},error:function(j,g,h){refreshMainContent()}})}})});hideProgress()};var Charts;if(!Charts){Charts={}}Charts.run=function(){Dashboard.run("chart","Charts");$(".chart").each(function(){var a=$(this).attr("id");Charts.load(a)})};Charts.load=function(f,a){var c="/Home/GetChartData/";var b=!a||a==false;var e=location.search;var d=null;$.ajax({url:c,contentType:"application/html; charset=utf-8",data:{chartId:f,queryString:e},dataType:"json",async:b,success:function(g){if(b){$("#"+f).empty()}if(g.Type){$("#"+f).height(g.Height);if(b){if(g.table&&g.table==true){}else{$("#"+f).show();Charts.build(g,f)}if(g.ShowTable){$("#"+f+"Table").load("/Home/GetChartData/",{chartId:f,queryString:e,isTable:true}).show();if(g.Type=="Table"){$("#"+f).hide();$("#"+f+"Table").height(g.height)}}else{$("#"+f+"Table").hide()}}else{d=g}}else{Charts.message(f,g)}},error:function(j,g,h){}});if(!b&&d!=null){return d}};Charts.deleteChart=function(a){$.ajax({url:"/Admin/DeleteChart?chartId="+a.replace("Chart",""),contentType:"application/html; charset=utf-8",data:{chartId:a},async:true,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(b){location.reload()}})};Charts.edit=function(d){var c="/Admin/InlineEditingEdit/";var b=$("#"+d).height();var a=InlineEditingDialog.CreateAndOpen2("Chart","Chart",null,null,c,null,null,d.replace("Chart",""),true,function(m,k,f,g,l,j,h){var o="/Admin/RefreshConfig/";showProgress();refreshConfig(o,null,true);var e=j.find('input[name="Height"]').val();if(parseInt(e)==parseInt(b)){Charts.load(d)}else{location.reload()}hideProgress()});initChartDependency(a,d);a.dialog("option","width",840);a.dialog("option","height",575);new Spry.Widget.ValidationTextField("nullinlineEditing_Height","integer",{isRequired:true,useCharacterMasking:true,minValue:160,maxValue:1000});$(Durados.View).bind("getErrorsList",function(g,f){f.cancel=true;f.message="Height must be between 160 to 1000 pixels"})};Charts.message=function(b,a){$("#"+b).empty();$("#"+b).html('<div align="center" style="verticalAlign: middle">'+a+"</div>")};Charts.savePosition=function(e,c){var a="/Admin/SetChartData/";var b=[];var d=0;$(".column").each(function(){$(this).find(".portlet").each(function(){var g=$(this).attr("chartId");if(g){var f=$(this).parent("div").attr("columnid");b.push({Id:g.replace("Chart",""),Column:f,Ordinal:d});d=d+1}})});$.post(a,{data:Sys.Serialization.JavaScriptSerializer.serialize(b)})};var myCharts=[];Charts.build=function(b,c){Highcharts.theme={colors:["rgb(27,160,133)","rgb(243,101,35)","rgb(93,187,169)","rgb(248,138,85)","rgb(13,119,97)","rgb(243,185,88)","#eeaaee","#55BF3B","#DF5353","#7798BF","#aaeeee"],chart:{backgroundColor:{linearGradient:[241,241,241,400],stops:[[0,"rgb(241, 241, 241)"],[1,"rgb(241, 241, 241)"]]},borderWidth:0,borderRadius:0,plotBackgroundColor:null,plotShadow:false,plotBorderWidth:0},title:{style:{color:"Black",font:"16px Arial bold"}},subtitle:{style:{color:"Black",font:"12px Arial"}},xAxis:{gridLineWidth:0,lineColor:"rgb(86, 86, 86)",tickColor:"rgb(86, 86, 86)",labels:{style:{color:"rgb(86, 86, 86)",fontWeight:"bold"}},title:{style:{color:"rgb(86, 86, 86)",font:"bold 12px Arial"}}},yAxis:{alternateGridColor:null,minorTickInterval:null,gridLineColor:"rgba(86, 86, 86, .2)",lineWidth:0,tickWidth:0,labels:{style:{color:"rgb(86, 86, 86)",fontWeight:"bold"}},title:{style:{color:"rgb(86, 86, 86)",font:"bold 12px Arial"}}},legend:{itemStyle:{color:"rgb(86, 86, 86)"},itemHoverStyle:{color:"rgb(86, 86, 86)"},itemHiddenStyle:{color:"rgb(86, 86, 86)"},borderWidth:0,backgroundColor:"rgb(255, 255, 255)",shadow:false,align:"center",y:0},labels:{style:{color:"rgb(86, 86, 86)"}},tooltip:{backgroundColor:{linearGradient:[255,255,255,50],stops:[[0,"rgba(255, 255, 255, .8)"],[1,"rgba(255, 255, 255, .8)"]]},borderWidth:0,style:{color:"rgb(86, 86, 86)"}},plotOptions:{line:{dataLabels:{color:"#CCC"},marker:{lineColor:"#333"}},spline:{marker:{lineColor:"#333"}},scatter:{marker:{lineColor:"#333"}},candlestick:{lineColor:"white"}},toolbar:{itemStyle:{color:"#CCC"}},navigation:{buttonOptions:{backgroundColor:{linearGradient:[0,0,0,20],stops:[[0.4,"#606060"],[0.6,"#333333"]]},borderColor:"#000000",symbolStroke:"#C0C0C0",hoverSymbolStroke:"#FFFFFF"}},exporting:{buttons:{exportButton:{symbolFill:"#55BE3B"},printButton:{symbolFill:"#7797BE"}}},rangeSelector:{buttonTheme:{fill:{linearGradient:[0,0,0,20],stops:[[0.4,"#888"],[0.6,"#555"]]},stroke:"#000000",style:{color:"#CCC",fontWeight:"bold"},states:{hover:{fill:{linearGradient:[0,0,0,20],stops:[[0.4,"#BBB"],[0.6,"#888"]]},stroke:"#000000",style:{color:"white"}},select:{fill:{linearGradient:[0,0,0,20],stops:[[0.1,"#000"],[0.3,"#333"]]},stroke:"#000000",style:{color:"yellow"}}}},inputStyle:{backgroundColor:"#333",color:"silver"},labelStyle:{color:"silver"}},navigator:{handles:{backgroundColor:"#666",borderColor:"#AAA"},outlineColor:"#CCC",maskFill:"rgba(16, 16, 16, 0.5)",series:{color:"#7798BF",lineColor:"#A6C7ED"}},scrollbar:{barBackgroundColor:{linearGradient:[0,0,0,20],stops:[[0.4,"#888"],[0.6,"#555"]]},barBorderColor:"#CCC",buttonArrowColor:"#CCC",buttonBackgroundColor:{linearGradient:[0,0,0,20],stops:[[0.4,"#888"],[0.6,"#555"]]},buttonBorderColor:"#CCC",rifleColor:"#FFF",trackBackgroundColor:{linearGradient:[0,0,0,10],stops:[[0,"#000"],[1,"#333"]]},trackBorderColor:"#666"},legendBackgroundColor:"rgba(48, 48, 48, 0.8)",legendBackgroundColorSolid:"rgb(70, 70, 70)",dataLabelsColor:"#444",textColor:"#E0E0E0",maskColor:"rgba(255,255,255,0.3)"};var a=Highcharts.setOptions(Highcharts.theme);if(myCharts[c]){myCharts[c].destroy();myCharts[c]=null}myCharts[c]=Charts.GetChart(b,c);$(".highcharts-data-labels div span").css("color","#999")};Charts.GetChart=function(a,b){switch(a.Type.toLowerCase()){case"gauge":return Charts.GetGuageChart(a,b);default:return Charts.GetBasicChart(a,b)}};Charts.GetGuageChart=function(a,b){return new Highcharts.Chart({chart:{renderTo:b,type:"gauge"},title:{text:a.Title},subtitle:{text:a.SubTitle},pane:{startAngle:-150,endAngle:150,background:[{backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#FFF"],[1,"#333"]]},borderWidth:0,outerRadius:"109%"},{backgroundColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,"#333"],[1,"#FFF"]]},borderWidth:1,outerRadius:"107%"},{},{backgroundColor:"#DDD",borderWidth:0,outerRadius:"105%",innerRadius:"103%"}]},yAxis:{min:a.MinValue,max:a.MaxValue,minorTickInterval:"auto",minorTickWidth:1,minorTickLength:10,minorTickPosition:"inside",minorTickColor:"#666",tickPixelInterval:30,tickWidth:2,tickPosition:"inside",tickLength:10,tickColor:"#666",labels:{step:2,rotation:"auto"},plotBands:[{from:a.greenFrom,to:a.greenTo,color:"#55BF3B"},{from:a.yellowFrom,to:a.yellowTo,color:"#DDDF0D"},{from:a.redFrom,to:a.redTo,color:"#DF5353"}]},series:a.Data},function(d){if(!d.renderer.forExport){if(a.RefreshInterval<=3){return}var c="refreshInterval"+b;clearInterval(Charts[c]);Charts[c]=setInterval(function(){if(d.series===undefined){return}var e=d.series[0].points[0];var g=Charts.load(b,true);var f=g.Data[0].data[0];e.update(f)},a.RefreshInterval*1000)}})};Charts.GetBasicChart=function(a,b){return new Highcharts.Chart({chart:{renderTo:b,type:a.Type},title:{text:a.Title},subtitle:{text:a.SubTitle},xAxis:{categories:a.xAxis,title:{text:a.XTitle}},yAxis:{min:a.Neg?null:0,title:{text:a.YTitle,align:"high"}},tooltip:{formatter:function(){return""+this.series.name+": "+this.y}},plotOptions:{bar:{dataLabels:{enabled:true}}},credits:{enabled:false},series:a.Data})};var Dashboard;if(!Dashboard){Dashboard={}}Dashboard.run=function(d,e,j){var b=e==null?"":"#"+e+" ";var c=false;var f=b+"[isEnabled]";var g=$(f);if(g.length){c=g.attr("isEnabled")=="False"}Dashboard.initSortable(d,b,j,c);Dashboard.initHeaders(d,b);var h=$("#"+j+"DataRowEdit");var a=h.find('input[name="Excluded"]');$("table.portlet-content").each(function(){if($(this).find("tr").length<=1){var k=$(this).prev().find("span.ui-icon-minusthick");var l=$(this).parent().attr("partofpk")=="partofpk";if(views[j].ViewName=="Field"&&!l){k.removeClass("ui-icon-minusthick").removeClass("ui-icon").addClass("ui-icon-delete").attr("title",translator.Delete).unbind("click").bind("click",function(){Durados.Dialogs.Confirm("Delete Column Confirmation","Are you sure that you want to delete this column?",function(){Durados.CheckBox.SetChecked(a,true);h.attr("changed","no");a.change()},null)})}else{k.hide()}}});if(views.length>0){if(views[j].ViewName=="Field"&&views[j].Role=="View Owner"){a.parents("tr:first").hide()}}if(d=="chart"){setTimeout(function(){Dashboard.loadPortlets()},1)}};Dashboard.initHeaders=function(d,c){var a="<span class='ui-icon ui-icon-minusthick'></span>";if(d=="chart"){var b=$(c+"#editChartCaption").val();if(b){a="<a class='delete-chart'><span class='button-icon' title='Delete Chart'></span><a/><a class='ui-chart edit-chart' href='#'><span class='button-icon'></span>"+b+"</a>"}else{a="<span></span>"}}$(c+".portlet").addClass("ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").find(".portlet-header").addClass("ui-widget-header ui-corner-all").prepend(a).end().find(".portlet-content");if(d!="chart"){$(c+".portlet-header .ui-icon").click(function(){$(this).toggleClass("ui-icon-minusthick").toggleClass("ui-icon-plusthick");$(this).parents(".portlet:first").find(".portlet-content").toggle()})}else{$(c+".portlet-header .ui-chart").click(function(){var e=$(this).parents(".portlet:first").find(".chart:first").attr("id");Charts.edit(e)});$(c+".portlet-header .delete-chart").click(function(){var e=$(this).parents(".portlet:first").find(".chart:first").attr("id");Durados.Dialogs.Confirm("Delete Chart","Are you sure the you want to delete this chart?",function(){Charts.deleteChart(e)})})}};Dashboard.initSortable=function(e,d,a,b){var c=0;$(d+".column").mousedown(function(h){try{if(document.activeElement&&document.activeElement.blur){var f=document.activeElement}if(f&&f.blur&&f.nodeName!="BODY"){document.activeElement.blur()}}catch(g){}}).sortable({connectWith:".column",disabled:b,distance:15,cancel:"[cancelDrag=cancelDrag]",update:function(h,j){if(e!="chart"){Dashboard.savePosition(this,j,a);try{if(views[a].ViewName=="Field"&&plugIn()){showProgress();setTimeout(function(){plugInRefresh()},100)}else{if(isDockFields(a)){try{if(adminPreviewChanged){var f=$("#"+a+"DataRowEdit");f.parent().find("button.ui-button").each(function(){if($(this).text()==translator.save){$(this).click();return}})}window.parent.parent.Refresh(window.parent.parent.getMainPageGuid(),true)}catch(g){}}}}catch(g){}}else{Charts.savePosition(this,j)}}}).disableSelection().each(function(){$(this).attr("columnId",++c);if(a!=null&&views[a]!=null){views[a].sortDashboard[c.toString()]=$(this).sortable("toArray")}})};Dashboard.savePosition=function(f,l,k){if(k==null){return}var p=views[k].ViewName;var g=views[k].Controller;var b=rootPath+g+"/ChangeOrdinal/"+p;var h=l.item.attr("id");var a=$(f).attr("columnId");var q=views[k].sortDashboard[a];var d=q.join(",").indexOf(h);var c=$(f).sortable("toArray");var j=c.join(",").indexOf(h);var m=d<j?"down":"up";var o=l.item.attr("pk");var e=m=="up"?l.item.next().attr("pk"):l.item.prev().attr("pk");views[k].sortDashboard[a]=c;$.post(b,{o_pk:o,d_pk:e,guid:k},function(){try{if(views[k].ViewName=="Field"&&plugIn()){hideProgress()}}catch(r){}})};Dashboard.loadPortlets=function(){$(".portlet[d_type='grid']").each(function(){var a=$(this);Dashboard.loadPortlet(a)})};Dashboard.loadPortlet=function(e){var b=e.find(".portlet-link").find("a").attr("href");var d=e.find("input[name='ViewName']").val();var a=e.find("input[name='guid']").val();var c=e.find(".portlet-grid");$.ajax({url:b,contentType:"application/html; charset=utf-8",data:{viewName:d,guid:a,mainPage:"False",safety:false},async:true,dataType:"html",cache:false,error:ajaxErrorsHandler,success:function(f){c.html(f);success(a);resetElementScrollsPosition(a)}})};Durados.Dependencies={fieldsHandled:[],createHandlers:function(e,b,a,f,c){if(!e||!e.length){return}var d=function(){var g=$(this).parents('div[role="dialog"]').first();if(!g.length){return}var h;if($(this).attr("multiple")){h=$(this).val();if(h){h=h.join(",")}}else{if($(this).attr("type")=="checkbox"){h=Durados.CheckBox.IsChecked($(this))}else{h=$(this).val()}}var k=$(this).attr("name");Durados.Dependencies.Apply(k,h,b,g,a);var j=this;f=f||views[b].ViewName;$(Durados.Dependencies).trigger("OnDependenciesChange",{guid:b,dialog:g,viewName:f,fieldVal:h,fieldName:k,elm:j,prefix:c})};Durados.Dependencies.fieldsHandled.push(e);e.focus(function(){var g=$(this).data("oldVal")}).change(d)},Apply:function(c,e,o,t,a){if(!a&&!views[o].jsonViewForEdit){return}var p=a||views[o].jsonViewForEdit.Fields;var w;var v=false;for(var d=0,u=p.length;d<u;d++){if(p[d].Key==c){v=true;w=p[d].Value.DependencyData;break}}if(!v||!w){return}if(!e){e=""}var h=e.split(",");var f=w.split("|");var g=parseInt(f[0])||0;$(t).find("select,input,textarea,li[childrenFieldName],div[childrenFieldName]").each(function(){var j=$(this);var k=j.attr("disSource");if(k){if(k==c+"~"){Durados.Dependencies.toggleField(j,"enable",g);j.attr("disSource","")}else{if(k.indexOf(c+"~")>-1){j.attr("disSource",k.replace(c+"~",""))}}}});for(var d=0,u=p.length;d<u;d++){if(w.indexOf(p[d].Key)<0){continue}for(var s=1;s<f.length;s++){var m=f[s].split(";");var b=m[0].split(",");for(var r=0;r<b.length;r++){if(jQuery.inArray(b[r],h)>-1){var l=m[1].split(",");for(var q=0;q<l.length;q++){$(t).find('[name="'+l[q]+'"],[childrenFieldName="'+l[q]+'"]').each(function(){var j=$(this);var k=j.attr("disSource")||"";if(!k){if(!j.attr("disabled")){Durados.Dependencies.toggleField(j,"disable",g);j.attr("disSource",c+"~")}}else{if(k.indexOf(c+"~")==-1){j.attr("disSource",k+c+"~")}}})}}}}}},toggleField:function(a,b,c){if(a.is("div")){Durados.Dependencies.toggleSubgrid(a,b,c)}if(a.is("li")){Durados.Dependencies.toggleTab(a,b,c)}if(b=="enable"){if(!c){if(a.hasClass("dropdownchecklist")){a.dropdownchecklist("enable")}else{a.removeAttr("disabled")}a.parents("TD.rowViewCell").first().find("img").show()}else{if(c==1){a.parents("TD.rowViewCell").first().css("visibility","visible").prev().css("visibility","visible")}else{if(c==2){a.parents("TD.rowViewCell").first().css("display","").prev().css("display","")}}}}else{if(b=="disable"){if(!c){if(a.hasClass("dropdownchecklist")){a.dropdownchecklist("disable")}else{a.attr("disabled","disabled")}a.parents("TD.rowViewCell").first().find("img").hide()}else{if(c==1){a.parents("TD.rowViewCell").first().css("visibility","hidden").prev().css("visibility","hidden")}else{if(c==2){a.parents("TD.rowViewCell").first().css("display","none").prev().css("display","none")}}}}}},toggleTab:function(a,d,e){var c=a.attr("newUrl");a.find("a").attr("nocache","nocache");if(d=="enable"){if(a.attr("childrenDisabled")=="childrenDisabled"){c=c+"&disabled=False";var b=parseInt(a.attr("index"));a.parents("div:first").tabs("url",b,c);a.removeAttr("childrenDisabled")}else{a.find("a").removeAttr("nocache")}}else{if(d=="disable"){if(a.attr("childrenDisabled")!="childrenDisabled"){c=c+"&disabled=True";var b=parseInt(a.attr("index"));a.parents("div:first").tabs("url",b,c);a.attr("childrenDisabled","childrenDisabled")}}}},toggleSubgrid:function(c,a,b){if(a=="enable"){c.parents("td").first().css("visibility","visible").prev("td").css("visibility","visible")}else{if(a=="disable"){c.parents("td").first().css("visibility","hidden").prev("td").css("visibility","hidden")}}},cleanUp:function(){while(Durados.Dependencies.fieldsHandled.length){var a=Durados.Dependencies.fieldsHandled.pop();a.unbind("change");if(a.attr("disSource")){if(a.hasClass("dropdownchecklist")){$el.dropdownchecklist("enable")}else{a.removeAttr("disabled")}a.attr("disSource","")}}}};var displayFormatNames={None:"",SingleLine:"Single Line",MultiLines:"Multi Lines",MultiLines:"Multi Lines",MultiLinesEditor:"Multi Lines Editor",NumberWithSeparator:"Number With Separator",Date_mm_dd:"Date (05/28/2013)",Date_dd_mm:"Date (28/05/2013)",Date_mm_dd_12:"DateTime (05/28/2013 01:10:00 PM)",Date_dd_mm_12:"DateTime (28/05/2013 01:10:00 PM)",Date_mm_dd_24:"DateTime (05/28/2013 13:10:00)",Date_dd_mm_24:"DateTime (28/05/2013 13:10:00)",Date_Custom:"Custom",DropDown:"Drop Down",AutoCompleteStratWith:"Auto Complete Start With",AutoCompleteMatchAny:"Auto Complete Match Any",GeneralNumeric:"General",DocumentReference:"Document Reference",Hyperlink:"Link",ButtonLink:"Button",Checklist:"Check List",SubGrid:"Sub Grid"};var displayFormatRalation={ShortText:["SingleLine","MultiLines","MultiLinesEditor","Html","Email","Password","SSN","Phone","DocumentReference"],LongText:["MultiLines","MultiLinesEditor","SingleLine","Html"],Image:["Crop","Fit"],Url:["Hyperlink","ButtonLink"],Numeric:["GeneralNumeric","Currency","NumberWithSeparator","Percentage"],Boolean:[],DateTime:["Date_mm_dd","Date_dd_mm","Date_mm_dd_12","Date_dd_mm_12","Date_mm_dd_24","Date_dd_mm_24","Date_Custom"],Email:["Email"],Html:["Html"],SingleSelect:["DropDown","AutoCompleteStratWith","AutoCompleteMatchAny"],MultiSelect:["Checklist","SubGrid"],ImageList:["Tile","Slider"]};var isPlugIn=false;function IsPlugIn(){try{return(window.parent&&window.parent.parent&&window.parent.parent.location.href.split("?")[0].indexOf("PlugIn")!=-1)||(window.parent&&window.parent.parent&&window.parent.parent.parent&&window.parent.parent.parent.location.href.split("?")[0].indexOf("PlugIn")!=-1)}catch(a){return false}}var isItem=false;function IsItem(){try{return isItem!=null&&isItem==true}catch(a){return false}}filterDataTypes=function(b){var a=["MultiSelect","ImageList"];removeOptions(b,a)};filterDataTypes2=function(b){var a=["ImageList","Email"];removeOptions(b,a)};filterDataFormats=function(b){var a=["Password","MultiLines","Html","Email","DocumentReference","TimeOnly"];removeOptions(b,a)};removeOptions=function(a,b){a.find("option").each(function(){var c=$(this);$(b).each(function(){if(c.val()==this){c.remove()}})})};var displayFormatOriginalOptions=null;filterDisplayFormat2=function(c,b){if(b.viewName=="Field"){isChange=(c.type=="OnDependenciesChange");isAdd=(b.prefix==inlineAddingPrefix||b.prefix==createPrefix);var a=$(b.dialog).find("select[name='DataType']");if(!isChange){if(a.length>0){b.elm=a[0]}else{return}}if(b.elm==null||b.elm.name!="DataType"||$(b.elm).val()==null||$(b.elm).val()==""){return}if(views[b.guid].Role=="View Owner"&&!isAdd){alert(a.data("pre"));Durados.Dialogs.Confirm(translator.ChangeTypeTitle,translator.ChangeTypeMessage,function(){filterDisplayFormat2(c,b)},null)}else{filterDisplayFormat2(c,b)}}};function getPrevVal(e){var d=PreviewDisplayModeViewJson;var c=null;for(var b=0,a=d.Fields.length;b<a;++b){if(d.Fields[b].Key==e){c=d.Fields[b].Value.Value;break}}return c}var dataTypeGroups={ShortText:1,LongText:1,Image:1,Url:1,Html:2,Numeric:3,Boolean:4,DateTime:5,SingleSelect:6,MultiSelect:7,ImageList:8,Email:1};function allowChangeDataType(a,b){return dataTypeGroups[a]==dataTypeGroups[b]}var syncLink=false;function addSyncLink(a){syncLink=true;var b=$('<a href="#" class="settings-sync" title="Sync database changes">Sync Changes</a>');a.find('[name="DisplayName"]').parent("td").append(b.click(function(){var c=a.find('[name="Name"]').val();window.parent.parent.showProgress();setTimeout(function(){$.ajax({url:"/Admin/Sync2/"+c,contentType:"application/html; charset=utf-8",async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(d){window.parent.parent.hideProgress();if(d.success){try{window.parent.parent.reloadPage()}catch(e){}}else{modalErrorMsg(d.message)}}})},1000)}))}function syncAll(){var a=function(){showProgress();setTimeout(function(){$.ajax({url:"/Admin/SyncAll/",contentType:"application/html; charset=utf-8",async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(b){hideProgress();if(b.success){try{reloadPage()}catch(c){}}else{modalErrorMsg(b.message)}}})},1000)};Durados.Dialogs.Confirm("Sync All","Sync all the views will take a while. Proceed?",a)}function syncError(a,b){showProgress();setTimeout(function(){$.ajax({url:"/Admin/Sync2/"+b,contentType:"application/html; charset=utf-8",async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(c){window.parent.parent.hideProgress();if(c.success){try{window.location=a}catch(d){}}else{modalErrorMsg(c.message)}}})},1000)}var confirmChangeType=false;var confirmChangeTypePrevVal=null;filterDisplayFormat=function(s,w){if(w.viewName=="Field"){isChange=(s.type=="OnDependenciesChange");isAdd=(w.prefix==inlineAddingPrefix||w.prefix==createPrefix);if(!isChange){var u=$(w.dialog).find("select[name='DataType']");if(u.length>0){w.elm=u[0]}else{return}}if(w.elm==null||w.elm.name!="DataType"||$(w.elm).val()==null||$(w.elm).val()==""){return}if(views[w.guid].Role=="View Owner"){filterDataTypes($(w.elm))}else{filterDataTypes2($(w.elm))}if(w.prefix==createPrefix||w.prefix==editPrefix){var m=$(w.dialog).find("input[name='RelatedViewName']");m.attr("disabled",$(w.elm).val()!="SingleSelect"&&$(w.elm).val()!="MultiSelect"&&$(w.elm).val()!="ImageList")}var k=$(w.dialog).find("textarea[name='Formula']");var a=k.val();var f=a!=null&&a!="";var j=isAdd?null:getPrevVal("DataType");var l=$(w.elm).val();var p=isAdd||allowChangeDataType(j,l);confirmChangeTypePrevVal=j;confirmChangeType=(isChange&&!isAdd&&!f&&!IsPlugIn()&&views[w.guid].Role!="View Owner"&&!p);if(displayFormatRalation==null){loadDisplayFormatRelation()}var d=$(w.dialog).find("select[name='DisplayFormat']");if(d.length>0){var t=d[0];var g=$(t).val()||"";if(isChange||isAdd||g=="None"){g=""}$(t).find("option").remove().end();if(displayFormatRalation.hasOwnProperty($(w.elm).val())){$(t).append('<option value="None"></option>').val("");var b=displayFormatRalation[$(w.elm).val()];for(var r=0;r<b.length;r++){var y=b[r];var o=displayFormatNames[y]||y;$(t).append('<option value="'+y+'" >'+o+"</option>")}$(t).val(g)}}if(views[w.guid].Role=="View Owner"){filterDataFormats(d)}removeOptions(d,["TimeOnly"])}else{if(w.viewName=="View"){var q=$(w.dialog).find("select[name='WorkspaceID']");var c=$(w.dialog).find("select[name='Menu_Parent']");Dependency.Load(w.viewName,"Menu_Parent",q.val(),c,w.guid,null,"/Admin/GetSelectList/");q.change(function(){Dependency.Load(w.viewName,"Menu_Parent",q.val(),c,w.guid,null,"/Admin/GetSelectList/")});if(!syncLink&&views[w.guid].Role!="View Owner"&&w.guid!=pageGuid){addSyncLink(w.dialog)}noMenuUrl(w)}else{if(w.viewName=="Page"){initPageDependency(w)}else{if(w.viewName=="FtpUpload"){initFtpDependency(w)}else{if(w.viewName=="Menu"){if(w.originElementId){var c=$("#"+w.originElementId);if(c.length==1){var h=c.parents("form:first").find("select[name='WorkspaceID']");if(h.length==1){var x=h.val();var v=$(w.dialog).find("select[name='WorkspaceID']");v.attr("disabled",true);if(v.length==1){v.val(x)}}}}isAdd=(w.prefix==inlineAddingPrefix||w.prefix==createPrefix);if(!isAdd){w.dialog.find('select[name="WorkspaceID"]').change(function(){showMsgInModalDialog("All other Views and Pages that associate with this Menu will be assigned to the selected Workspace")})}}else{if(w.viewName=="durados_Link"){Bookmarks.loadMessagesForLinkView(s,w)}}}}}}};function noMenuUrl(e){var j=$(e.dialog).find("input[name='Name']").val();if(!j){return}var d=$(e.dialog).find("input[name='SystemView']");var l=d.parents("table:first").parents("table:first");if(!l){return}var h="IFrame URL:";l.append("<tr><td>"+h+"</td></tr>");var g=$("<tr></tr>");l.append(g);var b=$('<td colspan="2"></td>');g.append(b);var k=$('<textarea class="wtextareashort" disabled="disabled"></textarea>');b.append(k);var f=$(e.dialog).find("input[name='Controller']").val();if(!f){f="Home"}var c=$(e.dialog).find("input[name='IndexAction']").val();if(!c){c="Index"}var a=window.location.protocol+"//"+window.location.host+"/"+f+"/"+c+"/"+j+"?menu=off";k.val(a)}$(Durados.View).bind("edit",function(b,a){filterDisplayFormat(b,a)});$(Durados.View).bind("add",function(b,a){filterDisplayFormat(b,a)});$(Durados.Dependencies).bind("OnDependenciesChange",function(b,a){filterDisplayFormat(b,a)});function initPageTab2(e,g,d){var c="ui-tabs-selected";var b="ui-state-active";var f="ui-tabs-hide";var a=$(d.children("ul")[0]).children("li");a.each(function(){$(this).removeClass(c);$(this).removeClass(b)});d.tabs("option","disabled",[0,1,2,3]);if(g=="Content"){d.tabs("enable",0);Durados.Tabs.select(d,0)}else{if(g=="IFrame"){d.tabs("enable",1);Durados.Tabs.select(d,1)}else{if(g=="External"){d.tabs("enable",2);Durados.Tabs.select(d,2)}else{if(g=="ReportingServices"){d.tabs("enable",3);Durados.Tabs.select(d,3)}}}}}function initFtpTab(b,c,a){initTabDependencyChange(b,c,a,[0,1,2])}function initTabDependencyChange(f,h,e,a){var d="ui-tabs-selected";var c="ui-state-active";var g="ui-tabs-hide";var b=$(e.children("ul")[0]).children("li");b.each(function(){$(this).removeClass(d);$(this).removeClass(c)});e.tabs("option","disabled",a);$(a).each(function(){if(h==this){e.tabs("enable",parseInt(this));e.tabs("select",parseInt(this))}})}function initPageTab(c,k){var a="ui-tabs-selected";var f="ui-state-active";var d="ui-tabs-hide";var j=k.val();var b=c.dialog.find("div.ui-tabs");var e=b.children("div.ui-tabs-panel");e.each(function(){$(this).addClass(d)});var h=$(b.children("ul")[0]).children("li");h.each(function(){$(this).removeClass(a);$(this).removeClass(f)});if(j=="Content"){b.tabs("option","active",0);var g=$(h[0]);g.addClass(a);g.addClass(f);$(e[0]).removeClass(d);b.tabs("option","disabled",[1,2,3])}else{if(j=="IFrame"){b.tabs("option","active",1);var g=$(h[1]);g.addClass(a);g.addClass(f);$(e[1]).removeClass(d);b.tabs("option","disabled",[0,2,3])}else{if(j=="External"){b.tabs("option","active",2);var g=$(h[2]);g.addClass(a);g.addClass(f);$(e[2]).removeClass(d);b.tabs("option","disabled",[0,1,3])}else{if(j=="ReportingServices"){b.tabs("option","active",3);var g=$(h[3]);g.addClass(a);g.addClass(f);$(e[3]).removeClass(d);b.tabs("option","disabled",[0,1,2])}}}}}function initFtpDependency(c){var b=c.dialog.find("div.ui-tabs");var a=c.dialog.find('select[name="StorageType"]');var d=a.val()=="Ftp"?0:a.val()=="Azure"?1:2;changeUploadLabel(c.dialog,a.val());initFtpTab(c,d,b);a.change(function(){d=a.val()=="Ftp"?0:a.val()=="Azure"?1:2;changeUploadLabel(c.dialog,a.val());initFtpTab(c,d,b)})}function changeUploadLabel(a,c){var b="Folder / Container / Bucket:";switch(c){case"Ftp":b="Folder:";break;case"Azure":b="Container:";break;case"Aws":b="Bucket:";break;default:b="Folder / Container / Bucket:";break}a.find('input[name="DirectoryBasePath"]').parent("td:first").prev().text(b)}function initPageDependency(d){var a=$(d.dialog).find("select[name='WorkspaceID']");var g=$(d.dialog).find("select[name='PageMenu_Parent']");Dependency.Load(d.viewName,"PageMenu_Parent",a.val(),g,d.guid,null,"/Admin/GetSelectList/");a.change(function(){Dependency.Load(d.viewName,"PageMenu_Parent",a.val(),g,d.guid,null,"/Admin/GetSelectList/")});var c=d.dialog.find("div.ui-tabs");var b=d.dialog.find('select[name="PageType"]');var e=getMainPageGuid();if(!((e)&&(views[e].Role=="Developer"))){b.attr("disabled","disabled")}var f=b.val();initPageTab2(d,f,c);b.change(function(){f=b.val();initPageTab2(d,f,c)})}function initChartDependency(a,c){var b={data:{dialog:a,chartId:c}};Charts.changeChartType(b);a.find("select[name=ChartType]").unbind("change").bind("change",{dialog:a,chartId:c},Charts.changeChartType)}Charts.changeChartType=function(b){var c=b.data;var d=c.chartId;var a=c.dialog.find("select[name=ChartType]");switch(a.val()){case"Gauge":c.dialog.find(".ChartParameters").parent().parent().hide();c.dialog.find('span.SeperatorTitle:contains("Chart Parameters")').closest("tr").hide();c.dialog.find(".GaugeParameters").parent().parent().show();c.dialog.find('span.SeperatorTitle:contains("Gauge Parameters")').closest("tr").show();break;default:clearInterval(Charts["refreshInterval"+d]);c.dialog.find(".ChartParameters").parent().parent().show();c.dialog.find('span.SeperatorTitle:contains("Chart Parameters")').closest("tr").show();c.dialog.find(".GaugeParameters").parent().parent().hide();c.dialog.find('span.SeperatorTitle:contains("Gauge Parameters")').closest("tr").hide()}};Charts.startDashboard=function(a){Charts.run();$("select#chartColumns").change(function(){showProgress();var b=location.search.substring(1,location.search.length);window.location.href="/Admin/EditDashboard?id="+a+"&columns="+$(this).val()+"&"+b;hideProgress()})};FilterForm.InitTreeFilter=function(){$(".tree_filter li").live("click",function(b){var e=$(b.target).parents(".tree-filter-values");var d=e.attr("data-rel");if(d!=null){var a=e.attr("data-guid");var c=$(b.target).attr("data-val");$("#"+d).attr("data-val",c);e.hide();FilterForm.Apply(false,a,null)}});$(".tree_filter_selectedValues .close").live("click",function(){var b=$(this).prev().attr("id");var a=$(this).attr("data-guid");$(this).prev().attr("data-val","");FilterForm.Apply(false,a,null)})};FilterForm.LessFilterValues=function(d){var c="#"+d+"_more_items";var b="#"+d+"_more";var a="#"+d+"_less";$(c).hide();$(b).show();$(a).hide()};FilterForm.MoreFilterValues=function(e,g,c,f){var d="#"+f+"_more_items";var b="#"+f+"_more";var a="#"+f+"_less";if($(d).length){$(d).show();$(b).hide();$(a).show()}else{showProgress();$.post(views[c].allFilterValuesUrl,{viewName:e,fieldName:g,guid:c},function(h){$(b).parents(".tree-filter-values").html(h);hideProgress()})}};Durados.BeforeUnload=function(a,b){Durados.DisplayType.UnloadByDisplayType(a,b)};Durados.DisplayType={changeDisplayType:function(b,a){if(views[b]!=null){if(views[b].DataDisplayType=="Preview"){var c=$("#"+b+"DataRowEdit");c.dialog("close")}Durados.BeforeUnload(b,true);views[b].DataDisplayType=a}refreshView(b,"dataDisplayType="+a,{needChangeDisplayType:true})},InitByDisplayType:function(b){var a=views[b].DataDisplayType;switch(a){case"Preview":var c=Multi.GetSelection(b);PreviewDisplay.Run(b);break;default:break}},UnloadByDisplayType:function(b,c){var a=views[b].DataDisplayType;switch(a){case"Preview":PreviewDisplay.Unload(b,c);break;default:break}}};var PreviewDisplay={scrollX:0,scrollY:0,selectedPk:null,prevDialogSettings:[],views:[],isFirstTime:function(b){var a=false;if($.inArray(b,views)==-1){a=true;views.push(b)}return a},selectFirstRow:function(a,b){var d=$("#"+a+" .portlet:first");if(d.length){if($.browser.mozilla){setTimeout(function(){d.click()},1000)}else{d.click()}}else{var c=$("#"+b+"DataRowEdit");if(c.dialog("isOpen")){c.dialog("close")}}},Run:function(c){var b=PreviewDisplay.isFirstTime(c);if(b){PreviewDisplay.savePrevDialogSettings(c)}var a=c+"previewContainer";if(b){if($.browser.mozilla){$("#"+a).parents(".fixedViewPort:first").css("display","inline-block")}}Dashboard.run("Preview",a,c);if(b){PreviewDisplay.selectFirstRow(a,c)}else{PreviewDisplay.loadElementState(c)}},Unload:function(a,b){PreviewDisplay.trySaveChanges(a);if(b){PreviewDisplay.loadPrevDialogSettings(a);views.pop(a)}else{PreviewDisplay.saveElementState(a)}PreviewDisplay.selectedPk=null},savePrevDialogSettings:function(d){var e=$("#"+d+"DataRowEdit");var g=views[d].gViewName;var c=Rectangle.Load(g);var b;var f;var a;if(c!=null){b=c.height;f=c.width;a=[c.left,c.top]}else{b=e.dialog("option","height");f=e.dialog("option","width");a=e.dialog("option","position")}PreviewDisplay.prevDialogSettings[d]={height:b,width:f,modal:e.dialog("option","modal"),closeOnEscape:e.dialog("option","closeOnEscape"),resizable:e.dialog("option","resizable"),position:a,zIndex:Durados.Dialogs.zIndex(e)};e.attr("changed","no")},loadPrevDialogSettings:function(a){var b=$("#"+a+"DataRowEdit");var c=PreviewDisplay.prevDialogSettings[a];if(c!=null){b.dialog("close");b.dialog("option","height",c.height);b.dialog("option","width",c.width);b.dialog("option","modal",c.modal);b.dialog("option","closeOnEscape",c.closeOnEscape);b.dialog("option","resizable",c.resizable);b.dialog("option","position",[c.position.left,c.position.top]);Durados.Dialogs.zIndex(b,c.zIndex)}},initDialogSettings:function(m,e){var l=m+"_editContainer";var g=$("#"+l);if(g.length){var h=$("#"+m+"DataRowEdit");var k=h.siblings(".ui-dialog-titlebar");var f=k.find("a.ui-dialog-titlebar-max");var a=f.attr("d_state");if(a=="max"||IE7){dialogExt.resize(h,f,m)}k.hide();var p=g.height()-4;var c=g.width()-5;var o=g.offset().top;var d=g.offset().left;var b=EditDialog.AllowEdit(m,e);h.dialog("option","height",p);h.dialog("option","width",c);h.dialog("option","modal",false);h.dialog("option","closeOnEscape",false);h.dialog("option","resizable",false);h.dialog("option","position",[d,o]);Durados.Dialogs.zIndex(h,0);var j=EditDialog.GetButtons(e,m,true,!b.disabled);h.dialog("option","buttons",j);var q=83;shortcutKey(h,j[translator.save],q,true);h.css("padding-top","0")}},trySaveChanges:function(a){var b=$("#"+a+"DataRowEdit");var c=b.attr("changed")=="yes";if(c&&PreviewDisplay.selectedPk!=null){if(confirm("You made changes. Do you want to save changes?")){EditDialog.Update(PreviewDisplay.selectedPk,a,false,false,false,true)}}},adjustSize:function(f,k){var b=$("#"+f+"previewContainer");if(b.length){var a=k-b.offset().top-42;b.height(a)}var g=$("#"+f+"_editContainer");if(g.length){var d=k-g.offset().top-44;g.height(d);var e=$("#"+f+"DataRowEdit");var j=g.width();var h=g.offset().top;var c=g.offset().left;e.dialog("option","height",d-3);e.dialog("option","width",j-5);e.dialog("option","position",[c,h])}},saveElementState:function(b){var a;if(b){a=$("#"+b+"previewContainer").first()}if(!a.length){return}PreviewDisplay.scrollY=a.scrollTop();PreviewDisplay.scrollX=a.scrollLeft();var c=a.find(".boardselected");PreviewDisplay.selectedPk=c.attr("d_pk")},loadElementState:function(b,f){if(b==null){return}var a;var d=false;a=$("#"+b+"previewContainer").first();if(!a.length){return}if(PreviewDisplay.selectedPk!=null){var c=a.find("[d_pk="+PreviewDisplay.selectedPk+"]");if(c.length){d=true;c.addClass("boardselected");var e=$("#"+b+"DataRowEdit").attr("pk");if(PreviewDisplay.selectedPk!=e){c.parent().click()}if(PreviewDisplay.scrollY){a.scrollTop(PreviewDisplay.scrollY)}if(PreviewDisplay.scrollX){a.scrollLeft(PreviewDisplay.scrollX)}c.scrollintoview()}}if(!d){PreviewDisplay.selectFirstRow(b+"previewContainer",b)}}};Durados.Common={increaseCssValue:function(a,c,f){var b=$(a);if(!b.length==1){return}var d=parseInt(b.css(c).replace("px",""));var e=d+f;b.css(c,e)}};Durados.Dialogs={Wait:function(c,e,d,a,f){var b=$("<div></div>").appendTo("body").append(c).dialog({modal:true,title:e,zIndex:10000,autoOpen:f,width:d?d:"auto",height:a?a:"auto",position:["center","center"],resizable:false,open:function(){if(!e){$(this).dialog("widget").find(".ui-dialog-titlebar").hide()}$(".ui-widget-overlay").css({opacity:0.6,filter:"Alpha(Opacity=60)"})}});return b},Confirm:function(f,j,b,k,h,c,g,d){if(!f){f="Confirmation"}if(!j){j="Are you sure?"}if(!d){d="center"}if(!c){c="Yes"}if(!g){g="No"}var e={};e[c]=function(){if(b){b(a)}$(this).dialog("close")};e[g]=function(){if(k){k(a)}$(this).dialog("close")};var a=$("<div></div>");a.appendTo("body").html('<div class="confirm-message">'+j+"</div>").dialog({modal:true,title:f,zIndex:100000002,autoOpen:true,width:"auto",resizable:false,position:d,buttons:e,open:function(l,m){$(this).parent().find("div.ui-dialog-buttonpane").attr("style","display:block !important");if(h){h(a)}},close:function(l,m){$(this).remove()}});return a},Alert:function(b,a,c){if(!b){b=""}if(!a){a=""}$("<div></div>").appendTo("body").html('<div class="confirm-message">'+a+"</div>").dialog({modal:true,title:b,zIndex:2147480000,autoOpen:true,width:"auto",resizable:false,buttons:{Ok:function(){$(this).dialog("close");if(c){c()}}},close:function(d,e){$(this).remove()}})},general:function(e,b,c,f,d){var a=$("<div></div>").attr("style","min-height: 0px !important").appendTo("body").html(b).dialog({modal:true,title:e,zIndex:1000000,autoOpen:true,width:"auto",resizable:false,buttons:c,close:function(g,h){if(f){f()}$(this).remove()}});if(d!=null){a.addClass(d)}return a},save:function(c,a,d){if(!c){c="Save"}if(!a){a=$("<div/>")}var b={};b[translator.saveAndClose]=function(){if(d){d()}$(this).dialog("close")};b[translator.close]=function(){$(this).dialog("close")};return Durados.Dialogs.general(c,a,b)},BindToChangeEvent:function(a,b){b.find(a).unbind("change",Durados.Dialogs.DialogChanged).bind("change",{dialog:b},Durados.Dialogs.DialogChanged)},DialogChanged:function(b){var a=b.data.dialog;if(a!=null){a.attr("changed","yes")}},zIndex:function(a,b){if(b==null){return a.parent().css("zIndex")}else{a.parent().css("zIndex",b)}}};Durados.SplitLayout={adjustSplitContentHeight:function(a,c){var b=$(a);if(b.length){var d=c-b.offset().top;b.height(d);if(a=="#AppFilterTreeDiv"){if(b.children().length>1){$(b.children()[1]).height(d)}}else{b.children(":first").height(d)}}},initSplitter:function(d,b,f,a,c){var e=this;$(d).click(function(){if(c){if(!c(this)){return}}if($(b).width()>0){e.hideSplitContent(b,d,a)}else{e.showSplitContent(b,d,f)}})},hideSplitContent:function(c,f,e){var d=$(c);if(d.length){var a=d.children(":first");var b="#mainAppDiv";$(a).hide();$(d).width(0);if($("body").attr("dir")!="rtl"){Durados.Common.increaseCssValue(b,"marginLeft",-200);Durados.Common.increaseCssValue(f,"right",-4)}else{Durados.Common.increaseCssValue(b,"marginRight",-200);Durados.Common.increaseCssValue(f,"left",-4)}Durados.GridHandler.setHeadersDivWidth();if(e){e()}}},showSplitContent:function(c,f,e){var d=$(c);if(d.length){var a=d.children(":first");var b="#mainAppDiv";$(d).width(200);$(a).show();if($("body").attr("dir")!="rtl"){Durados.Common.increaseCssValue(b,"marginLeft",200);Durados.Common.increaseCssValue(f,"right",4)}else{Durados.Common.increaseCssValue(b,"marginRight",200);Durados.Common.increaseCssValue(f,"left",4)}Durados.GridHandler.setHeadersDivWidth();if(e){e()}}}};function initSplitters(){Durados.SplitLayout.initSplitter("#TreeSplitterBar","#AppTreeDiv",function(){var a=$("#mainAppDiv");$("#AppFilterTreeDiv").addClass("filter_tree_with_margin");if($("body").attr("dir")!="rtl"){$("#AppFilterTreeDiv").css("marginLeft","")}else{}},function(){$("#AppFilterTreeDiv").removeClass("filter_tree_with_margin");$("#AppFilterTreeDiv").css("marginLeft",4)});Durados.SplitLayout.initSplitter("#FilterTreeSplitterBar","#AppFilterTreeDiv",null,null,function(b){var a=$(b).attr("data-guid");$("#"+a+"ajaxDiv [name=rowfilter]").first().hide();var c=$("#"+a+"filterButton");if(c.length){c.click();return false}else{return true}})}Durados.Tabs={select:function(b,a){b.tabs("select",a)},url:function(c,b,a){c.find("a").attr("href",b)}};function setPlan(a){$(Durados.View).trigger("setPlan",{elm:a})}slider.UpdateSelectedImage=function(b){var a=$(b);var c=a.parents("div.slider-container").first().find("input[type=hidden]");a.parents("ul").find(".ui-slider-item").removeClass("slider-active");a.addClass("slider-active");c.val(a.attr("value")).change()};slider.SetLoadSelectedImage=function(a){a.parents(".slider-container").each(function(){var f=$(this);var e=f.find("div.ui-slider-item[value="+a.val()+"]");e.addClass("slider-active");var d=$("body").attr("dir")=="rtl";var c=f.find(".panel:not(.cloned)").index(e.parent())+1;if(d){var b=f.find(".panel:not(.cloned)").length;c-=2;if(c<=0){c=b+c}}f.find(".ui-slider").anythingSlider(c)})};Durados.CheckBox={IsChecked:function(a){return a.attr("checked")=="checked"||a.attr("checked")||a.prop("checked")},SetChecked:function(b,a){if(a==""||a==null){a=false}b.attr("checked",a)}};Durados.Image={Init:function(){},ShowDialog:function(a){$("<div></div>").appendTo("body").html('<div class="confirm-message"><a target="_blank" href="'+$(a).attr("src")+'"><img style="margin: 0px auto; display: block;" src="'+$(a).attr("src")+'"></img></a></div>').dialog({modal:true,title:"View Image",zIndex:10000,autoOpen:true,width:"auto",height:"auto",resizable:false,buttons:{Close:function(){$(this).dialog("close")}},close:function(b,c){$(this).remove()}})},SetSize:function(h){var a=$(h).attr("src");if(a==null||a==""){return}var g=$(h).parents("td:first");if(!g.hasClass("d_fieldContainer")){return}var b=$(h).parents("div:first");var o=g.height();var d=g.width();$(h).css("width","auto");$(h).css("height","auto");var k=$(h).height();var j=$(h).width();var m=$(h).attr("format");b.height(o);b.width(d);if(m=="Fit"){var e=k/j;var l=o/d;if(e>l){$(h).height(o);$(h).width(o/e)}else{$(h).width(d);$(h).height(d*e)}if($(h).height()<o){var c=(o/2-$(h).height()/2);$(h).css("margin-top",c+"px")}else{$(h).css("margin-top","0px")}}else{$(h).parent().parent().css("width",d+"px");var c=(o/2-k/2);$(h).css("margin-top",c+"px");if(j>d){var f=(d/2-j/2);$(h).css("margin-left",f+"px")}else{$(h).css("margin-left","0px")}}b.css("overflow","hidden");$(h).parent().parent().show();$(h).css("display","inline-block")},Init:function(){$("img[dialog]").click(function(){Durados.Image.ShowDialog($(this));return false})}};Durados.Preview={xOffset:10,yOffset:30,tooltipTimeout:0,xMouse:0,yMouse:0,init:function(){$("[preview]:not(.preview-init)").addClass("preview-init").hover(function(b){var a=this;if($(a).is("img")){var c=$(a).attr("src");if(c==null||c==""){return}}Durados.Preview.xMouse=b.pageX;Durados.Preview.yMouse=b.pageY;a._title=$(a).attr("title");$(a).attr("title","");Durados.Preview.tooltipTimeout=setTimeout(function(){Durados.Preview.showPreview(a)},1000)},Durados.Preview.hidePreview).mousemove(function(a){Durados.Preview.xMouse=a.pageX;Durados.Preview.yMouse=a.pageY;$("#preview").css("top",(Durados.Preview.yMouse-Durados.Preview.xOffset)+"px").css("left",(Durados.Preview.xMouse+Durados.Preview.yOffset)+"px")})},hidePreview:function(){clearTimeout(Durados.Preview.tooltipTimeout);$(this).attr("title",this._title);$("#preview").remove()},showPreview:function(c,d){var b=Durados.Preview.getPreviewElement(c);var a=$("<p>").attr("id","preview").append(b);$("body").append(a);a.css("top",(Durados.Preview.yMouse-Durados.Preview.xOffset)+"px").css("left",(Durados.Preview.xMouse+Durados.Preview.yOffset)+"px").fadeIn("fast")},getPreviewElement:function(d){var b=$(d);var a=$("<div>");if(b.is("img")){var e=(d._title!="")?"<br/>"+d._title:"";a=$("<span>").append($("<img>").attr("src",b.attr("src")).attr("alt","Image preview")).append(e)}else{if(b.is(".richTextContainer")){var c=b.parents("td:first").css("text-align");a=b.clone();a.css("text-align",c)}}return a}};Durados.Indications={fitToWindowWidth:function(b){var d=false;if(b==null||views[b]==null){return d}var c=views[b].GridDisplayType;var a=views[b].DataDisplayType;if(a=="Table"&&c=="FitToWindowWidth"){d=true}return d},isMainGrid:function(a){return getMainPageGuid()==a}};function num(a){return parseInt(a,10)||0}var zIndexImport=100000001;function duradosImport(e,b,d,a){var c=null;var f="#"+c+e+"durados_Import";Excel.Import(e,null,true,b,d,a);zIndexImport=zIndexImport+1000;Durados.Dialogs.zIndex($(f),zIndexImport);$(f).parent().find("div.ui-dialog-buttonpane").attr("style","display:block !important");if(d==null){$(f).dialog({height:280});$(f).dialog({width:440})}else{$('div[name="ImportAddTemplate"]').hide();$('div[name="importTypeDiv"]').hide();$("#nullViewdurados_Import").parent().find('button span:contains("Run")').text("Next");$("#nullViewdurados_Import").dialog({width:740});$("#nullViewdurados_Import").dialog({height:280})}}function isMobile(){try{return $("#isMobile").val()=="yes"}catch(a){return false}}function isMaximizeDialog(a){var b=queryString("max");return(b=="yes"||b=="yes#")||views[a].OpenDialogMax=="True"}var Bookmarks;if(!Bookmarks){Bookmarks={loadMessagesForLinkView:function(d,c){if($(c.dialog).find('select[name="GrobootMessages"]').length<1){return}var f=c.dialog.find('select[name="GrobootMessages"]');var a=$(c.dialog).find('select[name="GrobootMessages"] > option');if(a.length<1||(a.length==1&&a[0].value=="")){var g=Bookmarks.getAvailableMessagesFromGB();if(g.success){for(var b in g.messages){message=g.messages[b];$(f).append($("<option></option>").attr("value",message.Id).text(message.Content))}initDropdownchecklist(f,null,200)}else{modalErrorMsg(g.description)}}$.post("/Home/GetSelectedGrobootNotificationMessages",{bookmarkId:c.pk}).done(function(j){if(j.success){for(var h in j.selectedIds){var e=j.selectedIds[h];$(f).find("option[value="+e+"]").attr("selected",true)}$(f).dropdownchecklist("refresh")}else{modalErrorMsg(j.description)}}).fail(function(e){modalErrorMsg("failed to get groboot selected messages for this bookmark")})},getAvailableMessagesFromGB:function(){var a={success:false};$.ajax({type:"POST",url:"/Home/GetAvailableGrobootNotificationMessages",success:function(b){a=b},error:function(b){modalErrorMsg("failed to get groboot Available messages for this bookmark")},async:false});return a},validateAndSaveMessages:function(b,c){var a=getCheckListValues((c.dialog).find('select[name="GrobootMessages"]'));if(a.length<1){return true}$.post("/Home/SetBookmarkGrobootNotificationMessages",{bookmarkId:c.pk,messages:a}).done(function(d){if(d.success){}else{modalErrorMsg(d.description)}})},validateGrobootViews:function(d,c){var a=getCheckListValues($(c).find('select[name="GrobootMessages"]'));if(a.length<1){return true}var f=false;var b="/Home/ValidateBookmarkGrobootNotificationView";var e={bookmarkId:d};$.ajax({type:"POST",url:b,data:e,success:function(g){if(g.success){f=true}else{modalErrorMsg(g.description);f=false}},async:false});return f},getBookmarkNotificationChecklist:function(e){var d=Bookmarks.getAvailableMessagesFromGB();if(d.success){if(!d.messages||d.messages.length==0){return""}var b=$("<tr></tr>");$(b).append("<td></td>").html("pushApp Notification:");var c=$("<td></td>");var f=$("<select></select").attr("id",e+"_GBmessagesChecklist").attr("name","GrobootMessages").attr("role","childrenCheckList");$(c).append(f);$(b).append(c);$("div#"+e).find("table").append(b);initDropdownchecklist(f,null,200);$(f).append($("<option></option>").text("(All)").attr("value",null).attr("selected",false));for(var a in d.messages){message=d.messages[a];$(f).append($("<option ></option>").attr("value",message.Id).text(message.Content))}initDropdownchecklist(f,null,200)}},initgbChecklist:function(a){var b=$(a).find('select[name="GrobootMessages"]');if(!$(b).length){return}$(b).find("option").each(function(){$(this).attr("selected",false)});$(b).dropdownchecklist("refresh")}}}logTitle={initiate:function(){$("#mainMenu > div.logo-title-container > div.title-settings > span.desc-icon").click(function(){logTitle.openDialog($(this))})},openDialog:function(b){var f=$(".title-container").text().trim();var e=$("#logo").attr("src");var c=queryString2(e,"pk");var g=queryString2(e,"fileName");var d='<div><div class="uploadDiv " id="durados_App_e10_edit_upload_Image" name="Image"><span class="gbutton" id="durados_App_e10_edit_upload_span_Image">Select an Image</span><img style="visibility: visible;" id="durados_App_e10_edit_upload_img_Image" class="upload-logo" src="/MultiTenancy/Download/durados_App?fieldName=Image&amp;filename=&amp;pk='+c+'" title="Logo" alt="Logo" uploadpath="/MultiTenancy/Download/durados_App?fieldName=Image&amp;filename=__filename__&amp;pk="><input type="text" id="durados_App_e10_edit_Image" name="Image" upload="Select an Image" value="" viewname="durados_App" pk="" autocomplete="on" d_file="'+g+'"></div><input name="title" class="input-title" type="text" value="'+f+'"/></div>';var a=null;if(b){a=[b.position().left,b.position().top+75]}Durados.Dialogs.Confirm("Edit Logo and Title",d,function(h){f=h.find(".input-title").val();logo=h.find("#durados_App_e10_edit_Image").val();logTitle.submit(c,f,logo,g)},null,function(j){var m="Image";var h="durados_App_e10_";var k=editPrefix;var l="durados_App";UploadFile(m,k,h,l);showUpload(m,k,g,$("#"+h+k+"upload_img_"+m).attr("UploadPath")+c,h)},"Update","Cancel",a)},submit:function(a,c,b,d){$.ajax({url:"/MultiTenancy/UpdateLogoTitle",contentType:"application/json; charset=utf-8",data:{pk:a,logo:b,title:c},async:false,dataType:"json",cache:false,error:ajaxErrorsHandler,success:function(f){$(".title-container span:first").text(c);var e=$("#logo").attr("src");$("#logo").attr("src",e.replace(d,b))}})}};function IsViewSettings(){try{if(parent&&parent.parent&&parent.parent.location.href){var b=queryString2(parent.parent.location.href,"settings");return b=="true"||b=="true#"}else{return false}}catch(a){return false}}jQuery.fn.extend({insertAtCaret:function(a){return this.each(function(e){if(document.selection){var d=jQuery(this).css("direction");this.focus();var f=document.selection.createRange();f.text=a;this.focus()}else{if(this.selectionStart||this.selectionStart=="0"){var c=this.selectionStart;var b=this.selectionEnd;var g=this.scrollTop;this.value=this.value.substring(0,c)+a+this.value.substring(b,this.value.length);this.focus();this.selectionStart=c+a.length;this.selectionEnd=c+a.length;this.scrollTop=g}else{this.value+=a;this.focus()}}})}});function getTopWindowGuid(){return window.top.$("#mainAppDiv").find("div.fixedViewPort").first().attr("d_fix")}function inIframe(){try{return window.self!==window.top}catch(a){return true}}var Dictionary2;if(!Dictionary2){Dictionary2={addDictionaryLink:function(c,a){if(!a||a==""){a=getTopWindowGuid()}$(c).unbind("dialogbeforeclose",this.close).bind("dialogbeforeclose",{dialog:c,guid:a},this.close);var d=c.find("[dicType]:not([disabled]");var b=d.add(c.find("[dicType]:[disabled]:hidden"));b.each(function(){var h=this;var f=a+$(h).attr("name")+"_dic_span";if($(h).parent().find("span#"+f).length){return}var e=$(h).attr("dicType");var g=$('<span id="'+f+'" class="dic-link" title="click here to use dictionary"></span>');$(h).parent("td").append(g.click(function(){Dictionary2.CreateAndOpen(g,h,e,c,a)}))})},CreateAndOpen:function(e,h,d,c,a){if($(e).attr("dic-state")=="open"){return}var b=$(h).attr("dictionaryView");if(b){var g=c.find('[name="'+b+'"]');var f=g.val();if(g.is("select")){f=g.find('option[value="'+f+'"]').text()}}else{f=$(h).attr("viewName")}$.ajax({url:"/Block/GetDictionary/"+f,data:{dicType:d},contentType:"application/html; charset=utf-8",async:false,cache:false,error:ajaxErrorsHandler,success:function(l){try{var k=l.indexOf("$$error$$",0);if(k>=0&&k<=1000){modalErrorMsg(l.replace("$$error$$",""));return}var j=a+$(h).attr("name")+"_dictionary";var o=c;if(IsViewSettings()){window.top.Dictionary2.open(j,a,c,l,h,d,e)}else{Dictionary2.open(j,a,c,l,h,d,e)}$(e).attr("dic-state","open")}catch(m){}}})},open:function(e,d,c,b,h,j,k){var g=j=="PlaceHolders"?"Sytem tokens":"Columns";var f=$('<div id="'+e+'" name="'+d+'_dictionary"></div>').appendTo(c).append(b).dialog({modal:false,title:g,autoOpen:true,width:"400px",resizable:false,minHeight:0,dialogClass:"dictionary-dialog",create:function(){$(this).css("maxHeight",400)},close:function(){var l=$(this);l.remove();l.dialog("destroy");$(k).removeAttr("dic-state")},buttons:{Close:function(){$(this).dialog("close")}}});$(f).find("td span.dic-curr").click(function(){var l=h;var m=$(this).attr("value");$(l).insertAtCaret(m.trim())});if(j=="InternalNames"||j=="InternalNamesPlaceHolders"){var a=$(f).find("td span.dic-prev").click(function(){var l=h;var m=$(this).attr("Value");$(l).insertAtCaret(m.trim())});$(a).each(function(){$(this).show()})}},close:function(a){var b;if(IsViewSettings()&&inIframe()){window.top.Dictionary2.close(a)}else{b=$('[name="'+a.data.guid+'_dictionary"]')}if(b&&b.length){b.each(function(){$(this).dialog("close")})}}}}$(Durados.View).bind("edit",function(b,a){Dictionary2.addDictionaryLink(a.dialog,a.guid)});$(Durados.View).bind("add",function(b,a){Dictionary2.addDictionaryLink(a.dialog,a.guid)});function editValueInCurrentRow(d,c){var a=getMainPageGuid();var b=Multi.GetSingleSelection(a);editValueInCurrentView(d,c,b)}function editValueInCurrentView(e,c,b){var a=getMainPageGuid();var d=getMainViewName();editValue(d,e,c,b,a)}function editValue(d,e,c,b,a){$.post("/Home/EditValue/"+d,{fieldName:e,value:c,pk:b,guid:a},function(f){if(f!="success"){ajaxNotSuccessMsg(f);return}})}function isOracle(a){return views[a].SqlProduct=="Oracle"}function HandleProduct(b,a){if(a.viewName=="Field"&&!isOracle(a.guid)){$("input[name='AutoIncrementSequanceName']").closest("table").closest("td").hide();$("input[name='AutoIncrement']").closest("table").closest("td").hide()}}$(Durados.View).bind("edit",function(b,a){HandleProduct(b,a)});$(Durados.View).bind("add",function(b,a){HandleProduct(b,a)});$(Durados.Dependencies).bind("OnDependenciesChange",function(b,a){HandleProduct(b,a)});