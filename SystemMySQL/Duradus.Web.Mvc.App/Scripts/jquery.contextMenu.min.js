if(jQuery){(function(){$.extend($.fn,{enableContextMenuLeftClick:function(){$(this).each(function(){$(this).addClass("enableContextMenuLeftClick")});return($(this))},contextMenu:function(a,b){if(a.menu==undefined){return false}if(a.inSpeed==undefined){a.inSpeed=150}if(a.outSpeed==undefined){a.outSpeed=75}if(a.inSpeed==0){a.inSpeed=-1}if(a.outSpeed==0){a.outSpeed=-1}$(this).each(function(){var c=$(this);var d=$(c).offset();$("#"+a.menu).addClass("contextMenu");$(this).mousedown(function(h){var g=$(this).hasClass("enableContextMenuLeftClick");var f=h;if(!isRightClick(f)&&!g){return}f.stopPropagation();$(this).mouseup(function(k){k.stopPropagation();var n=$(this);$(this).unbind("mouseup");if(!g&&isRightClick(f)||g&&isLeftClick(f)){$(".contextMenu").hide();var i=$("#"+a.menu);if($(c).hasClass("disabled")){return false}var l={},p,o;if(self.innerHeight){l.pageYOffset=self.pageYOffset;l.pageXOffset=self.pageXOffset;l.innerHeight=self.innerHeight;l.innerWidth=self.innerWidth}else{if(document.documentElement&&document.documentElement.clientHeight){l.pageYOffset=document.documentElement.scrollTop;l.pageXOffset=document.documentElement.scrollLeft;l.innerHeight=document.documentElement.clientHeight;l.innerWidth=document.documentElement.clientWidth}else{if(document.body){l.pageYOffset=document.body.scrollTop;l.pageXOffset=document.body.scrollLeft;l.innerHeight=document.body.clientHeight;l.innerWidth=document.body.clientWidth}}}(k.pageX)?p=k.pageX:p=k.clientX+l.scrollLeft;(k.pageY)?o=k.pageY:o=k.clientY+l.scrollTop;var m=c.parents('div[role="dialog"]');var j=(m.length>0);if(j){dialogOffset=m.offset();p=p-dialogOffset.left;o=o-dialogOffset.top;$(i).css("z-index","999999999")}var q=$(i).outerWidth();if($("body").attr("dir")=="rtl"){if(p>q+2){p-=q}}else{if(p+q>l.innerWidth){p-=q}}$(document).unbind("click");$(i).css({top:o,left:p}).fadeIn(a.inSpeed);$(i).find("A").mouseover(function(){$(i).find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){$(i).find("LI.hover").removeClass("hover")});$(document).keypress(function(r){switch(r.keyCode){case 38:if($(i).find("LI.hover").size()==0){$(i).find("LI:last").addClass("hover")}else{$(i).find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");if($(i).find("LI.hover").size()==0){$(i).find("LI:last").addClass("hover")}}break;case 40:if($(i).find("LI.hover").size()==0){$(i).find("LI:first").addClass("hover")}else{$(i).find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");if($(i).find("LI.hover").size()==0){$(i).find("LI:first").addClass("hover")}}break;case 13:$(i).find("LI.hover A").trigger("click");break;case 27:$(document).trigger("click");break}});$("#"+a.menu).find("A").unbind("click");$("#"+a.menu).find("LI:not(.disabled) A").click(function(){$(document).unbind("click").unbind("keypress");$(".contextMenu").hide();if(b){b($(this).attr("d_action"),$(n),{x:p-d.left,y:o-d.top,docX:p,docY:o})}return false});setTimeout(function(){$(document).click(function(){$(document).unbind("click").unbind("keypress");$(i).fadeOut(a.outSpeed);return false})},0)}});$(this).removeClass("enableContextMenuLeftClick")});if($.browser.mozilla){$("#"+a.menu).each(function(){$(this).css({MozUserSelect:"none"})})}else{if($.browser.msie){$("#"+a.menu).each(function(){$(this).bind("selectstart.disableTextSelect",function(){return false})})}else{$("#"+a.menu).each(function(){$(this).bind("mousedown.disableTextSelect",function(){return false})})}}$(c).add($("UL.contextMenu")).bind("contextmenu",function(){return false})});return $(this)},disableContextMenuItems:function(a){if(a==undefined){$(this).find("LI").addClass("disabled");return($(this))}$(this).each(function(){if(a!=undefined){var c=a.split(",");for(var b=0;b<c.length;b++){$(this).find('A[href="'+c[b]+'"]').parent().addClass("disabled")}}});return($(this))},enableContextMenuItems:function(a){if(a==undefined){$(this).find("LI.disabled").removeClass("disabled");return($(this))}$(this).each(function(){if(a!=undefined){var c=a.split(",");for(var b=0;b<c.length;b++){$(this).find('A[href="'+c[b]+'"]').parent().removeClass("disabled")}}});return($(this))},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return($(this))},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return($(this))},destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return($(this))}})})(jQuery)};