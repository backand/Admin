Durados.dropdowndiv={height:150,width:150,input:null,div:null,date1:null,date2:null,numeric1:null,numeric2:null,token:"&&%&",hide:function(){if(Durados.dropdowndiv.div&&Durados.dropdowndiv.div.length){Durados.dropdowndiv.div.hide();if(Durados.dropdowndiv.input!=null){Durados.dropdowndiv.input.unbind("keydown").unbind("keyup")}$(document).unbind("click",Durados.dropdowndiv.autoClose);Durados.dropdowndiv.div.attr("inputTarget","")}},autoClose:function(a){if(a.target!=null&&!$(a.target).closest("div.advancedFilterDialog").length&&!$(a.target).closest(".ui-datepicker").length&&!$(a.target).closest(".ui-datepicker-calendar").length&&$(a.target).attr("tagName")!="SPAN"&&$(a.target).attr("tagName")!="A"&&!$(a.target).hasClass("ui-datepicker-current")&&!$(a.target).parents(".ui-datepicker-header").length){if(Durados.dropdowndiv.input&&a.target!=Durados.dropdowndiv.input[0]){Durados.dropdowndiv.hide()}}},positionDialog:function(a,b){var d;var c=a.width()-num(b.css("padding-right"))-num(b.css("padding-left"));b.width(c);c=b.innerWidth();if($("body").attr("dir")=="rtl"){d=a.offset().left+a.width()-c;if(d<0){d=a.offset().left}}else{d=a.offset().left;if((d+c)>$(window).width()){d=a.offset().left+a.width()-c}}b.css("left",d).css("top",a.offset().top+a.height()+6)},show:function(e,d){$(document).bind("click",Durados.dropdowndiv.autoClose);var a=$(e);var c=a.attr("filterType");if(!c){return}Durados.dropdowndiv.div=$("#"+c);if(!Durados.dropdowndiv.div.length){return}var b=Durados.dropdowndiv.div;if(b.attr("inputTarget")==a.attr("id")&&b.is(":visible")){$("div.advancedFilterDialog").hide();Durados.dropdowndiv.positionDialog(a,b);Durados.dropdowndiv.div.show();return}$("div.advancedFilterDialog").hide();Durados.dropdowndiv.input=a;Durados.dropdowndiv.typeId=c;Durados.dropdowndiv.positionDialog(a,b);b.find("select").val("");b.find('input[type="text"]').val("");initAdvancedFilterHandlers(b);b.find(".date___").width(b.width()-20);initAdvancedFilterValues(b,d);b.show();b.attr("inputTarget",a.attr("id"));b.find("input:first").focus().select()},displayElementsByCompSign:function(a){var b=a.val();if(b.indexOf("empty")>-1){a.siblings(":not(.advancedFilterDialog-buttons)").hide()}else{a.siblings().show();if(b=="between"){a.siblings(".between").show()}else{a.siblings(".between").hide()}}},handleFilterValue:function(m){var u=m.val();if(u==null||u==""){m.attr("d_val","")}else{var e=m.attr("filterType");if(!e){return}var n=$("#"+e+" .filter-equal");if(!n.length){return}var k=u;var c=u;var h=Durados.dropdowndiv.token;var f=false;function i(x,w){var y=$(x).val();var v=$(w).val();return((y>v)?-1:((y<v)?1:0))}n.find("option").sort(i).each(function(){var x=$(this);var z="";if(e=="TextFilter"){z=$.trim(x.text())}else{var v=translator.between;if(u.match("^"+v)){z=$.trim(x.text())}else{z=x.val()}}if(u.match("^"+z)){var w=x.val();k=k.replace(z,h+w+h);if(e=="TextFilter"){c=u}else{if(w=="between"){var y=translator.to;k=k.replace(y,h+"To"+h);c=u}else{c=u.replace(z,$.trim(x.text()))}}f=true;return false}});if(!f){var q=$("#"+e);var a=getDefaultAdvancedFilterSign(q);var b=n.find('option[value="'+a+'"]');var l="";if(e=="TextFilter"){l=$.trim(b.text());if(!u.match('^"')){u='"'+u}if(!u.match('"$')){u=u+'"'}c=l+" "+u}else{u=$.trim(u);l=b.val();c=$.trim(b.text())+" "+u}k=h+a+h+" "+u;u=l+" "+u;m.val(u)}if(e=="DateFilter"){var o=k.split(h+"To"+h);var g=o[0];var j="";var p="";j=Durados.dropdowndiv.getComparerString(g,h,h);p=$.trim(g.replace(h+j+h,"").replace(/^\s\s*/,"").replace(/\s\s*$/,""));var r=m.attr("df");var d=duradosGetSpryDateFormat(r);if(!isValidDate("#"+m.attr("id"),d)){var s=Date.parseExact(p,r);if(s!=null){var t=s.toString(d);k=k.replace(p,t);c=c.replace(p,t);m.val(m.val().replace(p,t))}}}m.attr("d_val",k).attr("title",c)}},handleLeadingDateZeros:function(){},getComparerString:function(f,d,e){var b=f.indexOf(d,0);var c="=";if(b>-1){var g=b+d.length;var a=f.indexOf(e,g);if(a>-1){c=f.substr(g,a-g)}}return c}};function okAdvancedFilter(){var h=Durados.dropdowndiv.div;var f=Durados.dropdowndiv.token;var j=h.find("select").val();var d=j;var l=$.trim(h.find("select :selected").text());var b=h.attr("id");var g=h.find('input[name="first"]').val();var e=h.find('input[name="second"]').val();var c="";var k="";var m="";if(g!=""||j.indexOf("empty")>-1){var a=" ";if(j=="between"&&e!=""){c=g+a+f+"To"+f+a+e;d=l}else{if(j.indexOf("empty")>-1){d=l;c=""}else{if(b=="TextFilter"){g='"'+g+'"';d=l}c=g}}c=f+j+f+a+c;k=c.replace(f+j+f,d);m=c.replace(f+j+f,l);k=k.replace(f+"To"+f,translator.to);m=m.replace(f+"To"+f,translator.to)}Durados.dropdowndiv.input.val(k).attr("title",m).attr("d_val",c);Durados.dropdowndiv.hide();var i=Durados.dropdowndiv.input.parents('div[ajaxdiv="ajaxDiv"]:first').attr("guid");if(i==null){i=getMainPageGuid()}FilterForm.Apply(false,i,null)}function cancelAdvancedFilter(){Durados.dropdowndiv.hide()}function initAdvancedFilterValues(k,o){var e=Durados.dropdowndiv.token;var m=Durados.dropdowndiv.input;var f=k.find('input[name="first"]');var d=k.find('input[name="second"]');var n=k.find("select");var g=f.val();var c=d.val();var j;if(o){n.siblings(".between").show();n.attr("disabled","disabled")}else{n.siblings(".between").hide();n.removeAttr("disabled")}var b=m.attr("d_val");if(b.length<3){b="";m.val("")}if(b){var l=b.split(e+"To"+e);var h=l[0];var j="";var i="";j=Durados.dropdowndiv.getComparerString(h,e,e);i=$.trim(h.replace(e+j+e,"").replace(/^\s\s*/,"").replace(/\s\s*$/,""));if(j=="between"){d.val(l[1].replace(/^\s\s*/,""))}else{d.val("")}if(i.match('^"')){i=i.substring(1)}if(i.match('"$')){i=i.substring(0,i.length-1)}f.val(i)}if(j){n.val(j)}else{if(!o){var a=getDefaultAdvancedFilterSign(k);n.val(a)}}Durados.dropdowndiv.displayElementsByCompSign(n)}function getDefaultAdvancedFilterSign(c){var d="=";var a=c.attr("id")=="TextFilter";if(a){var b=c.attr("insideTextSearch");if(b=="True"){d="%like%"}else{d="like%"}}return d}function initAdvancedFilterHandlers(f){var i=Durados.dropdowndiv.input;i.unbind("change").bind("change",function(){Durados.dropdowndiv.handleFilterValue(i)});var c=f.find('input[name="first"]');var b=f.find('input[name="second"]');if(f.find("#date1").length){var g=Durados.dropdowndiv.input.attr("df");var e=num(DateFormats.getValidDateType(Durados.dropdowndiv.input.attr("df")));var h=duradosGetSpryDateFormat(g);var a=duradosGetJQueryDateFormat(g);f.find("span.textfieldInvalidFormatMsg").html(h);var k={validation:function(){return isValidDate(c,h)},isRequired:false,useCharacterMasking:true,validateOn:["change"]};var j={validation:function(){return isValidDate(b,h)},isRequired:false,useCharacterMasking:true,validateOn:["change"]};var d="custom";if(Durados.dropdowndiv.date1&&Durados.dropdowndiv.date2){Durados.dropdowndiv.date1.reset();Durados.dropdowndiv.date2.reset();Durados.dropdowndiv.date1.type=d;Durados.dropdowndiv.date2.type=d;Durados.dropdowndiv.date1.init("date1",k);Durados.dropdowndiv.date2.init("date2",j)}else{Durados.dropdowndiv.date1=new Spry.Widget.ValidationTextField("date1",d,k);Durados.dropdowndiv.date2=new Spry.Widget.ValidationTextField("date2",d,j)}f.find("input.date___").datepicker("destroy");f.find("input.date___").each(function(){switch(e){case DateFormats.dateType.dateOnly:$(this).datepicker({showButtonPanel:true,showOn:"button",buttonImage:rootPath+"Content/smoothness/images/calendar.jpg",beforeShow:datePickerBeforeShow,onChangeMonthYear:datePickerOnChangeMonthYear,buttonImageOnly:true,dateFormat:a.dateFormat,onSelect:function(m,l){if(l.input){setTimeout("triggerDateChanged('#"+$(l.input).attr("id")+"');",1)}}});break;case DateFormats.dateType.dateAndTime:$(this).datetimepicker({showButtonPanel:true,showOn:"button",buttonImage:rootPath+"Content/smoothness/images/calendar.jpg",beforeShow:datePickerBeforeShow,onChangeMonthYear:datePickerOnChangeMonthYear,buttonImageOnly:true,dateFormat:a.dateFormat,timeFormat:a.timeFormat,onSelect:function(m,l){if(l.input){setTimeout("triggerDateChanged('#"+$(l.input).attr("id")+"');",1)}}});break;case DateFormats.dateType.timeOnly:$(this).timepicker({showButtonPanel:true,showOn:"button",buttonImage:rootPath+"Content/smoothness/images/calendar.jpg",beforeShow:datePickerBeforeShow,onChangeMonthYear:datePickerOnChangeMonthYear,buttonImageOnly:true,timeFormat:a.timeFormat,onSelect:function(m,l){if(l.input){setTimeout("triggerDateChanged('#"+$(l.input).attr("id")+"');",1)}}});break;default:break}})}else{if(f.find("#numeric1").length){if(Durados.dropdowndiv.numeric1&&Durados.dropdowndiv.numeric2){return}k={isRequired:false,useCharacterMasking:true,validateOn:["change"]};j={isRequired:false,useCharacterMasking:true,validateOn:["change"]};d="real";Durados.dropdowndiv.numeric1=new Spry.Widget.ValidationTextField("numeric1",d,k);Durados.dropdowndiv.numeric2=new Spry.Widget.ValidationTextField("numeric2",d,j)}}if(f.attr("ready")=="yes"){return}f.find("select").change(function(){Durados.dropdowndiv.displayElementsByCompSign($(this));c.focus().select()});f.attr("ready","yes");i.bind("keydown",function(m){var l=m.keyCode||m.which;if(l==9){Durados.dropdowndiv.hide()}});i.bind("keyup",function(){$(this).attr("title",$(this).val())});f.find('input[name="first"],input[name="second"]').unbind("keydown").bind("keydown",function(m){var l;if(m&&m.which){l=m.which}else{if(window.event){m=window.event;l=m.keyCode}}if(l==13){okAdvancedFilter()}else{if(l==27){Durados.dropdowndiv.hide()}}})};